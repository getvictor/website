<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="How to sign a Windows application with a code signing certificate"><title>Code signing a Windows application</title>
<link rel=canonical href=https://victoronsoftware.com/posts/code-signing-windows/><link rel=stylesheet href=/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css><meta property='og:title' content="Code signing a Windows application"><meta property='og:description' content="How to sign a Windows application with a code signing certificate"><meta property='og:url' content='https://victoronsoftware.com/posts/code-signing-windows/'><meta property='og:site_name' content='Victor on Software'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='Code Signing'><meta property='article:tag' content='Windows'><meta property='article:tag' content='Application Security'><meta property='article:published_time' content='2024-03-27T00:00:00+00:00'><meta property='article:modified_time' content='2024-03-27T00:00:00+00:00'><meta property='og:image' content='https://victoronsoftware.com/posts/code-signing-windows/digital-signature-ok.png'><meta name=twitter:title content="Code signing a Windows application"><meta name=twitter:description content="How to sign a Windows application with a code signing certificate"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://victoronsoftware.com/posts/code-signing-windows/digital-signature-ok.png'><script async src="https://www.googletagmanager.com/gtag/js?id=G-1XV381YSQ8"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1XV381YSQ8")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu7557696702933755770.png width=300 height=297 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Victor on Software</a></h1><h2 class=site-description>Software engineering, security, and related topics</h2></div></header><ol class=menu-social><li><a href=https://fleetdm.com target=_blank title=Fleet rel=me><svg width="58.219mm" height="58.202mm" viewBox="0 0 58.219 58.202"><g stroke-width=".26458"><path d="m7.5963 14.823c3.954.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2053 7.1594 7.1594 7.1594z" fill="#63c740"/><path d="m29.075 14.823c3.9539.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.9541.0-7.1595 3.2053-7.1595 7.1594.0 3.954 3.2054 7.1594 7.1595 7.1594z" fill="#5cabdf"/><path d="m50.552 14.823c3.9542.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2052-7.1594-7.1594-7.1594-3.9539.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2054 7.1594 7.1594 7.1594z" fill="#d66c7b"/><path d="m7.5963 36.301c3.954.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.954.0-7.1594 3.2054-7.1594 7.1595.0 3.9539 3.2053 7.1594 7.1594 7.1594z" fill="#c98def"/><path d="m29.075 36.301c3.9539.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.9541.0-7.1595 3.2054-7.1595 7.1595.0 3.9539 3.2054 7.1594 7.1595 7.1594z" fill="#faa669"/><path d="m7.5963 57.779c3.954.0 7.1594-3.2052 7.1594-7.1594.0-3.9539-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2054-7.1594 7.1594.0 3.9542 3.2053 7.1594 7.1594 7.1594z" fill="#3aefc4"/></g></svg></a></li><li><a href=https://github.com/getvictor target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/lyuboslavsky/ target=_blank title=LinkedIn rel=me><svg width="16" height="16" fill="currentcolor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401m-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4"/></svg></a></li><li><a href=http://www.youtube.com/@VictorOnSoftware target=_blank title=YouTube rel=me><svg height="800" width="800" id="Layer_1" viewBox="0 0 461.001 461.001"><g><path style="fill:#f61c0d" d="M365.257 67.393H95.744C42.866 67.393.0 110.259.0 163.137v134.728c0 52.878 42.866 95.744 95.744 95.744h269.513c52.878.0 95.744-42.866 95.744-95.744V163.137c0-52.878-42.866-95.744-95.744-95.744zM300.506 237.056l-126.06 60.123c-3.359 1.602-7.239-.847-7.239-4.568V168.607c0-3.774 3.982-6.22 7.348-4.514l126.06 63.881C304.363 229.873 304.298 235.248 300.506 237.056z"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/page/tools/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Software tools</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/code-signing-windows/><img src=/posts/code-signing-windows/digital-signature-ok_hu3680626222407275737.png srcset="/posts/code-signing-windows/digital-signature-ok_hu3680626222407275737.png 800w, /posts/code-signing-windows/digital-signature-ok_hu13518970151036109553.png 1600w" width=800 height=451 loading=lazy alt="Featured image of post Code signing a Windows application"></a></div><div class=article-details><header class=article-category><a href=/categories/devops--infrastructure/>DevOps & Infrastructure</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/code-signing-windows/>Code signing a Windows application</a></h2><h3 class=article-subtitle>How to sign a Windows application with a code signing certificate</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 27, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><h2 id=what-is-code-signing><a href=#what-is-code-signing class=header-anchor></a>What is code signing?</h2><p>Code signing is the process of digitally signing executables and scripts to confirm the software author and guarantee
that the code has not been altered or corrupted since it was signed. The method employs a cryptographic hash to validate
the authenticity and integrity of the code.</p><h2 id=the-benefits-of-code-signing><a href=#the-benefits-of-code-signing class=header-anchor></a>The benefits of code signing</h2><p>Code signing provides several benefits:</p><ul><li><strong>User trust</strong>: Users are likelier to trust signed software because they can verify its origin.</li><li><strong>Security</strong>: Code signing helps prevent tampering and makes sure that bad actors have not altered the software.</li><li><strong>Malware protection</strong>: Code signing helps protect users from malware by verifying the software&rsquo;s authenticity.</li><li><strong>Software updates</strong>: Code signing helps users verify that software updates are legitimate and not malicious.</li><li><strong>Windows Defender</strong>: Code signing helps prevent Windows Defender warnings.</li></ul><h2 id=code-signing-process-for-windows><a href=#code-signing-process-for-windows class=header-anchor></a>Code signing process for Windows</h2><p>The code signing process for Windows involves the following steps:</p><ul><li><strong>Obtain a code signing certificate</strong>: Purchase a code signing certificate from a trusted certificate authority (CA)
or use a self-signed certificate.</li><li><strong>Sign the code</strong>: Use a code signing tool to sign the code with the code signing certificate.</li><li><strong>Timestamp the signature</strong>: Timestamp the signature to make sure that the signature remains valid even after the
certificate expires.</li><li><strong>Distribute the signed code</strong>: Distribute the signed code to users.</li><li><strong>Verify the signature</strong>: Users can verify the signature to confirm the software&rsquo;s authenticity.</li></ul><h2 id=obtaining-a-code-signing-certificate><a href=#obtaining-a-code-signing-certificate class=header-anchor></a>Obtaining a code signing certificate</h2><p>In our example, we will use a self-signed certificate. This approach is suitable for internal business applications. For
public applications, you should obtain a code signing certificate from a trusted CA.</p><p>We will use the <a class=link href=https://www.openssl.org/ target=_blank rel=noopener>OpenSSL</a> command line tool to generate the certificates. OpenSSL is a popular
open-source library for TLS and SSL protocols.</p><p>The following script generates the certificate and key needed for code signing. It also generates a certificate
authority (CA) and signs the code signing certificate with the CA.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># -e: Immediately exit if any command has a non-zero exit status.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -x: Print all executed commands to the terminal.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -u: Exit if an undefined variable is used.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -o pipefail: Exit if any command in a pipeline fails.</span>
</span></span><span style=display:flex><span>set -exuo pipefail
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># This script generates certificates and keys needed for code signing.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mkdir -p certs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Certificate authority (CA)</span>
</span></span><span style=display:flex><span>openssl genrsa -out certs/ca.key <span style=color:#ae81ff>2048</span>
</span></span><span style=display:flex><span>openssl req -new -x509 -nodes -days <span style=color:#ae81ff>1000</span> -key certs/ca.key -out certs/ca.crt -subj <span style=color:#e6db74>&#34;/C=US/ST=Texas/L=Austin/O=Your Organization/OU=Your Unit/CN=testCodeSignCA&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Generate a certificate for code signing, signed by the CA</span>
</span></span><span style=display:flex><span>openssl req -newkey rsa:2048 -nodes -keyout certs/sign.key -out certs/sign.req -subj <span style=color:#e6db74>&#34;/C=US/ST=Texas/L=Austin/O=Your Organization/OU=Your Unit/CN=testCodeSignCert&#34;</span>
</span></span><span style=display:flex><span>openssl x509 -req -in certs/sign.req -days <span style=color:#ae81ff>398</span> -CA certs/ca.crt -CAkey certs/ca.key -set_serial <span style=color:#ae81ff>01</span> -out certs/sign.crt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Clean up</span>
</span></span><span style=display:flex><span>rm certs/sign.req
</span></span></code></pre></div><h2 id=building-the-application><a href=#building-the-application class=header-anchor></a>Building the application</h2><p>We will build a simple &ldquo;Hello World&rdquo; Windows application using the Go programming language for this example. We compile
the application with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export GOOS<span style=color:#f92672>=</span>windows
</span></span><span style=display:flex><span>export GOARCH<span style=color:#f92672>=</span>amd64
</span></span><span style=display:flex><span>go build ./hello-world.go
</span></span></code></pre></div><p>The Go build process generates the <code>hello-world.exe</code> Windows executable.</p><h2 id=signing-and-timestamping-the-code><a href=#signing-and-timestamping-the-code class=header-anchor></a>Signing and timestamping the code</h2><p>To sign the code, we will use <a class=link href=https://github.com/mtrojnar/osslsigncode target=_blank rel=noopener>osslsigncode</a>, an open-source code signing tool
that uses OpenSSL to sign Windows executables. Unlike Microsoft&rsquo;s <code>signtool,</code> <code>osslsigncode</code> is cross-platform and can
be used on Linux and macOS.</p><p>To sign the code, we use the following script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># -e: Immediately exit if any command has a non-zero exit status.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -x: Print all executed commands to the terminal.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -u: Exit if an undefined variable is used.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -o pipefail: Exit if any command in a pipeline fails.</span>
</span></span><span style=display:flex><span>set -exuo pipefail
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input_file<span style=color:#f92672>=</span>$1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! -f <span style=color:#e6db74>&#34;</span>$input_file<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#39;First argument must be path to binary&#39;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check that input file is a windows PE (Portable Executable)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ! <span style=color:#f92672>(</span> file <span style=color:#e6db74>&#34;</span>$input_file<span style=color:#e6db74>&#34;</span> | grep -q PE <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#39;File must be a Portable Executable (PE) file.&#39;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check that osslsigncode is installed</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ! command -v osslsigncode &gt;/dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span> ; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;osslsigncode utility is not present or missing from PATH. Binary cannot be signed.&#34;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>orig_file<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>input_file<span style=color:#e6db74>}</span><span style=color:#e6db74>_unsigned&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mv <span style=color:#e6db74>&#34;</span>$input_file<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span>$orig_file<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>osslsigncode sign -certs <span style=color:#e6db74>&#34;./certs/sign.crt&#34;</span> -key <span style=color:#e6db74>&#34;./certs/sign.key&#34;</span> -n <span style=color:#e6db74>&#34;Hello Windows code signing&#34;</span> -i <span style=color:#e6db74>&#34;https://victoronsoftware.com/&#34;</span> -t <span style=color:#e6db74>&#34;http://timestamp.comodoca.com/authenticode&#34;</span> -in <span style=color:#e6db74>&#34;</span>$orig_file<span style=color:#e6db74>&#34;</span> -out <span style=color:#e6db74>&#34;</span>$input_file<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rm <span style=color:#e6db74>&#34;</span>$orig_file<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>In addition to signing the code, we timestamp the signature using the Comodo server. Timestamping makes sure the
signature remains valid even after the certificate expires or is invalidated.</p><p>We can use <code>osslsigncode</code> to verify the signature:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>input_file<span style=color:#f92672>=</span>$1
</span></span><span style=display:flex><span>osslsigncode verify -CAfile ./certs/ca.crt <span style=color:#e6db74>&#34;</span>$input_file<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><h2 id=distributing-and-manually-verifying-the-signed-code><a href=#distributing-and-manually-verifying-the-signed-code class=header-anchor></a>Distributing and manually verifying the signed code</h2><p>After signing the code, we can distribute the signed executable to users. Users can manually verify the signature by
right-clicking the executable, selecting &ldquo;Properties,&rdquo; and navigating to the &ldquo;Digital Signatures&rdquo; tab. The user can then
view the certificate details and verify that the signature is valid.</p><p>However, since we are using the self-signed certificate, users will see a warning that the certificate is not trusted.
Our self-signed certificate is not trusted because the certificate authority is not part of the Windows trusted root
certificate store.</p><figure><img src=/posts/code-signing-windows/certificate-signature-not-verified.png alt="Certificate in code signature cannot be verified"><figcaption><h4>Certificate in code signature cannot be verified</h4></figcaption></figure><p>We can add the certificate authority to the Windows trusted root certificate store with the following Powershell
command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Import-Certificate -FilePath <span style=color:#e6db74>&#34;certs\ca.crt&#34;</span> -CertStoreLocation Cert<span style=color:#960050;background-color:#1e0010>:</span>\LocalMachine\Root
</span></span></code></pre></div><p>After adding the certificate authority to the trusted root certificate store, users will see that the certificate is
trusted and the signature is valid.</p><figure><img src=/posts/code-signing-windows/certificate-signature-verified.png alt="Certificate in code signature is be verified"><figcaption><h4>Certificate in code signature is be verified</h4></figcaption></figure><h2 id=code-signing-using-a-certificate-from-a-public-ca><a href=#code-signing-using-a-certificate-from-a-public-ca class=header-anchor></a>Code signing using a certificate from a public CA</h2><p>To sign public applications, we must obtain a code signing certificate from a trusted CA. The latest industry standards
require private keys for code signing certificates to be stored in hardware security modules (HSMs) to prevent
unauthorized access. This security requirement means certificates for code signing in CI/CD pipelines must use a cloud
HSM vendor or a private pipeline runner with an HSM.</p><p>In a future article, we will explore signing a Windows application using a cloud HSM vendor.</p><h2 id=example-code-on-github><a href=#example-code-on-github class=header-anchor></a>Example code on GitHub</h2><p>The example code is available on GitHub at <a class=link href=https://github.com/getvictor/code-sign-windows target=_blank rel=noopener>https://github.com/getvictor/code-sign-windows</a></p><h2 id=further-reading><a href=#further-reading class=header-anchor></a>Further reading</h2><ul><li>Recently, we explained <a class=link href=../exe-installer>how to create an EXE installer</a>.</li></ul><h2 id=code-signing-a-windows-application-video><a href=#code-signing-a-windows-application-video class=header-anchor></a>Code signing a Windows application video</h2><div class=video-wrapper><iframe loading=lazy src=https://www.youtube.com/embed/NQYUgHznXew allowfullscreen title="YouTube Video"></iframe></div></section><footer class=article-footer><section class=article-tags><a href=/tags/code-signing/>Code Signing</a>
<a href=/tags/windows/>Windows</a>
<a href=/tags/application-security/>Application Security</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/mtls-go-client-windows-certificate-store/><div class=article-image><img src=/posts/mtls-go-client-windows-certificate-store/mtls-go-windows.0a8dfbc39a48ef72269453d3110b2806_hu14306420539221850309.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client using Windows certificate store" data-hash="md5-Co37w5pI73ImlFPTEQsoBg=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client using Windows certificate store</h2></div></a></article><article class=has-image><a href=/posts/mtls-with-windows/><div class=article-image><img src=/posts/mtls-with-windows/mtls-edge.148b2d13beb1a2231542bf5950875c93_hu18240766985919795390.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) with Windows certificate store" data-hash="md5-FIstE76xoiMVQr9ZUIdckw=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) with Windows certificate store</h2></div></a></article><article class=has-image><a href=/posts/mtls-go-client-using-apple-keychain/><div class=article-image><img src=/posts/mtls-go-client-using-apple-keychain/mtls-go-apple-keychain.4be855897ea7b8897e027a30c449d256_hu9663222902861578666.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client using macOS keychain" data-hash="md5-S+hViX6nuIl+AnowxEnSVg=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client using macOS keychain</h2></div></a></article><article class=has-image><a href=/posts/mtls-go-custom-signer/><div class=article-image><img src=/posts/mtls-go-custom-signer/signer.4d60e63c2cfbb31978535b2b67059f38_hu10458632819968436544.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client with custom certificate signer" data-hash="md5-TWDmPCz7sxl4U1srZwWfOA=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client with custom certificate signer</h2></div></a></article><article class=has-image><a href=/posts/mtls-go-client/><div class=article-image><img src=/posts/mtls-go-client/go-client.d367a206fbe9c06685ee92f65e0026b9_hu18190656592406348482.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client" data-hash="md5-02eiBvvpwGaF7pL2XgAmuQ=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 Victor on Software</section><section class=powerby></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>