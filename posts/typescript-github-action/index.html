<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Create a GitHub Action using TypeScript to replace GitHub's pull request review process"><title>How to create a custom GitHub Action using TypeScript</title><link rel=canonical href=https://victoronsoftware.com/posts/typescript-github-action/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="How to create a custom GitHub Action using TypeScript"><meta property='og:description' content="Create a GitHub Action using TypeScript to replace GitHub's pull request review process"><meta property='og:url' content='https://victoronsoftware.com/posts/typescript-github-action/'><meta property='og:site_name' content='Victor on Software'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='GitHub'><meta property='article:tag' content='GitHub Actions'><meta property='article:tag' content='Developer Experience'><meta property='article:published_time' content='2024-10-23T00:00:00+00:00'><meta property='article:modified_time' content='2024-10-23T00:00:00+00:00'><meta property='og:image' content='https://victoronsoftware.com/posts/typescript-github-action/typescript-github-action-headline.png'><meta property='article:author' content='Victor Lyuboslavsky'><meta name=twitter:title content="How to create a custom GitHub Action using TypeScript"><meta name=twitter:description content="Create a GitHub Action using TypeScript to replace GitHub's pull request review process"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://victoronsoftware.com/posts/typescript-github-action/typescript-github-action-headline.png'><script async src="https://www.googletagmanager.com/gtag/js?id=G-1XV381YSQ8"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1XV381YSQ8")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_c8fdb37897842f49.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Victor on Software</a></h1><h2 class=site-description>Software engineering, security, and related topics</h2></div></header><ol class=menu-social><li><a href=https://fleetdm.com target=_blank title=Fleet rel=me><svg width="58.219mm" height="58.202mm" viewBox="0 0 58.219 58.202"><g stroke-width=".26458"><path d="m7.5963 14.823c3.954.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2053 7.1594 7.1594 7.1594z" fill="#63c740"/><path d="m29.075 14.823c3.9539.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.9541.0-7.1595 3.2053-7.1595 7.1594.0 3.954 3.2054 7.1594 7.1595 7.1594z" fill="#5cabdf"/><path d="m50.552 14.823c3.9542.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2052-7.1594-7.1594-7.1594-3.9539.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2054 7.1594 7.1594 7.1594z" fill="#d66c7b"/><path d="m7.5963 36.301c3.954.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.954.0-7.1594 3.2054-7.1594 7.1595.0 3.9539 3.2053 7.1594 7.1594 7.1594z" fill="#c98def"/><path d="m29.075 36.301c3.9539.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.9541.0-7.1595 3.2054-7.1595 7.1595.0 3.9539 3.2054 7.1594 7.1595 7.1594z" fill="#faa669"/><path d="m7.5963 57.779c3.954.0 7.1594-3.2052 7.1594-7.1594.0-3.9539-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2054-7.1594 7.1594.0 3.9542 3.2053 7.1594 7.1594 7.1594z" fill="#3aefc4"/></g></svg></a></li><li><a href=https://github.com/getvictor target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/lyuboslavsky/ target=_blank title=LinkedIn rel=me><svg width="16" height="16" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401m-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4"/></svg></a></li><li><a href=http://www.youtube.com/@VictorOnSoftware target=_blank title=YouTube rel=me><svg height="800" width="800" id="Layer_1" viewBox="0 0 461.001 461.001"><g><path style="fill:#f61c0d" d="M365.257 67.393H95.744C42.866 67.393.0 110.259.0 163.137v134.728c0 52.878 42.866 95.744 95.744 95.744h269.513c52.878.0 95.744-42.866 95.744-95.744V163.137c0-52.878-42.866-95.744-95.744-95.744zM300.506 237.056l-126.06 60.123c-3.359 1.602-7.239-.847-7.239-4.568V168.607c0-3.774 3.982-6.22 7.348-4.514l126.06 63.881C304.363 229.873 304.298 235.248 300.506 237.056z"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/page/speaking/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 2m0 3a3 3 0 013-3h0a3 3 0 013 3v5a3 3 0 01-3 3h0a3 3 0 01-3-3z"/><path d="M5 10a7 7 0 0014 0"/><path d="M8 21h8"/><path d="M12 17v4"/></svg>
<span>Speaking</span></a></li><li><a href=/page/tools/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Software tools</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/typescript-github-action/><img src=/posts/typescript-github-action/typescript-github-action-headline_hu_1f93907a93224b82.png srcset="/posts/typescript-github-action/typescript-github-action-headline_hu_1f93907a93224b82.png 800w, /posts/typescript-github-action/typescript-github-action-headline_hu_713e6d6251c91d1e.png 1600w" width=800 height=419 loading=lazy alt="Featured image of post How to create a custom GitHub Action using TypeScript"></a></div><div class=article-details><header class=article-category><a href=/categories/devops--infrastructure/>DevOps & Infrastructure</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/typescript-github-action/>How to create a custom GitHub Action using TypeScript</a></h2><h3 class=article-subtitle>Create a GitHub Action using TypeScript to replace GitHub's pull request review process</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Oct 23, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>7 minute read</time></div></footer></div></header><section class=article-content><p>In this article, we&rsquo;ll create a custom reusable GitHub Action using TypeScript. As covered in our article on
<a class=link href=../github-reusable-workflows-and-steps/>reusing GitHub workflows and steps</a>, GitHub Actions allow you to automate your
software development workflows. By creating a custom GitHub Action, you can extend the functionality of GitHub Actions
to suit your specific needs.</p><p>We will create a simple GitHub Action to replace
<a class=link href=../github-code-review-issues/>GitHub&rsquo;s broken Pull Request review process</a>. This custom GitHub Action will
automatically approve Pull Requests that meet specific criteria.</p><h2 id=start-with-githubs-action-template><a href=#start-with-githubs-action-template class=header-anchor></a>Start with GitHub&rsquo;s Action template</h2><p>GitHub provides a
<a class=link href=https://github.com/actions/typescript-action target=_blank rel=noopener>template for creating a new GitHub Action using TypeScript</a>. You can use
this template to get started quickly. The template includes the necessary files and structure to create a new GitHub
Action. Anything unnecessary can be removed or modified to suit your requirements.</p><p>Follow the instructions in the template&rsquo;s README to set up your action.</p><ol><li>Click the <strong>Use this template</strong> button at the top of the repository</li><li>Select <strong>Create a new repository</strong></li><li>Select an owner and name for your new repository</li><li>Click <strong>Create repository</strong></li><li>Clone your new repository</li></ol><p>Check out your new repository, go to the cloned repo directory, and make sure your node version matches the one in the
<code>.node-version</code> file. If you&rsquo;re using <a class=link href=https://github.com/nvm-sh/nvm/blob/master/README.md target=_blank rel=noopener>nvm (Node Version Manager)</a>,
you can run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cp .node-version .nvmrc
</span></span><span style=display:flex><span>nvm install
</span></span><span style=display:flex><span>node --version
</span></span></code></pre></div><p><strong>Note:</strong> Our example is based on
<a class=link href=https://github.com/actions/typescript-action/tree/0467e124e81b527a246cabdaef9c3b433febf9a8 target=_blank rel=noopener>this commit of the template repository</a>.</p><h2 id=implement-your-custom-github-action><a href=#implement-your-custom-github-action class=header-anchor></a>Implement your custom GitHub Action</h2><p>Install the template&rsquo;s dependencies with <code>npm install</code>. In addition, install the <code>@actions/github</code> package with
<code>npm install @actions/github</code>.</p><p>The template provides a basic structure for your GitHub Action. Update the <code>action.yml</code> file with your action&rsquo;s name,
description, author, and updated inputs/outputs.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#e6db74>&#39;Code review&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>description</span>: <span style=color:#e6db74>&#39;Improved code review process&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>author</span>: <span style=color:#e6db74>&#39;Victor on Software&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add your action&#39;s branding here. This will appear on the GitHub Marketplace.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>branding</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#e6db74>&#39;heart&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>color</span>: <span style=color:#e6db74>&#39;red&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Define your inputs here.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>github-token</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>description</span>: <span style=color:#e6db74>&#39;GitHub secret token&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>required</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>runs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>using</span>: <span style=color:#ae81ff>node20</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>main</span>: <span style=color:#ae81ff>dist/index.js</span>
</span></span></code></pre></div><p>In this example, our new action will have a single input, <code>github-token</code>, the GitHub secret token to use the GitHub API.</p><p>Next, we can modify the code in the <code>src/main.ts</code> file to implement our custom logic.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>core</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@actions/core&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>github</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@actions/github&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>readFileSync</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;fs&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * The main function of the action.
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @returns {Promise&lt;void&gt;} Resolves when the action is complete.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>run</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Get the PR number from the payload. This action is only intended for PRs.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>prNumber</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>github</span>.<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>payload</span>.<span style=color:#a6e22e>pull_request</span><span style=color:#f92672>?</span>.<span style=color:#66d9ef>number</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>prNumber</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Get the required reviewer from the REVIEWERS file.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// This simplified example assumes that the REVIEWERS file contains a single reviewer.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// In a real-world scenario, we would need to parse the REVIEWERS file at the top directory
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// of our changed files to get the reviewers.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>reviewer</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readFileSync</span>(<span style=color:#e6db74>&#39;REVIEWERS&#39;</span>, <span style=color:#e6db74>&#39;utf8&#39;</span>).<span style=color:#a6e22e>trim</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>reviewer</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>core</span>.<span style=color:#a6e22e>setFailed</span>(<span style=color:#e6db74>&#39;No reviewer found in REVIEWERS file&#39;</span>)
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Get all the reviews for this PR.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>githubToken</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>core</span>.<span style=color:#a6e22e>getInput</span>(<span style=color:#e6db74>&#39;github-token&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>octokit</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>github</span>.<span style=color:#a6e22e>getOctokit</span>(<span style=color:#a6e22e>githubToken</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>reviews</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>octokit</span>.<span style=color:#a6e22e>rest</span>.<span style=color:#a6e22e>pulls</span>.<span style=color:#a6e22e>listReviews</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>owner</span>: <span style=color:#66d9ef>github.context.repo.owner</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>repo</span>: <span style=color:#66d9ef>github.context.repo.repo</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>pull_number</span>: <span style=color:#66d9ef>prNumber</span>
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check if the required reviewer has approved the PR.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// This action does not require the reviewer to re-approve the PR if new changes are pushed.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>approved</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>reviews</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>forEach</span>(<span style=color:#a6e22e>review</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>review</span>.<span style=color:#a6e22e>user</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>login</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>reviewer</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>review</span>.<span style=color:#a6e22e>state</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;APPROVED&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>approved</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Fail the workflow run if the required reviewer has not approved the PR.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>approved</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>core</span>.<span style=color:#a6e22e>setFailed</span>(<span style=color:#e6db74>`Reviewer </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>reviewer</span><span style=color:#e6db74>}</span><span style=color:#e6db74> needs to approve the PR`</span>)
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Fail the workflow run if an error occurs
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error</span> <span style=color:#66d9ef>instanceof</span> Error) <span style=color:#a6e22e>core</span>.<span style=color:#a6e22e>setFailed</span>(<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We read the <code>REVIEWERS</code> file to get the required reviewer for the PR. We then retrieve all the reviews for the pull
request and check if the needed reviewer has approved the PR. If the reviewer has not approved the PR, we fail the run.</p><h2 id=build-your-custom-github-action><a href=#build-your-custom-github-action class=header-anchor></a>Build your custom GitHub Action</h2><p>To build your action, run <code>npm run bundle</code>. This will compile the TypeScript code in the <code>src/</code> directory and output the
JavaScript code in the <code>dist/</code> directory. The exact command for <code>bundle</code> is defined in the <code>package.json</code> file.</p><p>The <code>bundle</code> step is required before you can test your action locally or use it in a workflow because the <code>action.yml</code>
file points at the <code>dist/index.js</code> bundled version of your code.</p><p>This step can easily be forgotten, and you may wonder why your changes are not reflected in the action. You can
configure our IDE to do <code>npm run bundle</code> automatically on save, create a check as a
<a class=link href=https://git-scm.com/book/ms/v2/Customizing-Git-Git-Hooks target=_blank rel=noopener>git pre-commit hook</a> to ensure the <code>dist/</code> directory is
up-to-date, or rely on the <code>Check Transpiled Javascript</code> workflow in the <code>.github/workflows/</code> directory.</p><p>Now, commit your changes and push them to your repository.</p><p><strong>Note:</strong> We will not cover testing in this article, but you should add tests to the <code>__tests__/</code> directory for your
source code. For this example, we must refactor the code to make it more testable.</p><h2 id=test-your-custom-github-action-in-another-repository><a href=#test-your-custom-github-action-in-another-repository class=header-anchor></a>Test your custom GitHub Action in another repository</h2><h3 id=add-workflows-and-reviewers-file><a href=#add-workflows-and-reviewers-file class=header-anchor></a>Add workflows and REVIEWERS file</h3><p>You can use the <code>uses</code> keyword in a workflow file to try your action in another repository. Create a new workflow file
in the repository&rsquo;s <code>.github/workflows/</code> directory where you want to test your action. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Code review</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>workflow_dispatch</span>: <span style=color:#75715e># Manual (for debug)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>code-review</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Code review</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Checkout</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>id</span>: <span style=color:#ae81ff>checkout</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v4</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Code review action</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>id</span>: <span style=color:#ae81ff>test-action</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>getvictor/code-review-demo@main</span> <span style=color:#75715e># Your action goes here</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>github-token</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
</span></span></code></pre></div><p>We are using <code>@main</code> as the version of the action to test the latest code on the main branch. You can replace this with
a specific version tag or branch name.</p><p>In addition, create a <code>REVIEWERS</code> file at the repository&rsquo;s root with the required reviewer&rsquo;s GitHub username.</p><p>Notice that the above workflow runs on <code>pull_request</code> events but not on <code>pull_request_review</code> events. This is because
GitHub Actions treats the <code>pull_request</code> workflow runs and the <code>pull_request_review</code> workflow runs as distinct. Instead,
we want the same workflow run to be triggered by both events. This is a common pitfall when working with GitHub Actions.
We need to add another workflow file that listens for <code>pull_request_review</code> events and triggers the <code>pull_request</code>
workflow run to fix this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rerun checks after review</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request_review</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>types</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>submitted</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>dismissed</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>rerun_checks</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rerun specified checks</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>permissions</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>actions</span>: <span style=color:#ae81ff>write</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rerun Checks</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>shqear93/rerun-checks@v3</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>github-token</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>check-names</span>: <span style=color:#e6db74>&#39;Code review&#39;</span>
</span></span></code></pre></div><h3 id=configure-a-github-rule-to-require-code-review><a href=#configure-a-github-rule-to-require-code-review class=header-anchor></a>Configure a GitHub rule to require code review</h3><p>Create a branch protection rule in the repository settings that requires the above <code>Code review</code> workflow to pass in a
PR before merging to your default branch.</p><figure><img src=/posts/typescript-github-action/github-code-review-rule.png alt="Require a pull request before merging. Require the Code review status check to pass."></figure><h3 id=create-a-pull-request><a href=#create-a-pull-request class=header-anchor></a>Create a pull request</h3><p>Commit your changes to a new branch and create a pull request. The <code>Code review</code> workflow should run automatically and
show the Failed status.</p><p>Once the required reviewer approves the PR, the <code>Rerun checks after review</code> workflow will run and trigger the
<code>Code review</code> workflow. The rerun should pass, and you should be able to merge the PR.</p><h2 id=clean-up-your-custom-github-action-repo><a href=#clean-up-your-custom-github-action-repo class=header-anchor></a>Clean up your custom GitHub Action repo</h2><p>As an optional step, you can clean up your custom GitHub Action repository:</p><ul><li>Update README.md with instructions on how to use your new action</li><li>Remove the <code>src/wait.ts</code> file and associated tests</li><li>Update workflows in the <code>.github/workflows/</code> directory</li></ul><h2 id=further-reading><a href=#further-reading class=header-anchor></a>Further reading</h2><p>In a previous article, we described
<a class=link href=../git-merges-and-pull-requests/>what happens in a GitHub pull request after a <code>git merge</code></a>.</p><p>In another article, we covered
<a class=link href=../use-github-actions-for-general-purpose-tasks/>how to use GitHub Actions for general-purpose tasks</a>.</p><h2 id=example-code-on-github><a href=#example-code-on-github class=header-anchor></a>Example code on GitHub</h2><p>The code for our simple GitHub Action is available on GitHub: <a class=link href=https://github.com/getvictor/code-review-demo target=_blank rel=noopener>https://github.com/getvictor/code-review-demo</a></p><h2 id=watch-how-to-create-a-custom-github-action-using-typescript><a href=#watch-how-to-create-a-custom-github-action-using-typescript class=header-anchor></a>Watch how to create a custom GitHub Action using TypeScript</h2><div class=video-wrapper><iframe loading=lazy src=https://www.youtube.com/embed/NFIwPxz5La8 allowfullscreen title="YouTube Video"></iframe></div><p><em>Note:</em> If you want to comment on this article, please do so on the YouTube video.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/github/>GitHub</a>
<a href=/tags/github-actions/>GitHub Actions</a>
<a href=/tags/developer-experience/>Developer Experience</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/github-code-review-issues/><div class=article-image><img src=/posts/github-code-review-issues/developer-on-tightrope-headline.5b5fc812d52477b6c495ec2d24e5e9e9_hu_e4a061719d59285.png width=250 height=150 loading=lazy alt="Featured image of post Top 3 issues with GitHub code review process" data-hash="md5-W1/IEtUkd7bElewtJOXp6Q=="></div><div class=article-details><h2 class=article-title>Top 3 issues with GitHub code review process</h2></div></a></article><article class=has-image><a href=/posts/github-reusable-workflows-and-steps/><div class=article-image><img src=/posts/github-reusable-workflows-and-steps/GitHub%20Actions%20thumbnail.1de2a1ac1930c73ab93ff3f52f594721_hu_b2393587962b67eb.png width=250 height=150 loading=lazy alt="Featured image of post How to reuse workflows and steps in GitHub Actions (2024)" data-hash="md5-HeKhrBkwxzq5P/P1L1lHIQ=="></div><div class=article-details><h2 class=article-title>How to reuse workflows and steps in GitHub Actions (2024)</h2></div></a></article><article class=has-image><a href=/posts/use-github-actions-for-general-purpose-tasks/><div class=article-image><img src=/posts/use-github-actions-for-general-purpose-tasks/GitHub-action.84a3f7063b6751b533a79ec07c37aee8_hu_4475a5f9cdce118f.png width=250 height=150 loading=lazy alt="Featured image of post Use GitHub Actions for general-purpose tasks" data-hash="md5-hKP3BjtnUbUzp57AfDeu6A=="></div><div class=article-details><h2 class=article-title>Use GitHub Actions for general-purpose tasks</h2></div></a></article><article class=has-image><a href=/posts/remote-development-environment/><div class=article-image><img src=/posts/remote-development-environment/remote-dev-environment-headline.31f63ebeac8c3e58b75094b04f6d68a3_hu_afe81596f65750ea.png width=250 height=150 loading=lazy alt="Featured image of post How to set up a remote development environment" data-hash="md5-MfY+vqyMPli3UJSwT21oow=="></div><div class=article-details><h2 class=article-title>How to set up a remote development environment</h2></div></a></article><article class=has-image><a href=/posts/go-test-execution-time/><div class=article-image><img src=/posts/go-test-execution-time/crash-test-dummy-headline.b52944a60a898bc6ca376849bf1212e9_hu_f927f9af09a65a7b.png width=250 height=150 loading=lazy alt="Featured image of post How to measure the execution time of Go tests accurately" data-hash="md5-tSlEpgqJi8bKN2hJvxIS6Q=="></div><div class=article-details><h2 class=article-title>How to measure the execution time of Go tests accurately</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 Victor on Software</section><section class=powerby></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>