<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="A practical guide to generating, storing, and using private keys with hardware-backed protection"><title>How to use TPM 2.0 to secure private keys</title><link rel=canonical href=https://victoronsoftware.com/posts/how-to-use-tpm/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="How to use TPM 2.0 to secure private keys"><meta property='og:description' content="A practical guide to generating, storing, and using private keys with hardware-backed protection"><meta property='og:url' content='https://victoronsoftware.com/posts/how-to-use-tpm/'><meta property='og:site_name' content='Victor on Software'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='Cyber Security'><meta property='article:tag' content='Application Security'><meta property='article:tag' content='Golang'><meta property='article:published_time' content='2025-07-02T00:00:00+00:00'><meta property='article:modified_time' content='2025-07-02T00:00:00+00:00'><meta property='og:image' content='https://victoronsoftware.com/posts/how-to-use-tpm/tpm-key-hierarchy-headline.png'><meta property='article:author' content='Victor Lyuboslavsky'><meta name=twitter:title content="How to use TPM 2.0 to secure private keys"><meta name=twitter:description content="A practical guide to generating, storing, and using private keys with hardware-backed protection"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://victoronsoftware.com/posts/how-to-use-tpm/tpm-key-hierarchy-headline.png'><script async src="https://www.googletagmanager.com/gtag/js?id=G-1XV381YSQ8"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1XV381YSQ8")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_2a985bbd48e632da.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Victor on Software</a></h1><h2 class=site-description>Software engineering, security, and related topics</h2></div></header><ol class=menu-social><li><a href=https://fleetdm.com target=_blank title=Fleet rel=me><svg width="58.219mm" height="58.202mm" viewBox="0 0 58.219 58.202"><g stroke-width=".26458"><path d="m7.5963 14.823c3.954.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2053 7.1594 7.1594 7.1594z" fill="#63c740"/><path d="m29.075 14.823c3.9539.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.9541.0-7.1595 3.2053-7.1595 7.1594.0 3.954 3.2054 7.1594 7.1595 7.1594z" fill="#5cabdf"/><path d="m50.552 14.823c3.9542.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2052-7.1594-7.1594-7.1594-3.9539.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2054 7.1594 7.1594 7.1594z" fill="#d66c7b"/><path d="m7.5963 36.301c3.954.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.954.0-7.1594 3.2054-7.1594 7.1595.0 3.9539 3.2053 7.1594 7.1594 7.1594z" fill="#c98def"/><path d="m29.075 36.301c3.9539.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.9541.0-7.1595 3.2054-7.1595 7.1595.0 3.9539 3.2054 7.1594 7.1595 7.1594z" fill="#faa669"/><path d="m7.5963 57.779c3.954.0 7.1594-3.2052 7.1594-7.1594.0-3.9539-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2054-7.1594 7.1594.0 3.9542 3.2053 7.1594 7.1594 7.1594z" fill="#3aefc4"/></g></svg></a></li><li><a href=https://github.com/getvictor target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/lyuboslavsky/ target=_blank title=LinkedIn rel=me><svg width="16" height="16" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401m-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4"/></svg></a></li><li><a href=http://www.youtube.com/@VictorOnSoftware target=_blank title=YouTube rel=me><svg height="800" width="800" id="Layer_1" viewBox="0 0 461.001 461.001"><g><path style="fill:#f61c0d" d="M365.257 67.393H95.744C42.866 67.393.0 110.259.0 163.137v134.728c0 52.878 42.866 95.744 95.744 95.744h269.513c52.878.0 95.744-42.866 95.744-95.744V163.137c0-52.878-42.866-95.744-95.744-95.744zM300.506 237.056l-126.06 60.123c-3.359 1.602-7.239-.847-7.239-4.568V168.607c0-3.774 3.982-6.22 7.348-4.514l126.06 63.881C304.363 229.873 304.298 235.248 300.506 237.056z"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/page/speaking/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 2m0 3a3 3 0 013-3h0a3 3 0 013 3v5a3 3 0 01-3 3h0a3 3 0 01-3-3z"/><path d="M5 10a7 7 0 0014 0"/><path d="M8 21h8"/><path d="M12 17v4"/></svg>
<span>Speaking</span></a></li><li><a href=/page/tools/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Software tools</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/how-to-use-tpm/><img src=/posts/how-to-use-tpm/tpm-key-hierarchy-headline_hu_2b6f5df8617d5141.png srcset="/posts/how-to-use-tpm/tpm-key-hierarchy-headline_hu_2b6f5df8617d5141.png 800w, /posts/how-to-use-tpm/tpm-key-hierarchy-headline_hu_a28f25d92d28e1ca.png 1600w" width=800 height=419 loading=lazy alt="Featured image of post How to use TPM 2.0 to secure private keys"></a></div><div class=article-details><header class=article-category><a href=/categories/software-development/>Software Development
</a><a href=/categories/security/>Security</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/how-to-use-tpm/>How to use TPM 2.0 to secure private keys</a></h2><h3 class=article-subtitle>A practical guide to generating, storing, and using private keys with hardware-backed protection</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 02, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>9 minute read</time></div></footer></div></header><section class=article-content><ul><li><a class=link href=#tpm-architecture>TPM architecture</a></li><li><a class=link href=#tpm-key-storage>TPM key storage</a></li><li><a class=link href=#tpm-key-hierarchy-model>TPM key hierarchy model</a></li><li><a class=link href=#tpm-signing>TPM signing</a></li></ul><p>Trusted Platform Module (TPM) is a secure cryptoprocessor for many security applications requiring strong device
identity, data protection, and platform integrity. Some uses include:</p><ul><li>Device identity and attestation</li><li>Secure boot</li><li>Key storage</li><li>Disk encryption</li><li>Digital signatures</li></ul><p>TPM 1.2 was standardized in 2009 as ISO/IEC 11889:2009. TPM 2.0, the most common today, came out in 2015 with the
<a class=link href=https://www.iso.org/standard/66510.html target=_blank rel=noopener>ISO/IEC 11889:2015 standard</a>. The link is for part 1 of the standard (out of
4).</p><p>Although many people think of TPM as a hardware chip, it has many possible implementations. They are:</p><ul><li>A dedicated TPM chip</li><li>Integrated TPM as part of another chip (e.g., an ARM-based SoC)</li><li>Firmware TPMs (fTPMs) that run in the CPU&rsquo;s trusted execution environment</li><li>Virtual TPMs (vTPMs) are provided by hypervisors to provide security to virtual environments</li><li>Software TPMs are emulators of TPMs. They are helpful for development purposes</li></ul><p>In this article, we will focus on the use case of storing a private key in TPM 2.0.</p><h2 id=tpm-architecture><a href=#tpm-architecture class=header-anchor></a>TPM architecture</h2><pre class=mermaid>
  graph TD
    subgraph TPM
        subgraph Memory
            VM[&lt;b&gt;Volatile Memory&lt;/b&gt;&lt;br/&gt;Temporary keys, Sessions,&lt;br/&gt;Buffers]
            NV[&lt;b&gt;Non-Volatile Memory&lt;/b&gt;&lt;br/&gt;EK, SRK, Policies,&lt;br/&gt;NV indexes]
        end

        subgraph Crypto engine
            CC[Cryptographic Coprocessor]
            RNG[Random Number Generator]
            KGEN[Key Generation Logic]
            CC --&gt;|Uses| RNG
            KGEN --&gt;|Uses| RNG
            CC --&gt;|Performs| ENC[Encryption/Decryption]
            CC --&gt;|Performs| SIG[Digital Signature / Hashing]
        end

        subgraph Control logic
            PCR[&#34;Platform Configuration&lt;br/&gt;Registers&lt;br/&gt;(PCRs)&#34;]
            MM[Command Processing&lt;br/&gt;Engine /&lt;br/&gt;State Machine]
        end

    end

  style TPM fill:#5c2d91,stroke:#fff,stroke-width:2px,color:#fff
  style CC fill:#1f4e79,stroke:#fff,color:#fff
  style KGEN fill:#1f4e79,stroke:#fff,color:#fff
  style RNG fill:#2e7d32,stroke:#fff,color:#fff
  style NV fill:#5d4037,stroke:#fff,color:#fff
  style VM fill:#5d4037,stroke:#fff,color:#fff
  style PCR fill:#7b1fa2,stroke:#fff,color:#fff
  style MM fill:#37474f,stroke:#fff,color:#fff
  style ENC fill:#455a64,stroke:#fff,stroke-dasharray: 5 5,color:#fff
  style SIG fill:#455a64,stroke:#fff,stroke-dasharray: 5 5,color:#fff
</pre><p>This TPM architecture diagram illustrates the internal components of a Trusted Platform Module, highlighting its secure
cryptographic engine, non-volatile and volatile memory, and control subsystems. Key elements include the cryptographic
coprocessor, random number generator, and key generation logic, all operating within a hardware-isolated boundary. The
platform configuration registers (PCRs) and command processing engine manage system state and policy enforcement, while
non-volatile memory stores persistent keys and metadata. Non-volatile storage includes the Endorsement Key (EK), a
unique, factory-installed identity key, and the Storage Root Key (SRK), which anchors the TPM&rsquo;s key hierarchy.</p><h2 id=tpm-key-storage><a href=#tpm-key-storage class=header-anchor></a>TPM key storage</h2><p>TPM defines four main authorization hierarchies, each rooted in a different seed and intended for various use cases:</p><div class=table-wrapper><table><thead><tr><th>Hierarchy</th><th>Seed Used</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>Owner</strong></td><td><em>Storage Seed</em></td><td>Storage keys, general-purpose keys</td></tr><tr><td><strong>Endorsement</strong></td><td><em>Endorsement Seed</em></td><td>Identity, attestation (e.g. EK)</td></tr><tr><td><strong>Platform</strong></td><td><em>Platform Seed</em></td><td>Firmware-level trust & control</td></tr><tr><td><strong>Null</strong></td><td><em>(None)</em></td><td>Ephemeral keys not tied to any seed</td></tr></tbody></table></div><p>Each hierarchy has:</p><ul><li>Its own <strong>seed</strong></li><li>Its own <strong>authorization policy</strong> (e.g., owner password)</li><li>Its own <strong>logical namespace</strong> for creating keys</li></ul><p>We will focus on the <strong>Owner</strong> hierarchy.</p><p>While TPMs are capable of securely storing cryptographic keys, most applications avoid storing keys directly in the TPM
in practice. This is because the amount of available non-volatile storage varies significantly between TPM models and is
often limited. Instead, keys are typically generated or loaded temporarily into the TPM or stored externally in
encrypted form and only used inside the TPM when needed.</p><h2 id=tpm-key-hierarchy-model><a href=#tpm-key-hierarchy-model class=header-anchor></a>TPM key hierarchy model</h2><p>In addition to the authorization hierarchies, the TPM organizes keys in a hierarchy. This model helps balance
performance, security, and the TPM&rsquo;s limited storage.</p><p>Storage Seed ‚Üí Parent Key ‚Üí Child Key</p><h3 id=storage-seed-owner><a href=#storage-seed-owner class=header-anchor></a>Storage seed (Owner)</h3><p>The seed is a non-exportable, hardware-internal value that acts as the TPM&rsquo;s true root key. You can&rsquo;t access it, but you
can use it indirectly. <strong>The storage seed cannot be modified.</strong></p><h3 id=parent-key><a href=#parent-key class=header-anchor></a>Parent key</h3><p>Parent keys are stored persistently in TPM non-volatile memory or reloaded as needed. A parent key is any key used to
encrypt (wrap) one or more child keys. The parent key must be already loaded in the TPM to load/use any of its children.</p><p>When creating a parent key, the TPM <strong>does not randomly generate</strong> the key unless you explicitly ask it to. Instead, if
you provide:</p><ul><li>The same hierarchy (e.g., the Owner ties it to the storage seed)</li><li>The same key template (same attributes, algorithms, policy)</li><li>The same authorization (e.g., null password)</li></ul><p>&mldr; then the TPM will derive <strong>the exact same key</strong> every time.</p><p>The TPM uses a deterministic KDF (key derivation function). This determinism means the application does not need to
store the parent key explicitly. It can be recreated when needed.</p><h4 id=create-a-parent-key-example><a href=#create-a-parent-key-example class=header-anchor></a>Create a parent key example</h4><p><a class=link href=https://github.com/tpm2-software/tpm2-tools target=_blank rel=noopener>tpm2-tools</a> is the official CLI toolset for interacting with TPM 2.0 via
the TPM2 Software Stack (tss). Install it on Ubuntu/Debian like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install tpm2-tools
</span></span></code></pre></div><p>The <code>tpm2-tss</code> should already be installed or pulled in as part of <code>tpm2-tools</code> installation. You can check for these
libraries with: <code>dpkg -l | grep libtss2</code></p><p>To interact with the TPM device using <code>tpm2-tools</code>, the user must either be root or a member of the <code>tss</code> group, which
has access to <code>/dev/tpmrm0</code>. To add the user to the <code>tss</code> group, you can:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo usermod -aG tss $USER
</span></span></code></pre></div><p>Then <strong>log out and log back in</strong> for the group change to take effect.</p><p>Our examples use <code>tpm2-tools</code> version 5.6. See
<a class=link href=https://tpm2-tools.readthedocs.io/en/latest/ target=_blank rel=noopener>the tpm2-tools documentation</a> for details. To create a transient parent
key in TPM 2.0 using TSS (tpm2-tools) CLI, use the <code>tpm2_createprimary</code> command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tpm2_createprimary <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --hierarchy<span style=color:#f92672>=</span>owner <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --key-algorithm<span style=color:#f92672>=</span>rsa <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --hash-algorithm<span style=color:#f92672>=</span>sha256 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --attributes<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;fixedtpm|fixedparent|sensitivedataorigin|userwithauth|decrypt|restricted&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --key-context<span style=color:#f92672>=</span>parent.ctx
</span></span></code></pre></div><p>This command creates the <code>parent.ctx</code> context file, which can be used in later commands.</p><p>Below is an equivalent example of creating the parent key using the <a class=link href=https://github.com/google/go-tpm target=_blank rel=noopener>go-tpm</a> library:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Create a parent key template with the required attributes</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>parentTemplate</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>New2B</span>(<span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMTPublic</span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Type</span>:    <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgRSA</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>NameAlg</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgSHA256</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ObjectAttributes</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAObject</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>FixedTPM</span>:            <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// bound to TPM that created it</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>FixedParent</span>:         <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// Required</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>SensitiveDataOrigin</span>: <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// key material generated internally</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>UserWithAuth</span>:        <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// Required, even if we use nil password</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Decrypt</span>:             <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// Allows key to be used for decryption/unwrapping</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Restricted</span>:          <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// Limits use to decryption of child keys</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Parameters</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>NewTPMUPublicParms</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgRSA</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMSRSAParms</span>{
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>KeyBits</span>: <span style=color:#ae81ff>2048</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Symmetric</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMTSymDefObject</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Algorithm</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgAES</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>KeyBits</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>NewTPMUSymKeyBits</span>(
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgAES</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMKeyBits</span>(<span style=color:#ae81ff>128</span>),
</span></span><span style=display:flex><span>        ),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Mode</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>NewTPMUSymMode</span>(
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgAES</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgCFB</span>,
</span></span><span style=display:flex><span>        ),
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  ),
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>primaryKey</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>CreatePrimary</span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PrimaryHandle</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMRHOwner</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>InPublic</span>:      <span style=color:#a6e22e>parentTemplate</span>,
</span></span><span style=display:flex><span>}.<span style=color:#a6e22e>Execute</span>(<span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>device</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=child-key><a href=#child-key class=header-anchor></a>Child key</h3><p>A <strong>child key</strong> in TPM 2.0 is created <strong>under a parent key</strong> (which must already exist or be loaded). The child key is
<strong>wrapped (encrypted)</strong> by the parent key and is not usable on its own‚Äîit must be <strong>unwrapped (loaded)</strong> by the TPM
using the correct parent key.</p><p>To create a child ECC key using <code>tpm2-tools</code>, use the <code>tpm2-create</code> command, like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tpm2_create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --parent-context<span style=color:#f92672>=</span>parent.ctx <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --key-algorithm<span style=color:#f92672>=</span>ecc_nist_p256 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --hash-algorithm<span style=color:#f92672>=</span>sha256 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --attributes<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;fixedtpm|fixedparent|sensitivedataorigin|userwithauth|sign|decrypt&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --public<span style=color:#f92672>=</span>child.pub <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --private<span style=color:#f92672>=</span>child.priv
</span></span></code></pre></div><p>This command creates the <code>child.pub</code> and <code>child.priv</code> files which can be used in later commands.</p><p>To load the child key into the TPM using <code>tpm2-tools</code>, use the <code>tpm2_load</code> command, like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tpm2_load <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --parent-context<span style=color:#f92672>=</span>parent.ctx <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --public<span style=color:#f92672>=</span>child.pub <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --private<span style=color:#f92672>=</span>child.priv <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --key-context<span style=color:#f92672>=</span>child.ctx
</span></span></code></pre></div><p>This command creates the <code>child.ctx</code> context file which can be used later.</p><p>Below is an equivalent example of creating the child key using the <a class=link href=https://github.com/google/go-tpm target=_blank rel=noopener>go-tpm</a> library,
loading the key into the TPM, and saving the context for subsequent reuse:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Create an ECC key template for the child key</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>eccTemplate</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>New2B</span>(<span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMTPublic</span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Type</span>:    <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgECC</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>NameAlg</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgSHA256</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ObjectAttributes</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAObject</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>FixedTPM</span>:            <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>FixedParent</span>:         <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>SensitiveDataOrigin</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>UserWithAuth</span>:        <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// Required even if the password is nil</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>SignEncrypt</span>:         <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Decrypt</span>:             <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Parameters</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>NewTPMUPublicParms</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgECC</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMSECCParms</span>{
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>CurveID</span>: <span style=color:#a6e22e>curveID</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  ),
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Create the key under the transient parent</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>createKey</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>Create</span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ParentHandle</span>: <span style=color:#a6e22e>parentKeyHandle</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>InPublic</span>:     <span style=color:#a6e22e>eccTemplate</span>,
</span></span><span style=display:flex><span>}.<span style=color:#a6e22e>Execute</span>(<span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>device</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Load the key</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>loadedKey</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>Load</span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ParentHandle</span>: <span style=color:#a6e22e>parentKeyHandle</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>InPrivate</span>:    <span style=color:#a6e22e>createKey</span>.<span style=color:#a6e22e>OutPrivate</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>InPublic</span>:     <span style=color:#a6e22e>createKey</span>.<span style=color:#a6e22e>OutPublic</span>,
</span></span><span style=display:flex><span>}.<span style=color:#a6e22e>Execute</span>(<span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>device</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Save the key context</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>keyContext</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>ContextSave</span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>SaveHandle</span>: <span style=color:#a6e22e>loadedKey</span>.<span style=color:#a6e22e>ObjectHandle</span>,
</span></span><span style=display:flex><span>}.<span style=color:#a6e22e>Execute</span>(<span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>device</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=-where-can-a-child-key-be-persisted><a href=#-where-can-a-child-key-be-persisted class=header-anchor></a>üìÅ Where can a child key be persisted?</h4><p>The most common approach is to persist the child keys outside the TPM.</p><ul><li>You store the child&rsquo;s public key and private key blob on a disk, in a secure database, or in a file system.</li><li>When you need to use the key, you <strong>load it into the TPM</strong></li></ul><p>This storage approach is safe because:</p><ul><li>The private key is always encrypted with the TPM&rsquo;s parent key</li><li>Only the correct TPM with the correct parent key can decrypt/use it</li></ul><p>There is also a de facto standard for
<a class=link href=https://www.hansenpartnership.com/draft-bottomley-tpm2-keys.html target=_blank rel=noopener>storing TPM 2.0 key files using ASN.1 structure</a>.
OpenConnect VPN and several other tools use this standard.</p><h2 id=tpm-signing><a href=#tpm-signing class=header-anchor></a>TPM signing</h2><p>TPM can sign data using the child key. The output signature is in raw binary.</p><p>To sign using <code>tpm2-tools</code>, use the <code>tpm2_sign</code> command, like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Create dummy data and a dummy digest</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;hello world&#34;</span> &gt; data.in.raw
</span></span><span style=display:flex><span>cat data.in.raw | openssl dgst -sha256 -binary &gt; digest.bin
</span></span><span style=display:flex><span><span style=color:#75715e># Sign the digest</span>
</span></span><span style=display:flex><span>tpm2_sign <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --key-context<span style=color:#f92672>=</span>child.ctx <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --hash-algorithm<span style=color:#f92672>=</span>sha256 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --digest <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --format<span style=color:#f92672>=</span>plain <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --signature<span style=color:#f92672>=</span>signature.plain digest.bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Now we will verify the signature using openssl.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># First, we need the child public key in PEM format.</span>
</span></span><span style=display:flex><span>tpm2_readpublic <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --object-context<span style=color:#f92672>=</span>child.ctx <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --output<span style=color:#f92672>=</span>child.pem <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --format<span style=color:#f92672>=</span>pem
</span></span><span style=display:flex><span><span style=color:#75715e># Now, we can verify the signature.</span>
</span></span><span style=display:flex><span>openssl dgst <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -sha256 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -verify<span style=color:#f92672>=</span>child.pem <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -keyform<span style=color:#f92672>=</span>pem <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -signature<span style=color:#f92672>=</span>signature.plain <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  data.in.raw
</span></span></code></pre></div><p>Below is an example of signing using the <a class=link href=https://github.com/google/go-tpm target=_blank rel=noopener>go-tpm</a> library:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>sign</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>Sign</span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>KeyHandle</span>: <span style=color:#a6e22e>childKeyHandle</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Digest</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPM2BDigest</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Buffer</span>: <span style=color:#a6e22e>digest</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>InScheme</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMTSigScheme</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Scheme</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgECDSA</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Details</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>NewTPMUSigScheme</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMAlgECDSA</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMSSchemeHash</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>HashAlg</span>: <span style=color:#a6e22e>hashAlg</span>,
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Validation</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMTTKHashCheck</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Tag</span>: <span style=color:#a6e22e>tpm2</span>.<span style=color:#a6e22e>TPMSTHashCheck</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>rsp</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>sign</span>.<span style=color:#a6e22e>Execute</span>(<span style=color:#a6e22e>tpm</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Get the ECDSA signature</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ecdsaSig</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>rsp</span>.<span style=color:#a6e22e>Signature</span>.<span style=color:#a6e22e>Signature</span>.<span style=color:#a6e22e>ECDSA</span>()
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=further-reading><a href=#further-reading class=header-anchor></a>Further reading</h2><ul><li><p><strong><a class=link href=../http-message-signatures/>HTTP message signatures</a></strong><br>Explore RFC 9421 for securing API requests with cryptographic signatures. See how industry leaders implement message
signing and learn practical strategies for key distribution and replay attack prevention.</p></li><li><p><strong><a class=link href=../mtls-hello-world/>Mutual TLS intro and hands-on example: mTLS Hello World</a></strong><br>A quick and practical introduction to mutual TLS (mTLS), including how client certificate authentication works and how
to try it with a simple example.</p></li><li><p><strong><a class=link href=../mtls-vs-http-signature/>Comparing mTLS and HTTP signatures</a></strong><br>A practical guide to securing HTTP requests with transport-layer or application-layer authentication. Understand the
tradeoffs between connection-level and message-level security approaches.</p></li><li><p><strong><a class=link href=../why-you-need-vlan/>What is a VLAN and why you need it in your home network</a></strong><br>Learn how VLANs isolate devices to improve home network security and what you need to configure on your router,
switch, and access points.</p></li></ul><h2 id=watch-the-explanation-of-securing-private-keys-with-tpm><a href=#watch-the-explanation-of-securing-private-keys-with-tpm class=header-anchor></a>Watch the explanation of securing private keys with TPM</h2><div class=video-wrapper><iframe loading=lazy src=https://www.youtube.com/embed/zwnznp5KeQs allowfullscreen title="YouTube Video"></iframe></div><p><em>Note:</em> If you want to comment on this article, please do so on the YouTube video.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/cyber-security/>Cyber Security</a>
<a href=/tags/application-security/>Application Security</a>
<a href=/tags/golang/>Golang</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/get-args-from-stdin/><div class=article-image><img src=/posts/get-args-from-stdin/stdin-headline.cf73246657a79bf645a99e743dca1f1f_hu_4c055ea78c0c4a23.png width=250 height=150 loading=lazy alt="Featured image of post Why you should use STDIN to read your program arguments" data-hash="md5-z3MkZlenm/ZFqZ50PcofHw=="></div><div class=article-details><h2 class=article-title>Why you should use STDIN to read your program arguments</h2></div></a></article><article class=has-image><a href=/posts/mtls-go-client-windows-certificate-store/><div class=article-image><img src=/posts/mtls-go-client-windows-certificate-store/mtls-go-windows.0a8dfbc39a48ef72269453d3110b2806_hu_451927e505aad89a.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client using Windows certificate store" data-hash="md5-Co37w5pI73ImlFPTEQsoBg=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client using Windows certificate store</h2></div></a></article><article class=has-image><a href=/posts/mtls-go-client-using-apple-keychain/><div class=article-image><img src=/posts/mtls-go-client-using-apple-keychain/mtls-go-apple-keychain.4be855897ea7b8897e027a30c449d256_hu_caafedfb4a15f47b.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client using macOS keychain" data-hash="md5-S+hViX6nuIl+AnowxEnSVg=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client using macOS keychain</h2></div></a></article><article class=has-image><a href=/posts/mtls-go-custom-signer/><div class=article-image><img src=/posts/mtls-go-custom-signer/signer.4d60e63c2cfbb31978535b2b67059f38_hu_b4972da075e973f6.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client with custom certificate signer" data-hash="md5-TWDmPCz7sxl4U1srZwWfOA=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client with custom certificate signer</h2></div></a></article><article class=has-image><a href=/posts/mtls-go-client/><div class=article-image><img src=/posts/mtls-go-client/go-client.d367a206fbe9c06685ee92f65e0026b9_hu_15226410fb3a62b6.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client" data-hash="md5-02eiBvvpwGaF7pL2XgAmuQ=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2026 Victor on Software</section><section class=powerby></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true, theme: 'dark' });
</script>