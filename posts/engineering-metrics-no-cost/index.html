<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Use GitHub, Grafana, SQL, and free-tier infrastructure to power your engineering benchmarks"><title>Full-featured engineering metrics—for free</title><link rel=canonical href=https://victoronsoftware.com/posts/engineering-metrics-no-cost/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Full-featured engineering metrics—for free"><meta property='og:description' content="Use GitHub, Grafana, SQL, and free-tier infrastructure to power your engineering benchmarks"><meta property='og:url' content='https://victoronsoftware.com/posts/engineering-metrics-no-cost/'><meta property='og:site_name' content='Victor on Software'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='Engineering Management'><meta property='article:tag' content='GitHub Actions'><meta property='article:tag' content='Grafana'><meta property='article:tag' content='BigQuery'><meta property='article:published_time' content='2025-05-16T00:00:00+00:00'><meta property='article:modified_time' content='2025-05-16T00:00:00+00:00'><meta property='og:image' content='https://victoronsoftware.com/posts/engineering-metrics-no-cost/engineering-metrics-headline.png'><meta property='article:author' content='Victor Lyuboslavsky'><meta name=twitter:title content="Full-featured engineering metrics—for free"><meta name=twitter:description content="Use GitHub, Grafana, SQL, and free-tier infrastructure to power your engineering benchmarks"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://victoronsoftware.com/posts/engineering-metrics-no-cost/engineering-metrics-headline.png'><script async src="https://www.googletagmanager.com/gtag/js?id=G-1XV381YSQ8"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1XV381YSQ8")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_c8fdb37897842f49.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Victor on Software</a></h1><h2 class=site-description>Software engineering, security, and related topics</h2></div></header><ol class=menu-social><li><a href=https://fleetdm.com target=_blank title=Fleet rel=me><svg width="58.219mm" height="58.202mm" viewBox="0 0 58.219 58.202"><g stroke-width=".26458"><path d="m7.5963 14.823c3.954.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2053 7.1594 7.1594 7.1594z" fill="#63c740"/><path d="m29.075 14.823c3.9539.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.9541.0-7.1595 3.2053-7.1595 7.1594.0 3.954 3.2054 7.1594 7.1595 7.1594z" fill="#5cabdf"/><path d="m50.552 14.823c3.9542.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2052-7.1594-7.1594-7.1594-3.9539.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2054 7.1594 7.1594 7.1594z" fill="#d66c7b"/><path d="m7.5963 36.301c3.954.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.954.0-7.1594 3.2054-7.1594 7.1595.0 3.9539 3.2053 7.1594 7.1594 7.1594z" fill="#c98def"/><path d="m29.075 36.301c3.9539.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.9541.0-7.1595 3.2054-7.1595 7.1595.0 3.9539 3.2054 7.1594 7.1595 7.1594z" fill="#faa669"/><path d="m7.5963 57.779c3.954.0 7.1594-3.2052 7.1594-7.1594.0-3.9539-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2054-7.1594 7.1594.0 3.9542 3.2053 7.1594 7.1594 7.1594z" fill="#3aefc4"/></g></svg></a></li><li><a href=https://github.com/getvictor target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/lyuboslavsky/ target=_blank title=LinkedIn rel=me><svg width="16" height="16" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401m-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4"/></svg></a></li><li><a href=http://www.youtube.com/@VictorOnSoftware target=_blank title=YouTube rel=me><svg height="800" width="800" id="Layer_1" viewBox="0 0 461.001 461.001"><g><path style="fill:#f61c0d" d="M365.257 67.393H95.744C42.866 67.393.0 110.259.0 163.137v134.728c0 52.878 42.866 95.744 95.744 95.744h269.513c52.878.0 95.744-42.866 95.744-95.744V163.137c0-52.878-42.866-95.744-95.744-95.744zM300.506 237.056l-126.06 60.123c-3.359 1.602-7.239-.847-7.239-4.568V168.607c0-3.774 3.982-6.22 7.348-4.514l126.06 63.881C304.363 229.873 304.298 235.248 300.506 237.056z"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/page/speaking/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 2m0 3a3 3 0 013-3h0a3 3 0 013 3v5a3 3 0 01-3 3h0a3 3 0 01-3-3z"/><path d="M5 10a7 7 0 0014 0"/><path d="M8 21h8"/><path d="M12 17v4"/></svg>
<span>Speaking</span></a></li><li><a href=/page/tools/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Software tools</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/engineering-metrics-no-cost/><img src=/posts/engineering-metrics-no-cost/engineering-metrics-headline_hu_2a9c0626872fab33.png srcset="/posts/engineering-metrics-no-cost/engineering-metrics-headline_hu_2a9c0626872fab33.png 800w, /posts/engineering-metrics-no-cost/engineering-metrics-headline_hu_b0704e886f71974d.png 1600w" width=800 height=419 loading=lazy alt="Featured image of post Full-featured engineering metrics—for free"></a></div><div class=article-details><header class=article-category><a href=/categories/software-development/>Software Development</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/engineering-metrics-no-cost/>Full-featured engineering metrics—for free</a></h2><h3 class=article-subtitle>Use GitHub, Grafana, SQL, and free-tier infrastructure to power your engineering benchmarks</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 16, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>8 minute read</time></div></footer></div></header><section class=article-content><p>Tracking engineering metrics doesn&rsquo;t have to mean signing up for another expensive SaaS tool. This guide will show you
how to build a flexible, powerful, and completely free metrics dashboard using open-source tools like Grafana and a fast
analytical database. Whether you&rsquo;re monitoring cycle time, bug fix velocity, or pull request activity, this setup gives
you deep visibility that your team will actually want to look at.</p><p>In our previous <a class=link href=../track-engineering-metrics/>engineering metrics guide</a>, we showed a basic way to track metrics using
GitHub Actions and the Google Sheets API. The data in Google Sheets can be visualized using a tool like
<a class=link href=https://lookerstudio.google.com/ target=_blank rel=noopener>Google&rsquo;s Looker Studio</a>. However, we wanted more powerful visualizations that could
be dynamically sliced, diced, and drilled down into. Also, we wanted the tools to be free so we wouldn&rsquo;t need to justify
the costs to our management.</p><h2 id=the-free-engineering-benchmarks-stack><a href=#the-free-engineering-benchmarks-stack class=header-anchor></a>The free engineering benchmarks stack</h2><p>As in our previous example, we used <a class=link href=https://github.com/features/actions target=_blank rel=noopener>GitHub Actions</a> to schedule our metrics
collection and compute the data we wanted to track.</p><p>For visualizations, we decided on <a class=link href=https://grafana.com/oss/grafana/ target=_blank rel=noopener>Grafana</a>. Grafana is a leader in visualizing data,
is open source, and can be self-hosted. We used Grafana&rsquo;s free cloud tier for this example since we didn&rsquo;t want to spin
up any infrastructure ourselves.</p><figure><img src=/posts/engineering-metrics-no-cost/grafana-cloud-free.png alt="Free observability plan with generous limits: 10k metrics, 50GB logs, 50GB traces, 50GB profiles, 500 VUh of k6 testing, 50k frontend sessions, 2,232 app observability host hours, 2,232 Kubernetes monitoring host hours, 37,944 container hours, 14-day data retention, and support for 3 active users."></figure><p>However, the problem with Grafana Cloud&rsquo;s free tier is that data is retained for only 14 days. We wanted to keep and
compare our engineering metrics year over year. Due to its generous free tier, we decided to use
<a class=link href="https://cloud.google.com/bigquery?hl=en" target=_blank rel=noopener>Google&rsquo;s BigQuery</a> analytics database.</p><ul><li>Storage: The first 10 GiB per month is free.</li><li>Queries: The first 1 TiB of query data processed per month is free.</li></ul><p>We created a project in Google Cloud Console, created a dataset (github_metrics), made a service account with BigQuery
roles, and created a JWT key for the service account to use with our app.</p><figure><img src=/posts/engineering-metrics-no-cost/bigquery-service-account.png alt="Roles for the BigQuery service account."></figure><p><em>Note:</em> BigQuery has a sandbox mode that does not require a credit card. However, it has some API limitations. We
recommend enabling billing on the account and monitoring your usage to ensure you stay within the free limits.</p><h2 id=picking-the-metric-to-track-pickup-time><a href=#picking-the-metric-to-track-pickup-time class=header-anchor></a>Picking the metric to track: pickup time</h2><p>There are many engineering benchmark metrics we could have started with, but we decided to start with one that we&rsquo;ve
been keenly aware of at many points in our development life. When developers finish implementing and testing their
feature and put it up for review, sometimes the PR sits there for days at a time. This waiting time is a frustrating
experience for developers, especially if they or others depend on those changes to make progress in their work. This
time to review has a direct impact on engineering velocity.</p><p>We define pickup time as the time from when the PR is marked as ready for review until the code review is done. The
reviewer does not need to approve the change; they can also reject or simply comment on it. We are measuring the time
from when the developer finishes their work until they get feedback on their work.</p><h2 id=implementing-metrics-gathering><a href=#implementing-metrics-gathering class=header-anchor></a>Implementing metrics gathering</h2><p>Since we knew our code would run in a GitHub Actions workflow, we implemented it as a
<a class=link href=../github-reusable-workflows-and-steps/#reusable-steps-composite-action>reusable GitHub action</a>. We decided to use
JavaScript (not TypeScript) to simplify the action.</p><p>We used the <a class=link href=https://github.com/octokit/octokit.js target=_blank rel=noopener>octokit.js GitHub API client</a> to fetch the pull requests from our
repo, extract the timeline events and review events from the PRs, and calculate the pickup time.</p><p>In our initial review of the data, we noticed occasional spikes in pickup time on Mondays. That&rsquo;s because pull requests
created on Friday were sitting around over the weekend until being reviewed on Monday. Since we don&rsquo;t expect our
software developers to work weekends, we removed weekends from our calculations. Removing weekends was one of the most
time-consuming implementation details. We created a unit test to make sure we got the details right.</p><p>We added a <code>--print-only</code> option to our program to manually examine the data before we uploaded it to the analytical
database.</p><p>To interface with BigQuery, we used <a class=link href=https://github.com/googleapis/nodejs-bigquery target=_blank rel=noopener>Google&rsquo;s BigQuery Node.js client</a>.
Our table schema was:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>fields</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;review_date&#39;</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;DATE&#39;</span>, <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;REQUIRED&#39;</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;pr_creator&#39;</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;STRING&#39;</span>, <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;REQUIRED&#39;</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;pr_url&#39;</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;STRING&#39;</span>, <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;REQUIRED&#39;</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;pickup_time_seconds&#39;</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;INTEGER&#39;</span>, <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;REQUIRED&#39;</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;repository&#39;</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;STRING&#39;</span>, <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;REQUIRED&#39;</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;pr_number&#39;</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;INTEGER&#39;</span>, <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;REQUIRED&#39;</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;target_branch&#39;</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;STRING&#39;</span>, <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;REQUIRED&#39;</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;ready_time&#39;</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;TIMESTAMP&#39;</span>, <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;REQUIRED&#39;</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;first_review_time&#39;</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;TIMESTAMP&#39;</span>, <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;REQUIRED&#39;</span> }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p>The <code>pr_number</code> was the primary key. Once we calculate and save the pickup time for a PR, we do not update it on future
runs.</p><h2 id=creating-grafana-chart><a href=#creating-grafana-chart class=header-anchor></a>Creating Grafana chart</h2><p>In Grafana, we created a data source connected to our BigQuery database. Then, we created a new dashboard with a new
pickup time chart. We had to decide how to visualize the data. We decided on:</p><ul><li>7-day moving average</li><li>filter by time range</li><li>filter by GitHub username</li><li>filter by user group (e.g., engineering)</li><li>include the PR numbers for each data point for drill down</li></ul><p>We created Grafana variables to filter by username/group.</p><figure><img src=/posts/engineering-metrics-no-cost/grafana-variables.png alt="List of Grafana dashboard variables, including user and user_group."></figure><p>Creating the correct SQL query that gathered all the data and integrated with Grafana&rsquo;s features took considerable time.
Below is the query we came up with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>WITH</span> daily <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    DATE(first_review_time, <span style=color:#e6db74>&#34;America/Chicago&#34;</span>) <span style=color:#66d9ef>AS</span> <span style=color:#66d9ef>day</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>COUNT</span>(<span style=color:#f92672>*</span>) <span style=color:#66d9ef>AS</span> pr_count,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SUM</span>(pickup_time_seconds) <span style=color:#66d9ef>AS</span> total_seconds
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>`</span>engineering<span style=color:#f92672>-</span>metrics<span style=color:#f92672>-</span><span style=color:#ae81ff>123456</span>.github_metrics.pr_pickup_time<span style=color:#f92672>`</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>WHERE</span>
</span></span><span style=display:flex><span>    first_review_time <span style=color:#66d9ef>BETWEEN</span> TIMESTAMP_SUB(TIMESTAMP_MILLIS(<span style=color:#960050;background-color:#1e0010>$</span>__from), INTERVAL <span style=color:#ae81ff>6</span> <span style=color:#66d9ef>DAY</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>AND</span> TIMESTAMP_MILLIS(<span style=color:#960050;background-color:#1e0010>$</span>__to)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>AND</span> (
</span></span><span style=display:flex><span>        <span style=color:#75715e>-- No filters selected: show all
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      (
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#66d9ef>OR</span> <span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;__all&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>AND</span> (<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#66d9ef>OR</span> <span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;__all&#39;</span>)
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>OR</span> (
</span></span><span style=display:flex><span>        <span style=color:#75715e>-- Only user filter applied
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        (<span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;__all&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>AND</span> (<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#66d9ef>OR</span> <span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;__all&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>AND</span> pr_creator <span style=color:#66d9ef>IN</span> <span style=color:#66d9ef>UNNEST</span>(SPLIT(<span style=color:#e6db74>&#39;${user:csv}&#39;</span>, <span style=color:#e6db74>&#39;,&#39;</span>))
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>OR</span> (
</span></span><span style=display:flex><span>        <span style=color:#75715e>-- Only user_group filter applied
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        (<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;__all&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>AND</span> (<span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#66d9ef>OR</span> <span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;__all&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>AND</span> pr_creator <span style=color:#66d9ef>IN</span> <span style=color:#66d9ef>UNNEST</span>(SPLIT(<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span>, <span style=color:#e6db74>&#39;;&#39;</span>))
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>OR</span> (
</span></span><span style=display:flex><span>        <span style=color:#75715e>-- Both filters applied → take intersection
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        (<span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;__all&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>AND</span> (<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;__all&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>AND</span> pr_creator <span style=color:#66d9ef>IN</span> (
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>SELECT</span> val <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>UNNEST</span>(SPLIT(<span style=color:#e6db74>&#39;${user:csv}&#39;</span>, <span style=color:#e6db74>&#39;,&#39;</span>)) val
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>INTERSECT</span> <span style=color:#66d9ef>DISTINCT</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>SELECT</span> val <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>UNNEST</span>(SPLIT(<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span>, <span style=color:#e6db74>&#39;;&#39;</span>)) val
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>day</span>
</span></span><span style=display:flex><span>),
</span></span><span style=display:flex><span>calendar <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#75715e>-- Build list of days in the visible Grafana range
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>day</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>UNNEST</span>(
</span></span><span style=display:flex><span>      GENERATE_DATE_ARRAY(
</span></span><span style=display:flex><span>        DATE(TIMESTAMP_MILLIS(<span style=color:#960050;background-color:#1e0010>$</span>__from)),
</span></span><span style=display:flex><span>        DATE(TIMESTAMP_MILLIS(<span style=color:#960050;background-color:#1e0010>$</span>__to))
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>    ) <span style=color:#66d9ef>AS</span> <span style=color:#66d9ef>day</span>
</span></span><span style=display:flex><span>),
</span></span><span style=display:flex><span>rolling_avg <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>c</span>.<span style=color:#66d9ef>day</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>TIMESTAMP</span>(CONCAT(<span style=color:#66d9ef>CAST</span>(<span style=color:#66d9ef>c</span>.<span style=color:#66d9ef>day</span> <span style=color:#66d9ef>AS</span> STRING), <span style=color:#e6db74>&#39; 12:00:00&#39;</span>)) <span style=color:#66d9ef>AS</span> time,
</span></span><span style=display:flex><span>    <span style=color:#75715e>-- True 7-day weighted average
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    (
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>SUM</span>(d.total_seconds)
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>FROM</span>
</span></span><span style=display:flex><span>        daily d
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>WHERE</span>
</span></span><span style=display:flex><span>        d.<span style=color:#66d9ef>day</span> <span style=color:#66d9ef>BETWEEN</span> DATE_SUB(<span style=color:#66d9ef>c</span>.<span style=color:#66d9ef>day</span>, INTERVAL <span style=color:#ae81ff>6</span> <span style=color:#66d9ef>DAY</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>AND</span> <span style=color:#66d9ef>c</span>.<span style=color:#66d9ef>day</span>
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>/</span> (
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>SUM</span>(d.pr_count)
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>FROM</span>
</span></span><span style=display:flex><span>        daily d
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>WHERE</span>
</span></span><span style=display:flex><span>        d.<span style=color:#66d9ef>day</span> <span style=color:#66d9ef>BETWEEN</span> DATE_SUB(<span style=color:#66d9ef>c</span>.<span style=color:#66d9ef>day</span>, INTERVAL <span style=color:#ae81ff>6</span> <span style=color:#66d9ef>DAY</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>AND</span> <span style=color:#66d9ef>c</span>.<span style=color:#66d9ef>day</span>
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>/</span> <span style=color:#ae81ff>3600</span> <span style=color:#66d9ef>AS</span> moving_avg_hours
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span>
</span></span><span style=display:flex><span>    calendar <span style=color:#66d9ef>c</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>  r.time,
</span></span><span style=display:flex><span>  r.moving_avg_hours,
</span></span><span style=display:flex><span>  (
</span></span><span style=display:flex><span>    <span style=color:#75715e>-- Optional: attach PR numbers per window
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>      ARRAY_AGG(<span style=color:#66d9ef>DISTINCT</span> pr_number)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>FROM</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>`</span>engineering<span style=color:#f92672>-</span>metrics<span style=color:#f92672>-</span><span style=color:#ae81ff>459517</span>.github_metrics.pr_pickup_time<span style=color:#f92672>`</span> p
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>WHERE</span>
</span></span><span style=display:flex><span>      DATE(p.first_review_time, <span style=color:#e6db74>&#34;America/Chicago&#34;</span>) <span style=color:#66d9ef>BETWEEN</span> DATE(DATE_SUB(r.time, INTERVAL <span style=color:#ae81ff>6</span> <span style=color:#66d9ef>DAY</span>))
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>AND</span> DATE(r.time)
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>AND</span> (
</span></span><span style=display:flex><span>          <span style=color:#75715e>-- No filters selected: show all
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        (
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#66d9ef>OR</span> <span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;__all&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>AND</span> (<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#66d9ef>OR</span> <span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;__all&#39;</span>)
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>OR</span> (
</span></span><span style=display:flex><span>          <span style=color:#75715e>-- Only user filter applied
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          (<span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;__all&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>AND</span> (<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#66d9ef>OR</span> <span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;__all&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>AND</span> pr_creator <span style=color:#66d9ef>IN</span> <span style=color:#66d9ef>UNNEST</span>(SPLIT(<span style=color:#e6db74>&#39;${user:csv}&#39;</span>, <span style=color:#e6db74>&#39;,&#39;</span>))
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>OR</span> (
</span></span><span style=display:flex><span>          <span style=color:#75715e>-- Only user_group filter applied
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          (<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;__all&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>AND</span> (<span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#66d9ef>OR</span> <span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;__all&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>AND</span> pr_creator <span style=color:#66d9ef>IN</span> <span style=color:#66d9ef>UNNEST</span>(SPLIT(<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span>, <span style=color:#e6db74>&#39;;&#39;</span>))
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>OR</span> (
</span></span><span style=display:flex><span>          <span style=color:#75715e>-- Both filters applied → take intersection
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          (<span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;__all&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#e6db74>&#39;${user:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>AND</span> (<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;__all&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#e6db74>&#39;${user_group:csv}&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>AND</span> pr_creator <span style=color:#66d9ef>IN</span> (
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>SELECT</span> val <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>UNNEST</span>(SPLIT(<span style=color:#e6db74>&#39;${user:csv}&#39;</span>, <span style=color:#e6db74>&#39;,&#39;</span>)) val
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>INTERSECT</span> <span style=color:#66d9ef>DISTINCT</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>SELECT</span> val <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>UNNEST</span>(SPLIT(<span style=color:#e6db74>&#39;${user_group:csv}&#39;</span>, <span style=color:#e6db74>&#39;;&#39;</span>)) val
</span></span><span style=display:flex><span>          )
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>  ) <span style=color:#66d9ef>AS</span> pr_numbers_window
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span>
</span></span><span style=display:flex><span>  rolling_avg r
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span>
</span></span><span style=display:flex><span>  r.time
</span></span></code></pre></div><p>In the above query, we used Grafana-specific variables such as <code>$__from</code>, <code>$__to</code>, <code>${user:csv}</code>, etc.</p><p>We also had to deal with the timestamp shift problem, where the chart data was off by 1 day, since we were stripping the
time from <code>first_review_time</code> but displaying the data in local time (the day before UTC midnight). This statement
attempts to fix the problem by changing the time to noon: <code>TIMESTAMP(CONCAT(CAST(c.day AS STRING), '12:00:00')) AS time</code></p><p>The final chart looked like this:</p><figure><img src=/posts/engineering-metrics-no-cost/grafana-chart.png alt="7-day moving average of pickup time for Fleet's engineering team."></figure><p>We can inspect the data to drill down into the PR numbers for each data point:</p><figure><img src=/posts/engineering-metrics-no-cost/grafana-inspect-data.png alt="Raw data from the database query, including PR numbers."></figure><p>With the PR numbers, we can explore our data using the following query:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- Sample query to dig into the details. Replace the PR numbers list.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> <span style=color:#f92672>`</span>engineering<span style=color:#f92672>-</span>metrics<span style=color:#f92672>-</span><span style=color:#ae81ff>123456</span>.github_metrics.pr_pickup_time<span style=color:#f92672>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> pr_number <span style=color:#66d9ef>IN</span> (<span style=color:#ae81ff>28625</span>,<span style=color:#ae81ff>28570</span>,<span style=color:#ae81ff>28417</span>,<span style=color:#ae81ff>28658</span>,<span style=color:#ae81ff>28382</span>,<span style=color:#ae81ff>28538</span>,<span style=color:#ae81ff>28608</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> pickup_time_seconds <span style=color:#66d9ef>DESC</span>
</span></span></code></pre></div><h2 id=creating-the-github-actions-workflow><a href=#creating-the-github-actions-workflow class=header-anchor></a>Creating the GitHub Actions workflow</h2><p>Once everything worked, we set up a GitHub workflow to run daily and automatically update the metrics.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Collect PR Pickup Time Metrics</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>schedule</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>cron</span>: <span style=color:#e6db74>&#39;0 9 * * *&#39;</span>  <span style=color:#75715e># Run at 4am CDT (9am UTC)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>workflow_dispatch</span>:      <span style=color:#75715e># Allow manual triggering</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>collect-metrics</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Checkout code</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Set up Node.js</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/setup-node@v4</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>node-version</span>: <span style=color:#e6db74>&#39;16&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>cache</span>: <span style=color:#e6db74>&#39;npm&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Install dependencies</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm ci</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Create service account key file</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          echo &#39;${{ secrets.GCP_SERVICE_ACCOUNT_KEY }}&#39; &gt; service-account-key.json
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          # Verify the file is valid JSON
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          cat service-account-key.json | jq . &gt; /dev/null</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Collect and upload metrics</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>./</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>github-token</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>config-path</span>: <span style=color:#e6db74>&#39;./config.json&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>bigquery-project</span>: <span style=color:#ae81ff>${{ secrets.BIGQUERY_PROJECT_ID }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>bigquery-dataset</span>: <span style=color:#e6db74>&#39;github_metrics&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>bigquery-table</span>: <span style=color:#e6db74>&#39;pr_pickup_time&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>target-branch</span>: <span style=color:#e6db74>&#39;main&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>lookback-days</span>: <span style=color:#e6db74>&#39;30&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>print-only</span>: <span style=color:#e6db74>&#39;false&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>GITHUB_TOKEN</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>BIGQUERY_PROJECT_ID</span>: <span style=color:#ae81ff>${{ secrets.BIGQUERY_PROJECT_ID }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>SERVICE_ACCOUNT_KEY_PATH</span>: <span style=color:#e6db74>&#39;./service-account-key.json&#39;</span>
</span></span></code></pre></div><h2 id=code-on-github><a href=#code-on-github class=header-anchor></a>Code on GitHub</h2><p>Our code is available on GitHub at: <a class=link href=https://github.com/getvictor/pickup-time target=_blank rel=noopener>https://github.com/getvictor/pickup-time</a></p><h2 id=further-reading><a href=#further-reading class=header-anchor></a>Further reading</h2><ul><li><p><a class=link href=../engineering-transparency/>Why transparency beats everything else in engineering</a><br>How visibility into priorities and work creates accountability and transforms engineering culture.</p></li><li><p><a class=link href=../code-complexity-metrics/>How to spot and reduce code complexity</a><br>A practical guide to the most useful metrics for understanding and improving code structure and maintainability.</p></li><li><p><a class=link href=../readable-code/>Turning messy code into clean, readable systems</a><br>Why code readability matters—and how to measure and improve it for long-term productivity.</p></li></ul><h2 id=watch-how-to-set-up-free-engineering-metrics><a href=#watch-how-to-set-up-free-engineering-metrics class=header-anchor></a>Watch how to set up free engineering metrics</h2><div class=video-wrapper><iframe loading=lazy src=https://www.youtube.com/embed/okYOm8IPeKM allowfullscreen title="YouTube Video"></iframe></div><p><em>Note:</em> If you want to comment on this article, please do so on the YouTube video.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/engineering-management/>Engineering Management</a>
<a href=/tags/github-actions/>GitHub Actions</a>
<a href=/tags/grafana/>Grafana</a>
<a href=/tags/bigquery/>BigQuery</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/track-engineering-metrics/><div class=article-image><img src=/posts/track-engineering-metrics/engineering-metrics.9e31007fb4f9d116c52b62694b93cc5e_hu_32d9ae3c686b98cc.png width=250 height=150 loading=lazy alt="Featured image of post How to easily track engineering metrics" data-hash="md5-njEAf7T50RbFK2JpS5PMXg=="></div><div class=article-details><h2 class=article-title>How to easily track engineering metrics</h2></div></a></article><article class=has-image><a href=/posts/code-complexity-metrics/><div class=article-image><img src=/posts/code-complexity-metrics/code-complexity-headline.e67381a165836d782dc969817d257a58_hu_1493dd75ccb92e97.png width=250 height=150 loading=lazy alt="Featured image of post Top code complexity metrics every software dev should know" data-hash="md5-5nOBoWWDbXgtyWmBfSV6WA=="></div><div class=article-details><h2 class=article-title>Top code complexity metrics every software dev should know</h2></div></a></article><article class=has-image><a href=/posts/readable-code/><div class=article-image><img src=/posts/readable-code/readable-code-headline.bc9bdbf58833c0b12da94a4813ce4846_hu_3569583f60d536aa.png width=250 height=150 loading=lazy alt="Featured image of post What is readable code and why is it important?" data-hash="md5-vJvb9YgzwLEtqUpIE85IRg=="></div><div class=article-details><h2 class=article-title>What is readable code and why is it important?</h2></div></a></article><article class=has-image><a href=/posts/typescript-github-action/><div class=article-image><img src=/posts/typescript-github-action/typescript-github-action-headline.1d0212a4921af261af5abfff98dd1b23_hu_88c600f7ba03061c.png width=250 height=150 loading=lazy alt="Featured image of post How to create a custom GitHub Action using TypeScript" data-hash="md5-HQISpJIa8mGvWr//mN0bIw=="></div><div class=article-details><h2 class=article-title>How to create a custom GitHub Action using TypeScript</h2></div></a></article><article class=has-image><a href=/posts/github-reusable-workflows-and-steps/><div class=article-image><img src=/posts/github-reusable-workflows-and-steps/GitHub%20Actions%20thumbnail.1de2a1ac1930c73ab93ff3f52f594721_hu_b2393587962b67eb.png width=250 height=150 loading=lazy alt="Featured image of post How to reuse workflows and steps in GitHub Actions (2024)" data-hash="md5-HeKhrBkwxzq5P/P1L1lHIQ=="></div><div class=article-details><h2 class=article-title>How to reuse workflows and steps in GitHub Actions (2024)</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 Victor on Software</section><section class=powerby></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>