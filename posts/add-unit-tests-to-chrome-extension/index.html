<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Write and run unit tests for your Chrome extension using Jest testing framework"><title>Add unit tests to Chrome extension (2024)</title><link rel=canonical href=https://victoronsoftware.com/posts/add-unit-tests-to-chrome-extension/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="Add unit tests to Chrome extension (2024)"><meta property='og:description' content="Write and run unit tests for your Chrome extension using Jest testing framework"><meta property='og:url' content='https://victoronsoftware.com/posts/add-unit-tests-to-chrome-extension/'><meta property='og:site_name' content='Victor on Software'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='Chrome Extension'><meta property='article:tag' content='Web Development'><meta property='article:tag' content='Unit Testing'><meta property='article:tag' content='TypeScript'><meta property='article:published_time' content='2024-07-26T00:00:00+00:00'><meta property='article:modified_time' content='2024-07-26T00:00:00+00:00'><meta property='og:image' content='https://victoronsoftware.com/posts/add-unit-tests-to-chrome-extension/chrome-jest-headline.png'><meta property='article:author' content='Victor Lyuboslavsky'><meta name=twitter:title content="Add unit tests to Chrome extension (2024)"><meta name=twitter:description content="Write and run unit tests for your Chrome extension using Jest testing framework"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://victoronsoftware.com/posts/add-unit-tests-to-chrome-extension/chrome-jest-headline.png'><script async src="https://www.googletagmanager.com/gtag/js?id=G-1XV381YSQ8"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1XV381YSQ8")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_c8fdb37897842f49.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Victor on Software</a></h1><h2 class=site-description>Software engineering, security, and related topics</h2></div></header><ol class=menu-social><li><a href=https://fleetdm.com target=_blank title=Fleet rel=me><svg width="58.219mm" height="58.202mm" viewBox="0 0 58.219 58.202"><g stroke-width=".26458"><path d="m7.5963 14.823c3.954.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2053 7.1594 7.1594 7.1594z" fill="#63c740"/><path d="m29.075 14.823c3.9539.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.9541.0-7.1595 3.2053-7.1595 7.1594.0 3.954 3.2054 7.1594 7.1595 7.1594z" fill="#5cabdf"/><path d="m50.552 14.823c3.9542.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2052-7.1594-7.1594-7.1594-3.9539.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2054 7.1594 7.1594 7.1594z" fill="#d66c7b"/><path d="m7.5963 36.301c3.954.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.954.0-7.1594 3.2054-7.1594 7.1595.0 3.9539 3.2053 7.1594 7.1594 7.1594z" fill="#c98def"/><path d="m29.075 36.301c3.9539.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.9541.0-7.1595 3.2054-7.1595 7.1595.0 3.9539 3.2054 7.1594 7.1595 7.1594z" fill="#faa669"/><path d="m7.5963 57.779c3.954.0 7.1594-3.2052 7.1594-7.1594.0-3.9539-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2054-7.1594 7.1594.0 3.9542 3.2053 7.1594 7.1594 7.1594z" fill="#3aefc4"/></g></svg></a></li><li><a href=https://github.com/getvictor target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/lyuboslavsky/ target=_blank title=LinkedIn rel=me><svg width="16" height="16" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401m-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4"/></svg></a></li><li><a href=http://www.youtube.com/@VictorOnSoftware target=_blank title=YouTube rel=me><svg height="800" width="800" id="Layer_1" viewBox="0 0 461.001 461.001"><g><path style="fill:#f61c0d" d="M365.257 67.393H95.744C42.866 67.393.0 110.259.0 163.137v134.728c0 52.878 42.866 95.744 95.744 95.744h269.513c52.878.0 95.744-42.866 95.744-95.744V163.137c0-52.878-42.866-95.744-95.744-95.744zM300.506 237.056l-126.06 60.123c-3.359 1.602-7.239-.847-7.239-4.568V168.607c0-3.774 3.982-6.22 7.348-4.514l126.06 63.881C304.363 229.873 304.298 235.248 300.506 237.056z"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/page/tools/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Software tools</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/add-unit-tests-to-chrome-extension/><img src=/posts/add-unit-tests-to-chrome-extension/chrome-jest-headline_hu_1babed679743b0e8.png srcset="/posts/add-unit-tests-to-chrome-extension/chrome-jest-headline_hu_1babed679743b0e8.png 800w, /posts/add-unit-tests-to-chrome-extension/chrome-jest-headline_hu_874b23340333b7a3.png 1600w" width=800 height=419 loading=lazy alt="Featured image of post Add unit tests to Chrome extension (2024)"></a></div><div class=article-details><header class=article-category><a href=/categories/software-development/>Software Development</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/add-unit-tests-to-chrome-extension/>Add unit tests to Chrome extension (2024)</a></h2><h3 class=article-subtitle>Write and run unit tests for your Chrome extension using Jest testing framework</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 26, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>6 minute read</time></div></footer></div></header><section class=article-content><ul><li><a class=link href=#add-jest-to-the-project>Add Jest testing framework</a></li><li><a class=link href=#write-a-unit-test>Write a unit test</a></li><li><a class=link href=#review-unit-test-coverage>Review unit test coverage</a></li></ul><p>This article is part of our <a class=link href=../chrome-extension>series on building a Chrome extension</a>.</p><h2 id=why-add-unit-tests><a href=#why-add-unit-tests class=header-anchor></a>Why add unit tests?</h2><p>Unit tests help us catch bugs early, ensure our extension continues to work as expected in different scenarios, and make
it easier to refactor our code. In this article, we will add unit tests to our Chrome extension.</p><h2 id=add-jest-to-the-project><a href=#add-jest-to-the-project class=header-anchor></a>Add Jest to the project</h2><p><a class=link href=https://jestjs.io/ target=_blank rel=noopener>Jest</a> is a popular JavaScript testing framework. We will use Jest to write and run unit tests for
our Chrome extension.</p><p>To install Jest, run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm install --save-dev jest jest-environment-jsdom ts-jest @types/jest
</span></span></code></pre></div><ul><li><a class=link href=https://www.npmjs.com/package/jest target=_blank rel=noopener>jest</a> is the testing framework</li><li><code>jest-environment-jsdom</code> simulates a browser environment for Jest tests</li><li><a class=link href=https://www.npmjs.com/package/ts-jest target=_blank rel=noopener>ts-jest</a> allows Jest to work with TypeScript</li><li><code>@types/jest</code> provides TypeScript definitions for Jest</li></ul><h2 id=configure-jest><a href=#configure-jest class=header-anchor></a>Configure Jest</h2><p>Create a <code>jest.config.ts</code> file in the root of the project with the following content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#66d9ef>type</span> { <span style=color:#a6e22e>JestConfigWithTsJest</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;ts-jest&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>config</span>: <span style=color:#66d9ef>JestConfigWithTsJest</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setupFiles</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;./__mocks__/chrome.ts&#34;</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>testEnvironment</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;jsdom&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>transform</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;^.+.ts$&#34;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;ts-jest&#34;</span>, {}],
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>config</span>
</span></span></code></pre></div><p>The <code>setupFiles</code> option loads a mock for the Chrome API. In the next step, we will create this mock.</p><p>The <code>testEnvironment</code> option sets a browser testing environment by default. We can override the environment at the top
of each test file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @jest-environment jsdom
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span></code></pre></div><p>The <code>transform</code> option specifies to process TypeScript test files with <code>ts-jest</code>.</p><h2 id=create-a-mock-for-the-chrome-api><a href=#create-a-mock-for-the-chrome-api class=header-anchor></a>Create a mock for the Chrome API</h2><p>Our extension code relies on the Chrome API, which is unavailable in our unit test environment. We will create a mock
for the Chrome API to simulate its behavior in our tests.</p><p>A mock is a fake implementation of a function or object that allows us to test our code in isolation. Mocks are helpful
for testing code that depends on external services or APIs.</p><p>Create a <code>__mocks__</code> folder in the root of the project. The <code>__mocks__</code> name is a Jest convention for mock files. In
that folder, add a <code>chrome.ts</code> file with the following content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// eslint-disable-next-line @typescript-eslint/ban-ts-comment -- disable ESLint check for the next line
</span></span></span><span style=display:flex><span><span style=color:#75715e>// @ts-nocheck -- this TS comment turns off TypeScript type checking for this file because we do not
</span></span></span><span style=display:flex><span><span style=color:#75715e>// mock the entire Chrome API, but only the parts we need
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>global</span>.<span style=color:#a6e22e>chrome</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>runtime</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onInstalled</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>addListener</span>: <span style=color:#66d9ef>jest.fn</span>(),
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onMessage</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>addListener</span>: <span style=color:#66d9ef>jest.fn</span>(),
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onStartup</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>addListener</span>: <span style=color:#66d9ef>jest.fn</span>(),
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>sendMessage</span>: <span style=color:#66d9ef>jest.fn</span>(),
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>storage</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>sync</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>get</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>jest</span>.<span style=color:#a6e22e>fn</span>(),
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>set</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>jest</span>.<span style=color:#a6e22e>fn</span>(),
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The empty <code>jest.fn()</code> implementations can be replaced during testing with custom behavior using Jest&rsquo;s mocking functions
using <a class=link href=https://jestjs.io/docs/jest-object#jestspyonobject-methodname target=_blank rel=noopener>jest.spyOn</a>.</p><h2 id=write-a-unit-test><a href=#write-a-unit-test class=header-anchor></a>Write a unit test</h2><p>We will test the <code>content.ts</code> file in our first unit test. This file contains the logic for the content script that runs
on web pages when the extension is active. The content script blurs a page element that contains a user-defined keyword.</p><p>Create a <code>content.test.ts</code> file in the <code>src</code> folder with the following content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>blurFilter</span>, <span style=color:#a6e22e>observe</span>, <span style=color:#a6e22e>config</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;./content&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>describe</span>(<span style=color:#e6db74>&#34;blur&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;blur a secret&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Define the document (web page) that we will test against
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>innerHTML</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;div id=&#34;testDiv&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &#34;My secret&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;/div&gt;`</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Set value to blur
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>item</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;secret&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Start observing the document.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>observe</span>()
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Make sure the element is blurred as expected
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>testDiv</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;testDiv&#34;</span>) <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>HTMLInputElement</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>testDiv</span>).<span style=color:#a6e22e>toBeDefined</span>()
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>testDiv</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>filter</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#a6e22e>blurFilter</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>In the above test, the Jest functions <code>describe</code> and <code>test</code> define a test suite and a test case, respectively. The
<code>expect</code> function checks whether the test results match the expected values.</p><h2 id=run-the-unit-tests><a href=#run-the-unit-tests class=header-anchor></a>Run the unit tests</h2><p>The Jest unit test can be run using the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npx jest
</span></span></code></pre></div><p>The result of the test should look like:</p><pre tabindex=0><code>  console.debug
    blurred id:testDiv class: tag:DIV text:
          &#34;My secret&#34;

      at blurElement (src/content.ts:36:11)
          at Array.forEach (&lt;anonymous&gt;)
          at Array.forEach (&lt;anonymous&gt;)
          at Array.forEach (&lt;anonymous&gt;)
          at Array.forEach (&lt;anonymous&gt;)

 PASS  src/content.test.ts
  blur
    âœ“ blur a secret (15 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.149 s
Ran all test suites.
</code></pre><p>Add the following script to the <code>package.json</code> file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;scripts&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;test&#34;</span>: <span style=color:#e6db74>&#34;jest&#34;</span>,
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now you can run the tests using the <code>npm test</code> or <code>npm run test</code>.</p><h2 id=review-unit-test-coverage><a href=#review-unit-test-coverage class=header-anchor></a>Review unit test coverage</h2><p>Code coverage measures how much of the code is tested by the unit tests. A high percentage indicates that most of the
code is tested and less likely to contain bugs. Code coverage is an important metric for assessing the quality of the
code. A common target for code coverage is 80% or higher.</p><p>Jest can generate a code coverage report to show which parts of the code are covered by the unit tests. To create a
coverage report, add the <code>--coverage</code> flag to the Jest command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npx jest --coverage
</span></span></code></pre></div><p>The terminal output will include the code coverage summary:</p><pre tabindex=0><code>------------|---------|----------|---------|---------|--------------------------
File        | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
------------|---------|----------|---------|---------|--------------------------
All files   |   45.23 |    48.57 |   42.85 |   45.23 |
 content.ts |   45.23 |    48.57 |   42.85 |   45.23 | 22,26,50-54,62-69,88-117
------------|---------|----------|---------|---------|--------------------------
</code></pre><p>The full report is available in the <code>coverage</code> folder. Open the <code>coverage/lcov-report/index.html</code> file in a browser to
view the detailed coverage report.</p><p>Note that the code coverage report only includes the files in the test run. If you want to include all files in the
coverage report, we can add the <code>collectCoverageFrom</code> option to the <code>jest.config.ts</code> Jest configuration file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>collectCoverageFrom</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;src/**/*.ts&#34;</span>],
</span></span></code></pre></div><p>Now, the report shows a complete picture:</p><pre tabindex=0><code>---------------|---------|----------|---------|---------|--------------------------
File           | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
---------------|---------|----------|---------|---------|--------------------------
All files      |   16.96 |     30.9 |   10.71 |   16.96 |
 background.ts |       0 |        0 |       0 |       0 | 1-21
 common.ts     |       0 |        0 |       0 |       0 | 17-19
 content.ts    |   45.23 |    48.57 |   42.85 |   45.23 | 22,26,50-54,62-69,88-117
 options.ts    |       0 |        0 |       0 |       0 | 2-31
 popup.ts      |       0 |        0 |       0 |       0 | 1-86
---------------|---------|----------|---------|---------|--------------------------
</code></pre><figure><img src=/posts/add-unit-tests-to-chrome-extension/coverage-report.png alt="Coverage report web page showing some coverage for content.ts file and no coverage on other files"><figcaption><h4>HTML coverage report</h4></figcaption></figure><h2 id=adding-unit-tests-to-github-actions><a href=#adding-unit-tests-to-github-actions class=header-anchor></a>Adding unit tests to GitHub Actions</h2><p>To make sure that our unit tests are run automatically on every push to the repository, we can add them to a GitHub
Actions workflow. In the <a class=link href=../linting-and-formatting-typescript>Linting and formatting TypeScript</a> article, we added
ESLint to GitHub Actions. We can add a step to run the Jest tests in the same workflow.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Test</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          npm run test</span>
</span></span></code></pre></div><h2 id=unit-test-code-on-github><a href=#unit-test-code-on-github class=header-anchor></a>Unit test code on GitHub</h2><p>The complete code is available on GitHub at: <a class=link href=https://github.com/getvictor/create-chrome-extension/tree/main/7-unit-tests target=_blank rel=noopener>https://github.com/getvictor/create-chrome-extension/tree/main/7-unit-tests</a></p><h2 id=other-articles-on-unit-testing><a href=#other-articles-on-unit-testing class=header-anchor></a>Other articles on Unit Testing</h2><ul><li><a class=link href=../fuzz-testing-with-go>Explore fuzz testing with Go</a></li></ul><h2 id=watch-how-we-set-up-unit-testing-for-our-chrome-extension><a href=#watch-how-we-set-up-unit-testing-for-our-chrome-extension class=header-anchor></a>Watch how we set up unit testing for our Chrome extension</h2><div class=video-wrapper><iframe loading=lazy src=https://www.youtube.com/embed/EA11fnr8x8g allowfullscreen title="YouTube Video"></iframe></div><p><em>Note:</em> If you want to comment on this article, please do so on the YouTube video.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/chrome-extension/>Chrome Extension</a>
<a href=/tags/web-development/>Web Development</a>
<a href=/tags/unit-testing/>Unit Testing</a>
<a href=/tags/typescript/>TypeScript</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/chrome-extension/><div class=article-image><img src=/posts/chrome-extension/chrome-extension-headline.3273b29c8adcab44a403177e65c9cd3c_hu_5f3bf70a977d7f0b.png width=250 height=150 loading=lazy alt="Featured image of post Build a production-ready Chrome extension in 7 steps" data-hash="md5-MnOynIrcq0SkAxd+ZcnNPA=="></div><div class=article-details><h2 class=article-title>Build a production-ready Chrome extension in 7 steps</h2></div></a></article><article class=has-image><a href=/posts/add-css-framework-to-chrome-extension/><div class=article-image><img src=/posts/add-css-framework-to-chrome-extension/chrome-tailwind-headline.8d2c215c67b61f9761f28e6899e48ecc_hu_8253f2b4502f0336.png width=250 height=150 loading=lazy alt="Featured image of post Add CSS framework to Chrome extension (2024)" data-hash="md5-jSwhXGe2H5dh8o5omeSOzA=="></div><div class=article-details><h2 class=article-title>Add CSS framework to Chrome extension (2024)</h2></div></a></article><article class=has-image><a href=/posts/linting-and-formatting-typescript/><div class=article-image><img src=/posts/linting-and-formatting-typescript/linting-and-formatting-headline.f62a1b3a1d22a8e213587610c90c7a84_hu_4c20dd9e05ad2bda.png width=250 height=150 loading=lazy alt="Featured image of post Linting and formatting TypeScript in Chrome extension (2024)" data-hash="md5-9iobOh0iqOITWHYQyQx6hA=="></div><div class=article-details><h2 class=article-title>Linting and formatting TypeScript in Chrome extension (2024)</h2></div></a></article><article class=has-image><a href=/posts/message-passing-in-chrome-extension/><div class=article-image><img src=/posts/message-passing-in-chrome-extension/message-passing-headline.1b26b5630259df207857e0a8324254cf_hu_c5b6b1e3c04c77e6.png width=250 height=150 loading=lazy alt="Featured image of post Message passing in Chrome extension (2024)" data-hash="md5-Gya1YwJZ3yB4V+CoMkJUzw=="></div><div class=article-details><h2 class=article-title>Message passing in Chrome extension (2024)</h2></div></a></article><article class=has-image><a href=/posts/add-webpack-and-typescript-to-chrome-extension/><div class=article-image><img src=/posts/add-webpack-and-typescript-to-chrome-extension/chrome-typescript-webpack.999cb7a8afab1e22ed67547bb6cf53fe_hu_238b8abdf3b68f58.png width=250 height=150 loading=lazy alt="Featured image of post Add webpack and TypeScript to a Chrome extension (2024)" data-hash="md5-mZy3qK+rHiLtZ1R7ts9T/g=="></div><div class=article-details><h2 class=article-title>Add webpack and TypeScript to a Chrome extension (2024)</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 Victor on Software</section><section class=powerby></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>