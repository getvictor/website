<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Master HTTP message signatures for API security. Learn the RFC 9421 standard, see real implementations from industry leaders, and get practical Node.js code examples"><title>Understanding HTTP message signatures: A developer's guide</title><link rel=canonical href=https://victoronsoftware.com/posts/http-message-signatures/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="Understanding HTTP message signatures: A developer's guide"><meta property='og:description' content="Master HTTP message signatures for API security. Learn the RFC 9421 standard, see real implementations from industry leaders, and get practical Node.js code examples"><meta property='og:url' content='https://victoronsoftware.com/posts/http-message-signatures/'><meta property='og:site_name' content='Victor on Software'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='Application Security'><meta property='article:tag' content='mTLS'><meta property='article:tag' content='JWT'><meta property='article:tag' content='HTTP Message Signatures'><meta property='article:published_time' content='2025-12-09T00:00:00+00:00'><meta property='article:modified_time' content='2025-12-09T00:00:00+00:00'><meta property='og:image' content='https://victoronsoftware.com/posts/http-message-signatures/http-message-signatures.png'><meta property='article:author' content='Victor Lyuboslavsky'><meta name=twitter:title content="Understanding HTTP message signatures: A developer's guide"><meta name=twitter:description content="Master HTTP message signatures for API security. Learn the RFC 9421 standard, see real implementations from industry leaders, and get practical Node.js code examples"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://victoronsoftware.com/posts/http-message-signatures/http-message-signatures.png'><script async src="https://www.googletagmanager.com/gtag/js?id=G-1XV381YSQ8"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1XV381YSQ8")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_2a985bbd48e632da.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Victor on Software</a></h1><h2 class=site-description>Software engineering, security, and related topics</h2></div></header><ol class=menu-social><li><a href=https://fleetdm.com target=_blank title=Fleet rel=me><svg width="58.219mm" height="58.202mm" viewBox="0 0 58.219 58.202"><g stroke-width=".26458"><path d="m7.5963 14.823c3.954.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2053 7.1594 7.1594 7.1594z" fill="#63c740"/><path d="m29.075 14.823c3.9539.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.9541.0-7.1595 3.2053-7.1595 7.1594.0 3.954 3.2054 7.1594 7.1595 7.1594z" fill="#5cabdf"/><path d="m50.552 14.823c3.9542.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2052-7.1594-7.1594-7.1594-3.9539.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2054 7.1594 7.1594 7.1594z" fill="#d66c7b"/><path d="m7.5963 36.301c3.954.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.954.0-7.1594 3.2054-7.1594 7.1595.0 3.9539 3.2053 7.1594 7.1594 7.1594z" fill="#c98def"/><path d="m29.075 36.301c3.9539.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.9541.0-7.1595 3.2054-7.1595 7.1595.0 3.9539 3.2054 7.1594 7.1595 7.1594z" fill="#faa669"/><path d="m7.5963 57.779c3.954.0 7.1594-3.2052 7.1594-7.1594.0-3.9539-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2054-7.1594 7.1594.0 3.9542 3.2053 7.1594 7.1594 7.1594z" fill="#3aefc4"/></g></svg></a></li><li><a href=https://github.com/getvictor target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/lyuboslavsky/ target=_blank title=LinkedIn rel=me><svg width="16" height="16" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401m-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4"/></svg></a></li><li><a href=http://www.youtube.com/@VictorOnSoftware target=_blank title=YouTube rel=me><svg height="800" width="800" id="Layer_1" viewBox="0 0 461.001 461.001"><g><path style="fill:#f61c0d" d="M365.257 67.393H95.744C42.866 67.393.0 110.259.0 163.137v134.728c0 52.878 42.866 95.744 95.744 95.744h269.513c52.878.0 95.744-42.866 95.744-95.744V163.137c0-52.878-42.866-95.744-95.744-95.744zM300.506 237.056l-126.06 60.123c-3.359 1.602-7.239-.847-7.239-4.568V168.607c0-3.774 3.982-6.22 7.348-4.514l126.06 63.881C304.363 229.873 304.298 235.248 300.506 237.056z"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/page/speaking/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 2m0 3a3 3 0 013-3h0a3 3 0 013 3v5a3 3 0 01-3 3h0a3 3 0 01-3-3z"/><path d="M5 10a7 7 0 0014 0"/><path d="M8 21h8"/><path d="M12 17v4"/></svg>
<span>Speaking</span></a></li><li><a href=/page/tools/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Software tools</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/http-message-signatures/><img src=/posts/http-message-signatures/http-message-signatures_hu_1ff79697cdf59af0.png srcset="/posts/http-message-signatures/http-message-signatures_hu_1ff79697cdf59af0.png 800w, /posts/http-message-signatures/http-message-signatures_hu_f62d0adf9758d562.png 1600w" width=800 height=533 loading=lazy alt="Featured image of post Understanding HTTP message signatures: A developer's guide"></a></div><div class=article-details><header class=article-category><a href=/categories/security/>Security
</a><a href=/categories/software-development/>Software Development</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/http-message-signatures/>Understanding HTTP message signatures: A developer's guide</a></h2><h3 class=article-subtitle>Master HTTP message signatures for API security. Learn the RFC 9421 standard, see real implementations from industry leaders, and get practical Node.js code examples</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Dec 09, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>23 minute read</time></div></footer></div></header><section class=article-content><ul><li><a class=link href=#what-are-http-message-signatures>What are HTTP message signatures?</a></li><li><a class=link href=#how-http-message-signatures-compare-to-alternatives>How HTTP message signatures compare to alternatives</a></li><li><a class=link href=#technical-details-of-http-message-signatures>Technical details of HTTP message signatures</a></li><li><a class=link href=#example-implementation>Example implementation</a></li><li><a class=link href=#does-your-api-need-message-level-authentication>Does your API need message-level authentication?</a></li></ul><p>If you&rsquo;ve ever tried to improve security in a real organization, you know how it feels. You come up with what seems like
a good idea, but the moment you share it, someone says:</p><blockquote><p>That&rsquo;s too custom. That&rsquo;s too complicated. That&rsquo;ll break our infrastructure. We don&rsquo;t have time for that.</p></blockquote><p>It&rsquo;s frustrating. You‚Äôre not trying to slow anyone down, you&rsquo;re trying to make things safer.</p><p>That was me a few months ago. Our client/server API used a token stored in a file on a client, and we wanted to make it
more secure. I proposed a custom security solution to the team, and was met with questions and doubts. But that
rejection actually led me to something better. I really dug into the security solutions in the industry, and I found the
standard called <strong>HTTP Message Signatures</strong>, <a class=link href=https://datatracker.ietf.org/doc/rfc9421/ target=_blank rel=noopener>RFC 9421</a>. It turns out the
solution already existed. I just didn&rsquo;t know where to look.</p><figure><img src=/posts/http-message-signatures/rfc-9421.png alt="RFC 9421 history showing the evolution from drafts to the final RFC 9421 standard."></figure><h2 id=what-are-http-message-signatures><a href=#what-are-http-message-signatures class=header-anchor></a>What are HTTP message signatures?</h2><p>You sign receipts, contracts, and maybe your kid&rsquo;s permission slip. A signature means: this came from me. But on the
web, most messages are unsigned. Anyone could forge them. HTTP Message Signatures change that. They make digital
communication accountable again. The server knows that the message actually came from the right client and wasn&rsquo;t
modified by a proxy.</p><p>So why do we need this? When two systems talk over HTTP, the server sees a request, but it doesn&rsquo;t really know who sent
it, or if the message changed on the way. The server doesn&rsquo;t know if a bad actor is impersonating the client or
intercepted the message and modified the contents.</p><p>To trust the message, the server needs some way to verify that the message came from the client. With HTTP message
signatures, the server must have the public key of the client. The client signs the message with its private key, and
the server verifies the signature with the public key.</p><pre class=mermaid>
  %%{init: {&#39;theme&#39;:&#39;base&#39;, &#39;themeVariables&#39;: { &#39;primaryColor&#39;:&#39;#E3F2FD&#39;,&#39;primaryTextColor&#39;:&#39;#1565C0&#39;,&#39;primaryBorderColor&#39;:&#39;#1976D2&#39;,&#39;lineColor&#39;:&#39;#424242&#39;,&#39;secondaryColor&#39;:&#39;#FFF3E0&#39;,&#39;tertiaryColor&#39;:&#39;#E8F5E9&#39;}}}%%
sequenceDiagram
    autonumber
    box rgb(227, 242, 253) Client side
    participant C as üñ•Ô∏è Client
    participant SM as üîê Signature creation&lt;br/&gt;(private key)
    end
    box rgb(232, 245, 233) Server side
    participant S as ‚òÅÔ∏è Server
    participant VM as ‚úÖ Signature verification&lt;br/&gt;(public key)
    end

    Note over C,SM: 1. Prepare and sign message
    C-&gt;&gt;+SM: Message contents
    SM-&gt;&gt;SM: Generate signature&lt;br/&gt;using private key
    SM--&gt;&gt;-C: Signature

    Note over C,S: 2. Send authenticated request
    C-&gt;&gt;+S: HTTP request&lt;br/&gt;(contents + signature)

    Note over S,VM: 3. Verify authenticity
    S-&gt;&gt;+VM: Verify signature
    VM-&gt;&gt;VM: Validate signature&lt;br/&gt;using public key
    VM--&gt;&gt;-S: ‚úì valid / ‚úó invalid
</pre><p>With HTTP message signatures, the client signs specific parts of the HTTP request, such as method, target URI, headers,
and a hash of the request body. The signature tells the server:</p><ul><li>Who sent the message</li><li>That the message hasn&rsquo;t been tampered with</li><li>Which parts of the message are covered by the signature</li></ul><p>HTTP message signatures are added in the HTTP request headers. This means that the signature can be added by a proxy.
The client could be a legacy system, and we can simply add a proxy to make it more secure.</p><pre class=mermaid>
  %%{init: {&#39;theme&#39;:&#39;base&#39;, &#39;themeVariables&#39;: { &#39;primaryColor&#39;:&#39;#E3F2FD&#39;,&#39;primaryTextColor&#39;:&#39;#1565C0&#39;,&#39;primaryBorderColor&#39;:&#39;#1976D2&#39;,&#39;lineColor&#39;:&#39;#424242&#39;,&#39;secondaryColor&#39;:&#39;#FFF3E0&#39;,&#39;tertiaryColor&#39;:&#39;#E8F5E9&#39;}}}%%
sequenceDiagram
    participant LC as üñ•Ô∏è Legacy client
    participant P as üîÑ Modern proxy&lt;br/&gt;(signature creation)
    participant S as ‚òÅÔ∏è Server

    LC-&gt;&gt;P: HTTP request&lt;br/&gt;(no signature)
    P-&gt;&gt;P: Sign message with&lt;br/&gt;private key
    P-&gt;&gt;S: HTTP request&lt;br/&gt;(+ signature headers)
    S-&gt;&gt;S: Verify signature
    S--&gt;&gt;P: Response
    P--&gt;&gt;LC: Response
</pre><h2 id=how-http-message-signatures-compare-to-alternatives><a href=#how-http-message-signatures-compare-to-alternatives class=header-anchor></a>How HTTP message signatures compare to alternatives</h2><h3 id=api-keys-simple-but-limited><a href=#api-keys-simple-but-limited class=header-anchor></a>API keys: simple but limited</h3><p>API keys are like shared passwords. You include them in a header or query parameter, and the server knows someone with
that key made the request. They&rsquo;re simple and widely used.</p><p>But here&rsquo;s the problem: API keys only authenticate the client, they don&rsquo;t protect message integrity. If a proxy, cache,
or malicious actor modifies the message in transit, there&rsquo;s no proof of what changed. The server can&rsquo;t tell whether the
message body or headers were tampered with after the client sent them.</p><p>HTTP message signatures fix that. Instead of just authenticating the connection, they sign the message itself (method,
headers, a hash of the body, and more). The server can verify not only who sent the message, but also that nothing was
modified along the way.</p><h3 id=jwt-a-fancier-api-key><a href=#jwt-a-fancier-api-key class=header-anchor></a>JWT: a fancier API key</h3><p>JWT (JSON Web Token) is everywhere. JWTs became the de facto identity token format in OAuth 2.0, where they&rsquo;re sent in
the Authorization header. That pattern is now universal for most API tokens, even if you don&rsquo;t use OAuth explicitly. The
industry standard across Google, AWS, Okta, GitHub, and others is <code>Authorization: Bearer &lt;JWT></code>.</p><pre tabindex=0><code>Authorization: Bearer &lt;JWT-header&gt;.&lt;JWT-payload&gt;.&lt;JWT-signature&gt;

Header:
{
  &#34;alg&#34;: &#34;HS256&#34;,
  &#34;typ&#34;: &#34;JWT&#34;
}

Payload:
{
  &#34;sub&#34;: &#34;1234567890&#34;,
  &#34;name&#34;: &#34;John Doe&#34;,
  &#34;iat&#34;: 1730630400
}
</code></pre><p>The problem is that a JWT only signs its own contents (the claims inside the token itself). It doesn&rsquo;t sign the HTTP
request. If someone intercepts a valid JWT, they can use it in a completely different request. They could change the
method from GET to DELETE, modify the request body, or alter other headers. The server will validate the JWT and accept
it, because the token itself is legitimate.</p><p>HTTP message signatures prevent request modification by binding the signature to the specific request components
(method, path, headers, body). An attacker can&rsquo;t change a signed request without breaking the signature.</p><h3 id=mtls-strong-but-operationally-complex><a href=#mtls-strong-but-operationally-complex class=header-anchor></a>mTLS: strong but operationally complex</h3><p>mTLS (mutual TLS) is the gold standard for authentication when both client and server present certificates during the
TLS handshake. It&rsquo;s built into the protocol, fast, and well-supported across operating systems and browsers.</p><p>But mTLS is all-or-nothing. You can&rsquo;t easily enforce it on just one endpoint or route. It&rsquo;s typically applied to the
entire connection. It also requires TLS termination at a layer that can verify client certificates. If your load
balancer terminates TLS, it needs to handle certificate verification and pass the identity downstream. This makes mTLS
difficult to deploy in many real-world architectures.</p><p>HTTP message signatures work at the application layer. They don&rsquo;t care where TLS terminates. You can verify signatures
at the destination server, apply them per-route, and enforce them selectively based on your requirements. We cover the
tradeoffs in detail in <a class=link href=../mtls-vs-http-signature/>mTLS vs HTTP signature faceoff</a>.</p><h2 id=who-is-using-http-message-signatures><a href=#who-is-using-http-message-signatures class=header-anchor></a>Who is using HTTP message signatures?</h2><p>HTTP message signatures are gaining real traction across the industry. Here&rsquo;s who&rsquo;s already using them and why.</p><p><strong>OpenAI</strong>
<a class=link href=https://help.openai.com/en/articles/11845367-chatgpt-agent-allowlisting target=_blank rel=noopener>signs requests from their ChatGPT agent</a> to
solve the bot verification problem. You&rsquo;ve probably heard complaints about small sites being overwhelmed by AI bots.
Without signatures, it was nearly impossible to tell which AI company was responsible for the traffic. Now, CDNs and
firewalls can verify that traffic actually came from OpenAI, not some impersonator trying to abuse their reputation.</p><p><strong>Cloudflare</strong>
<a class=link href=https://blog.cloudflare.com/verified-bots-with-cryptography target=_blank rel=noopener>built HTTP message signatures into their Verified Bots program</a>.
Site owners can now whitelist legitimate bots while blocking the fakes. No more relying on IP ranges that constantly
shift or user-agent headers that anyone can spoof. The cryptographic signature proves the bot&rsquo;s identity.</p><p><strong>Mastodon</strong> uses HTTP message signatures to protect the federated network. Say you create a Mastodon account on
mastodon.social. When you post something, your server sends that post to other Mastodon servers across the federation.
Without signatures, a malicious server could impersonate mastodon.social and send fake posts claiming they came from
you. Your followers on other servers would see these forged posts in their feeds, and there&rsquo;d be no way to tell they
weren&rsquo;t legitimate.</p><p>Mastodon uses HTTP message signatures to secure federated ActivityPub communication. When one Mastodon server receives
activities from another, it requires cryptographic proof that the sending actor actually authored the request. Without
signatures, any server could impersonate another and inject fake posts or manipulate feeds.
<a class=link href=https://docs.joinmastodon.org/spec/security target=_blank rel=noopener>Mastodon&rsquo;s secure mode</a> even requires signatures on read-only GET requests
between federated instances.</p><p><strong>Amazon</strong> requires HTTP message signatures for third-party payment providers accessing their Selling Partner API in the
EU. This isn&rsquo;t optional. It&rsquo;s
<a class=link href=https://developer-docs.amazon.com/sp-api/docs/tpp-registration-signature-guidance target=_blank rel=noopener>PSD2 compliance</a>, which is the
Payment Services Directive 2 (PSD2) framework of the European Union. Payment providers must sign requests using their
NCA (National Competent Authority) certificate to prove they&rsquo;re authorized to access sensitive financial data. The
certificate&rsquo;s organization identifier must match the registered developer identity, or the request gets rejected.</p><p>Other standards are already building on top of HTTP message signatures.
<a class=link href=https://datatracker.ietf.org/doc/rfc9635/ target=_blank rel=noopener>RFC 9635 (GNAP)</a>, finalized in October 2024, is the Grant Negotiation and
Authorization Protocol. Think of it as a more flexible alternative to OAuth 2.0. Say you want to give a third-party app
permission to access your cloud storage. The app needs to request that access from the storage provider, and the
provider needs to verify that the requests are actually coming from the legitimate app, not an imposter. GNAP uses HTTP
message signatures as one way for the app to prove its identity during the authorization negotiation process (alongside
mTLS and other methods).</p><p>There&rsquo;s also a draft for an
<a class=link href=https://datatracker.ietf.org/doc/draft-meunier-http-message-signatures-directory target=_blank rel=noopener>HTTP Message Signatures Directory</a>.
The problem? RFC 9421 assumes verifiers already have the signer&rsquo;s public key through some out-of-band mechanism. That
creates deployment friction. The directory draft solves this by defining a standard
<code>.well-known/http-message-signatures-directory</code> endpoint where clients can publish their signing keys in JWKS format.
Now verification can happen dynamically, even for previously unknown signers.</p><h2 id=who-is-not-using-http-message-signatures><a href=#who-is-not-using-http-message-signatures class=header-anchor></a>Who is NOT using HTTP message signatures?</h2><p>Most companies that aren&rsquo;t using HTTP message signatures already have something that works. They built their own
solution years ago, and migrating to a standard may not be high on the priority list when the current system isn&rsquo;t
broken.</p><p>Apple&rsquo;s MDM (Mobile Device Management) protocol uses a detached
<a class=link href=https://datatracker.ietf.org/doc/rfc5652/ target=_blank rel=noopener>CMS signature</a> with a custom header. GitHub signs webhook payloads with
HMAC-SHA256 and a shared secret. These custom approaches accomplish the same goal (verifying message integrity and
origin) but they&rsquo;re not interoperable. Every vendor implements their own scheme, and clients have to learn each one.</p><p>The good news? RFC 9421 supports both asymmetric keys (like RSA and ECDSA) and symmetric keys (like HMAC-SHA256).
Organizations using HMAC-based signing today could migrate to the standard without completely redesigning their
cryptography. The challenge isn&rsquo;t technical capability. It&rsquo;s finding the time and justification to migrate working
systems to a common standard.</p><h3 id=why-standardization-matters><a href=#why-standardization-matters class=header-anchor></a>Why standardization matters</h3><p>Here&rsquo;s the real value of a standard like RFC 9421: you don&rsquo;t have to decipher someone&rsquo;s custom security scheme every
time you integrate with a new API.</p><p>Right now, if you want to verify GitHub webhooks, you read their docs, implement HMAC-SHA256 with their specific header
format, and write custom verification logic. Different header names, different signature formats, different
canonicalization rules. Every vendor reinvents the wheel.</p><p>With a standard, libraries can implement signature verification once. Your application code doesn&rsquo;t need vendor-specific
logic for each API. The server publishes its public key, the client signs requests according to RFC 9421, and
verification just works. Same headers, same signature format, same verification process.</p><p>This also means security tooling gets better. Monitoring tools can inspect and validate signatures without custom
parsers for each vendor. Security audits become easier when everyone&rsquo;s using the same approach.</p><p>Standards reduce friction. They make security more accessible. And they prevent the situation where every team builds
their own half-baked signing scheme that&rsquo;s subtly broken in different ways.</p><h2 id=technical-details-of-http-message-signatures><a href=#technical-details-of-http-message-signatures class=header-anchor></a>Technical details of HTTP message signatures</h2><p>RFC 9421 is a &ldquo;Proposed Standard&rdquo; from the IETF (Internet Engineering Task Force). That means it&rsquo;s fully approved,
stable, and ready for implementation. This is the same standards level where almost all Internet protocols live (HTTP,
TLS, DNS, etc.).</p><h3 id=how-it-works><a href=#how-it-works class=header-anchor></a>How it works</h3><p>HTTP message signatures use two headers to sign requests:</p><p><strong>Signature-Input</strong>: Specifies what you&rsquo;re signing (which headers, which parts of the request) and metadata like
creation time and key identifier.</p><p><strong>Signature</strong>: Contains the actual cryptographic signature.</p><p>Here&rsquo;s a real example from the RFC:</p><pre tabindex=0><code>POST /foo?param=value&amp;pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Signature-Input: sig1=(&#34;@method&#34; &#34;@authority&#34; &#34;@path&#34;
  &#34;content-type&#34; &#34;content-length&#34;);created=1618884475;
  keyid=&#34;test-key&#34;
Signature: sig1=:Base64SignatureGoesHere=:

{&#34;hello&#34;: &#34;world&#34;}
</code></pre><p>The <code>Signature-Input</code> header says: &ldquo;I&rsquo;m signing the HTTP method, the authority (host and port), the path, content-type,
and content-length.&rdquo; The <code>Signature</code> header contains the actual signature of those components.</p><h3 id=what-can-you-sign><a href=#what-can-you-sign class=header-anchor></a>What can you sign?</h3><p>You can sign two types of components:</p><p><strong>HTTP headers</strong>: Any header from the request (like <code>content-type</code>, <code>authorization</code>, etc.). Header names are lowercased.</p><p><strong>Derived components</strong> (these start with <code>@</code>):</p><ul><li><code>@method</code>: The HTTP method (GET, POST, etc.)</li><li><code>@target-uri</code>: The full request URI</li><li><code>@authority</code>: The host and port (e.g., <code>example.com:8080</code>)</li><li><code>@scheme</code>: The URI scheme (<code>http</code> or <code>https</code>)</li><li><code>@path</code>: The request path</li><li><code>@query</code>: The query string</li><li><code>@status</code>: The HTTP response code (for signing responses)</li></ul><p>You pick which components to sign based on what matters for your security. Signing <code>@method</code> and <code>@path</code> prevents
someone from changing a GET to a DELETE.</p><p>To protect the request body, you don&rsquo;t sign it directly. Instead, you calculate a cryptographic hash of the body and
include it in a <code>Content-Digest</code> header (defined in <a class=link href=https://datatracker.ietf.org/doc/rfc9530/ target=_blank rel=noopener>RFC 9530</a>). Then you
sign that header. For example:</p><pre tabindex=0><code>Content-Digest: sha-256=:X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=:
</code></pre><p>This <code>content-digest</code> header becomes one of the signed components. If anyone tampers with the body, the hash won&rsquo;t match
and the signature verification will fail.</p><h3 id=signature-metadata><a href=#signature-metadata class=header-anchor></a>Signature metadata</h3><p>The <code>Signature-Input</code> header also includes metadata parameters (after the semicolon):</p><ul><li><code>created</code>: UNIX timestamp when the signature was generated (recommended for replay protection)</li><li><code>expires</code>: UNIX timestamp after which the signature should be rejected</li><li><code>nonce</code>: A random unique value to prevent replay attacks</li><li><code>keyid</code>: Identifier for the key used (helps the server find the right public key)</li><li><code>alg</code>: The algorithm used to create the signature (e.g., <code>rsa-pss-sha512</code>)</li><li><code>tag</code>: Application-specific identifier</li></ul><p>In the example above, <code>created=1618884475</code> and <code>keyid="test-key"</code> tell the server when the signature was made and which
key to use for verification. These parameters are part of the RFC 9421 standard and are included in what gets signed, so
they can&rsquo;t be tampered with.</p><h3 id=how-the-signature-is-created><a href=#how-the-signature-is-created class=header-anchor></a>How the signature is created</h3><p>The client builds a &ldquo;signature base&rdquo; from the selected components:</p><pre tabindex=0><code>&#34;@method&#34;: POST
&#34;@authority&#34;: example.com
&#34;@path&#34;: /foo
&#34;content-type&#34;: application/json
&#34;content-length&#34;: 18
&#34;@signature-params&#34;: (&#34;@method&#34; &#34;@authority&#34; &#34;@path&#34;
  &#34;content-type&#34; &#34;content-length&#34;);created=1618884475;
  keyid=&#34;test-key&#34;
</code></pre><p>Each component gets its own line with the component name in quotes, a colon, and the value. The last line contains the
signature parameters. This text is what gets signed with the private key.</p><h3 id=supported-algorithms><a href=#supported-algorithms class=header-anchor></a>Supported algorithms</h3><p>RFC 9421 initially registered these algorithms:</p><p><strong>Asymmetric</strong> (public/private key pairs):</p><ul><li><code>rsa-pss-sha512</code>: RSA with PSS padding and SHA-512</li><li><code>rsa-pkcs1v15-sha256</code>: Traditional RSA with SHA-256</li><li><code>ecdsa-p256-sha256</code>: Elliptic curve (P-256)</li><li><code>ecdsa-p384-sha384</code>: Elliptic curve (P-384)</li><li><code>ed25519</code>: EdDSA using edwards25519 curve</li></ul><p><strong>Symmetric</strong> (shared secrets):</p><ul><li><code>hmac-sha256</code>: HMAC with SHA-256</li></ul><p>But the list is extensible. The RFC allows implementations to support additional algorithms, including JSON Web
Signature (JWS) algorithm identifiers. IANA maintains the
<a class=link href=https://www.iana.org/assignments/http-message-signature/http-message-signature.xhtml target=_blank rel=noopener>official registry</a> where new
algorithms can be registered. This means the standard can evolve to support new cryptographic methods as they become
available.</p><h3 id=key-distribution-and-rotation><a href=#key-distribution-and-rotation class=header-anchor></a>Key distribution and rotation</h3><p>The big question: how does the server get the client&rsquo;s public key?</p><p>RFC 9421 doesn&rsquo;t mandate a specific method. You have options:</p><ol><li><p><strong>Pre-shared configuration</strong>: Register the client&rsquo;s public key with the server out-of-band (API portal, configuration
file, database).</p></li><li><p><strong>Well-known directory</strong>: Use the
<a class=link href=https://datatracker.ietf.org/doc/draft-meunier-http-message-signatures-directory target=_blank rel=noopener>HTTP Message Signatures Directory</a>
draft to publish keys at <code>.well-known/http-message-signatures-directory</code>.</p></li><li><p><strong>Certificate-based</strong>: Use X.509 certificates and reference them via <code>keyid</code>.</p></li></ol><p>The <code>keyid</code> parameter in the signature identifies which key to use. This supports key rotation. You can even include
multiple signatures in a single request (one with the old key, one with the new key) during rotation periods.</p><p>IANA maintains the
<a class=link href=https://www.iana.org/assignments/http-message-signature/http-message-signature.xhtml target=_blank rel=noopener>registry of signature algorithms and parameters</a>
so implementations stay compatible.</p><h2 id=example-implementation><a href=#example-implementation class=header-anchor></a>Example implementation</h2><p>We implemented a simple demo app that demonstrates how to sign and verify HTTP requests with RFC 9421 in Node.js. The
app is available on GitHub: <a class=link href=https://github.com/getvictor/http-message-signatures target=_blank rel=noopener>https://github.com/getvictor/http-message-signatures</a></p><p>There are many JavaScript libraries that implement HTTP message signatures. Many companies also don&rsquo;t use libraries and
do their own implementation of the standard.</p><figure><img src=/posts/http-message-signatures/node-http-message-signature-libraries.png alt="npm search results showing five Node.js HTTP message signature libraries"></figure><p>For our demo we chose <a class=link href=https://github.com/dhensby/node-http-message-signatures target=_blank rel=noopener>https://github.com/dhensby/node-http-message-signatures</a> for the following reasons:</p><ol><li>Cleaner, more intuitive API</li></ol><ul><li>Simpler function signatures and better TypeScript support</li><li>More conventional Node.js patterns</li><li>Easier to integrate with Web Crypto API</li></ul><ol start=2><li>Better documentation and examples</li></ol><ul><li>Clear, comprehensive examples in the README</li><li>Well-documented API surface</li><li>Good inline code comments</li></ul><ol start=3><li>Proven stability</li></ol><ul><li>Version 1.0.4</li><li>Widely used</li></ul><ol start=4><li>Better compatibility</li></ol><ul><li>No unusual dependencies (only <code>structured-headers</code>)</li><li>Easy integration with Express middleware</li></ul><p>Before sending a signed request, the client needs to give the server its public key. The server can then use that key to
verify the signature. We chose to use a dedicated <code>/admin</code> endpoint for this purpose.</p><p>Once server has the client&rsquo;s public key. Here&rsquo;s a snippet of the client code that signs a request:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>signAndSendRequest</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>keys</span>: <span style=color:#66d9ef>ClientKeys</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>method</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>path</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>body?</span>: <span style=color:#66d9ef>any</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tamper</span>: <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>Response</span>&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>BASE_URL</span><span style=color:#e6db74>}${</span><span style=color:#a6e22e>path</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bodyString</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>body</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>body</span>) <span style=color:#f92672>:</span> <span style=color:#66d9ef>undefined</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Compute Content-Digest for the body
</span></span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>contentDigest</span>: <span style=color:#66d9ef>string</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>undefined</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>bodyString</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>contentDigest</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>computeDigest</span>(<span style=color:#a6e22e>bodyString</span>, <span style=color:#e6db74>&#39;sha-256&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Prepare the message object for signing
</span></span></span><span style=display:flex><span>  <span style=color:#75715e>// SignRequest comes from &#39;http-message-signatures&#39; library
</span></span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>message</span>: <span style=color:#66d9ef>SignRequest</span> <span style=color:#f92672>&amp;</span> { <span style=color:#a6e22e>body?</span>: <span style=color:#66d9ef>string</span> } <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>method</span>: <span style=color:#66d9ef>method.toUpperCase</span>(),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>url</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;content-type&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/json&#39;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>contentDigest</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>message</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;content-digest&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>contentDigest</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>bodyString</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>message</span>.<span style=color:#a6e22e>body</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bodyString</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Create signer function
</span></span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>signer</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>Buffer</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>Buffer</span>&gt; <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>signature</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>webcrypto</span>.<span style=color:#a6e22e>subtle</span>.<span style=color:#a6e22e>sign</span>(<span style=color:#e6db74>&#39;Ed25519&#39;</span>, <span style=color:#a6e22e>keys</span>.<span style=color:#a6e22e>privateKey</span>, <span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#66d9ef>from</span>(<span style=color:#a6e22e>signature</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Generate nonce for replay protection
</span></span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>nonce</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>generateNonce</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Sign the message, using `signMessage` of `http-message-signatures` library
</span></span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>signedMessage</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>httpbis</span>.<span style=color:#a6e22e>signMessage</span>(
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>keys.kid</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>alg</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;ed25519&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>sign</span>: <span style=color:#66d9ef>signer</span>,
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>fields</span>: <span style=color:#66d9ef>contentDigest</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>?</span> [<span style=color:#e6db74>&#39;@method&#39;</span>, <span style=color:#e6db74>&#39;@target-uri&#39;</span>, <span style=color:#e6db74>&#39;content-type&#39;</span>, <span style=color:#e6db74>&#39;content-digest&#39;</span>]
</span></span><span style=display:flex><span>        <span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;@method&#39;</span>, <span style=color:#e6db74>&#39;@target-uri&#39;</span>],
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>params</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;keyid&#39;</span>, <span style=color:#e6db74>&#39;alg&#39;</span>, <span style=color:#e6db74>&#39;created&#39;</span>, <span style=color:#e6db74>&#39;expires&#39;</span>, <span style=color:#e6db74>&#39;nonce&#39;</span>],
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>paramValues</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>created</span>: <span style=color:#66d9ef>new</span> Date(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>expires</span>: <span style=color:#66d9ef>new</span> Date(Date.<span style=color:#a6e22e>now</span>() <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1000</span>), <span style=color:#75715e>// 5 minutes
</span></span></span><span style=display:flex><span>        <span style=color:#a6e22e>nonce</span>: <span style=color:#66d9ef>nonce</span>,
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>message</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>signature</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>signedMessage</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;signature&#39;</span>] <span style=color:#f92672>||</span> <span style=color:#a6e22e>signedMessage</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;Signature&#39;</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>signatureInput</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>signedMessage</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;signature-input&#39;</span>] <span style=color:#f92672>||</span> <span style=color:#a6e22e>signedMessage</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;Signature-Input&#39;</span>];
</span></span></code></pre></div><p>The signing process: compute the Content-Digest hash for the body, build a message object with method and headers,
create an Ed25519 signer function, configure which components to sign (<code>@method</code>, <code>@target-uri</code>, <code>content-digest</code>) with
replay protection parameters (<code>created</code>, <code>expires</code>, <code>nonce</code>), and extract the signature headers.</p><p>Here&rsquo;s a snippet of the server code that verifies the signature:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>verifySignatureMiddleware</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>req</span>: <span style=color:#66d9ef>Request</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>res</span>: <span style=color:#66d9ef>Response</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span>: <span style=color:#66d9ef>NextFunction</span>
</span></span><span style=display:flex><span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>endpoint</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>path</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>method</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>method</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Check for required headers
</span></span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>signatureInputHeader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;signature-input&#39;</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>signatureHeader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;signature&#39;</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>contentDigestHeader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;content-digest&#39;</span>];
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Verify Content-Digest if present (do this early for efficiency)
</span></span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Perform cryptographic signature verification
</span></span></span><span style=display:flex><span>  <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Construct the message object for verification
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>message</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>method</span>: <span style=color:#66d9ef>req.method</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>protocol</span><span style=color:#e6db74>}</span><span style=color:#e6db74>://</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>req</span>.<span style=color:#66d9ef>get</span>(<span style=color:#e6db74>&#39;host&#39;</span>)<span style=color:#e6db74>}${</span><span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>originalUrl</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {} <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>string</span>&gt;,
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Copy headers to lowercase keys (RFC 9421 requires lowercase)
</span></span></span><span style=display:flex><span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Map algorithm names to library format
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mapAlgorithmToLibraryFormat</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>alg</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mapping</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>string</span>&gt; <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;EdDSA&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;ed25519&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>mapping</span>[<span style=color:#a6e22e>alg</span>] <span style=color:#f92672>||</span> <span style=color:#a6e22e>alg</span>.<span style=color:#a6e22e>toLowerCase</span>();
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Clock skew tolerance for timestamp validation
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>CLOCK_SKEW_SECONDS</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span>; <span style=color:#75715e>// 5 minutes
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Verify the signature using the library
</span></span></span><span style=display:flex><span>    <span style=color:#75715e>// The keyLookup callback receives parsed parameters from the library
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>verificationResult</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>httpbis</span>.<span style=color:#a6e22e>verifyMessage</span>(
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>keyLookup</span>: <span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>params</span>: <span style=color:#66d9ef>SignatureParameters</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>kid</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>keyid</span>;
</span></span><span style=display:flex><span>          <span style=color:#75715e>// Look up the key
</span></span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>keyRecord</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>getKey</span>(<span style=color:#a6e22e>kid</span>);
</span></span><span style=display:flex><span>          <span style=color:#75715e>// Validate the key and make sure it is not revoked
</span></span></span><span style=display:flex><span>          <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>// Check for nonce parameter (replay protection)
</span></span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>nonce</span>) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Check if nonce has been used before (replay detection)
</span></span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>isNonceUsed</span>(<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>nonce</span>)) {
</span></span><span style=display:flex><span>              <span style=color:#75715e>// fail
</span></span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>// Import the public key
</span></span></span><span style=display:flex><span>          <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>publicKey</span>: <span style=color:#66d9ef>webcrypto.CryptoKey</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>keyRecord</span>.<span style=color:#a6e22e>algorithm</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;EdDSA&#39;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>publicKey</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>webcrypto</span>.<span style=color:#a6e22e>subtle</span>.<span style=color:#a6e22e>importKey</span>(
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#39;jwk&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>keyRecord</span>.<span style=color:#a6e22e>jwk</span> <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>any</span>,
</span></span><span style=display:flex><span>              { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Ed25519&#39;</span>, <span style=color:#a6e22e>namedCurve</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Ed25519&#39;</span> } <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>any</span>,
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>              [<span style=color:#e6db74>&#39;verify&#39;</span>]
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>          } <span style=color:#75715e>// else ...
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>// Create a verifier function
</span></span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>createVerifierForKey</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>Buffer</span>, <span style=color:#a6e22e>signature</span>: <span style=color:#66d9ef>Buffer</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>boolean</span> <span style=color:#960050;background-color:#1e0010>|</span> <span style=color:#a6e22e>null</span>&gt; <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>algorithm</span>: <span style=color:#66d9ef>string</span> <span style=color:#f92672>|</span> { <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>; <span style=color:#a6e22e>hash</span>: <span style=color:#66d9ef>string</span> };
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>keyRecord</span>.<span style=color:#a6e22e>algorithm</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;EdDSA&#39;</span>) {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>algorithm</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Ed25519&#39;</span>;
</span></span><span style=display:flex><span>            } <span style=color:#75715e>// else ...
</span></span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>webcrypto</span>.<span style=color:#a6e22e>subtle</span>.<span style=color:#a6e22e>verify</span>(<span style=color:#a6e22e>algorithm</span>, <span style=color:#a6e22e>publicKey</span>, <span style=color:#a6e22e>signature</span>, <span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>          };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>// Return the verifying key
</span></span></span><span style=display:flex><span>          <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>kid</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>algs</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>mapAlgorithmToLibraryFormat</span>(<span style=color:#a6e22e>keyRecord</span>.<span style=color:#a6e22e>algorithm</span>)],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>verify</span>: <span style=color:#66d9ef>createVerifierForKey</span>,
</span></span><span style=display:flex><span>          };
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>tolerance</span>: <span style=color:#66d9ef>CLOCK_SKEW_SECONDS</span>,
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>message</span>
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// verifyMessage returns true on success, false/null on failure
</span></span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>verificationResult</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>401</span>).<span style=color:#a6e22e>json</span>(<span style=color:#a6e22e>SignatureErrors</span>.<span style=color:#a6e22e>invalidSignature</span>(<span style=color:#e6db74>&#39;Signature verification failed&#39;</span>));
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Store the nonce to prevent replay (if present)
</span></span></span><span style=display:flex><span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span>    <span style=color:#a6e22e>next</span>();
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>: <span style=color:#66d9ef>any</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>401</span>).<span style=color:#a6e22e>json</span>(<span style=color:#a6e22e>SignatureErrors</span>.<span style=color:#a6e22e>invalidSignature</span>(<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;Verification error&#39;</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><p>The verification process reconstructs the message object from the incoming request and calls the library&rsquo;s
<code>verifyMessage</code> function. The <code>keyLookup</code> callback retrieves the client&rsquo;s public key using the <code>keyid</code> parameter, checks
if the nonce has been used (replay protection), imports the key via Web Crypto API, and returns a verifier function. The
library handles timestamp validation using the configured clock skew tolerance (5 minutes). If verification succeeds, we
store the nonce and proceed. If it fails, we return 401 Unauthorized.</p><h2 id=replay-attacks><a href=#replay-attacks class=header-anchor></a>Replay attacks</h2><p>A replay attack happens when someone captures a legitimate request and sends it again to trigger the same action a
second time. Think of it like photocopying a signed check. The signature is real, the request is valid, but you&rsquo;re using
it in a way that wasn&rsquo;t intended.</p><p>Here&rsquo;s the problem: HTTP message signatures protect against tampering, but they don&rsquo;t inherently prevent replay. An
attacker who intercepts a signed request can replay it from any machine. They don&rsquo;t need your private key. They just
need the complete request with its signature headers intact.</p><p>Consider this scenario: you send a signed API request to transfer $100. The signature proves the request came from you
and hasn&rsquo;t been modified. But if an attacker captures that request, they can send it again. And again. The signature is
still valid because the request hasn&rsquo;t changed.</p><pre class=mermaid>
  %%{init: {&#39;theme&#39;:&#39;base&#39;, &#39;themeVariables&#39;: { &#39;primaryColor&#39;:&#39;#E3F2FD&#39;,&#39;primaryTextColor&#39;:&#39;#1565C0&#39;,&#39;primaryBorderColor&#39;:&#39;#1976D2&#39;,&#39;lineColor&#39;:&#39;#424242&#39;,&#39;secondaryColor&#39;:&#39;#FFF3E0&#39;,&#39;tertiaryColor&#39;:&#39;#E8F5E9&#39;}}}%%
sequenceDiagram
    autonumber
    participant Client as üñ•Ô∏è Client
    participant Attacker as üé≠ Attacker
    participant Server as ‚òÅÔ∏è Server

    Note over Client,Server: Legitimate request
    Client-&gt;&gt;Server: Signed request&lt;br/&gt;(Transfer $100)
    Server-&gt;&gt;Server: Verify signature ‚úì
    Server--&gt;&gt;Client: 200 OK (transferred)

    Note over Client,Server: Attacker intercepts and replays
    Attacker-&gt;&gt;Attacker: Capture request&lt;br/&gt;(with valid signature)
    Attacker-&gt;&gt;Server: Replay same request

    alt Without replay protection
        Server-&gt;&gt;Server: Verify signature ‚úì&lt;br/&gt;(signature is still valid!)
        Server--&gt;&gt;Attacker: 200 OK (transferred again!)
    else With created timestamp
        Server-&gt;&gt;Server: Verify signature ‚úì&lt;br/&gt;Check timestamp ‚úó (too old)
        Server--&gt;&gt;Attacker: 401 Unauthorized
    end
</pre><h3 id=defending-against-replay-attacks><a href=#defending-against-replay-attacks class=header-anchor></a>Defending against replay attacks</h3><p>You need to make each signature single-use or time-limited. The standard way to do this is with the <code>created</code> timestamp
and <code>nonce</code> parameters we discussed earlier:</p><p><strong>Use <code>created</code> timestamp</strong>: Include the current time when generating the signature. The server rejects any request
where <code>created</code> is too far from the current server time (typically 5-10 minutes). Since the timestamp is included in the
signature, an attacker can&rsquo;t modify it without invalidating the signature.</p><p><strong>Use <code>nonce</code> for critical operations</strong>: For sensitive actions like money transfers or password resets, include a random
nonce value. The server tracks recently used nonces (cached in Redis or similar) and rejects any request that reuses a
nonce within the time window.</p><p>The <code>expires</code> parameter offers an alternative approach. Instead of relying on <code>created</code> + server-side time window
checking, you can explicitly set when a signature becomes invalid. The server simply rejects any request where the
current time is past the <code>expires</code> timestamp.</p><h2 id=performance-considerations><a href=#performance-considerations class=header-anchor></a>Performance considerations</h2><p>Understanding the performance characteristics of HTTP message signatures matters when you&rsquo;re operating at scale.</p><h3 id=where-the-cpu-load-happens><a href=#where-the-cpu-load-happens class=header-anchor></a>Where the CPU load happens</h3><p>HTTP message signatures shift cryptographic work to the application layer. Every single request requires signature
verification at your application server, not at the network edge or load balancer.</p><p>This is different from connection-level security like TLS or mTLS, where cryptographic operations happen during the
initial handshake and subsequent requests on that connection are cheap. With HTTP message signatures, you&rsquo;re adding
cryptographic operations to every request. Your application servers handle this work, not your load balancers or edge
infrastructure.</p><h3 id=per-request-overhead><a href=#per-request-overhead class=header-anchor></a>Per-request overhead</h3><p>The computational cost depends on which algorithm you choose:</p><ul><li><strong>EdDSA (ed25519)</strong>: Fastest for verification. Modern CPUs handle this efficiently.</li><li><strong>ECDSA P-256</strong>: Good balance of security and performance. Recommended for most use cases.</li><li><strong>ECDSA P-384</strong>: Stronger security, but noticeably slower. In our production environment with high request volumes,
switching from P-256 to P-384 required 50% more application servers to handle the same load.</li><li><strong>RSA</strong>: Slower than elliptic curve algorithms for the same security level. Verification is faster than signing, but
still more expensive than ECDSA.</li><li><strong>HMAC-SHA256</strong>: Fastest option if you can use symmetric keys (shared secrets). No public key cryptography involved.</li></ul><h3 id=what-dominates-the-cost><a href=#what-dominates-the-cost class=header-anchor></a>What dominates the cost?</h3><p>The cryptographic signature verification is what takes the most CPU cycles. Elliptic curve operations, RSA verification,
or even HMAC computation dwarf everything else.</p><p>Canonicalization (building the signature base from headers and components) is comparatively cheap. It&rsquo;s just string
manipulation. Unless you&rsquo;re signing hundreds of headers or dealing with megabyte-sized header values, the
canonicalization overhead is negligible compared to the actual crypto operation.</p><p>This means your algorithm choice matters far more than whether you sign 3 components or 10 components. The difference
between ECDSA P-256 and P-384 is significant. The difference between signing <code>@method</code> + <code>@path</code> versus signing those
plus 5 more headers is barely measurable.</p><h3 id=if-performance-becomes-a-concern><a href=#if-performance-becomes-a-concern class=header-anchor></a>If performance becomes a concern</h3><p>The main lever you have is <strong>algorithm choice</strong>. Use ECDSA P-256 or ed25519 unless you have specific requirements for
stronger curves. If you can use symmetric keys (HMAC-SHA256), that&rsquo;s even faster, but most use cases need asymmetric
cryptography.</p><p>Beyond that, you&rsquo;re dealing with fundamental tradeoffs. Every request needs cryptographic verification. There&rsquo;s no
caching (each signature is unique with different timestamps/nonces). There&rsquo;s no connection-level optimization
(signatures are per-request, not per-connection).</p><p>If verification is still too expensive after choosing an efficient algorithm, you need more servers. That&rsquo;s the cost of
application-layer message authentication.</p><h3 id=when-does-performance-actually-matter><a href=#when-does-performance-actually-matter class=header-anchor></a>When does performance actually matter?</h3><p>For most APIs, performance is dominated by network latency, database queries, and business logic. Unless you&rsquo;re
operating at very high scale (thousands of requests per second per server) or on constrained devices, the signature
verification overhead is negligible compared to everything else your application does.</p><p>But if you&rsquo;re building infrastructure that processes millions of requests, the CPU cost adds up. Budget for it. Test
with realistic load. Choose your algorithms based on actual measurements, not just theoretical security levels.</p><h2 id=does-your-api-need-message-level-authentication><a href=#does-your-api-need-message-level-authentication class=header-anchor></a>Does your API need message-level authentication?</h2><p>Not every API needs HTTP message signatures. If you&rsquo;re building a simple internal service with API keys over TLS, you&rsquo;re
probably fine. But there are specific situations where message signatures solve real problems.</p><p>Ask yourself these questions:</p><p><strong>How easy is it for someone modify the message between your client and server?</strong> And if it happens, how big of a
security problem is it?</p><p><strong>Do you need to verify requests at the application server?</strong> If your load balancer terminates TLS, can your application
trust that the request actually came from the authenticated client? Or could something between the load balancer and
your app have modified it?</p><p><strong>Can&rsquo;t use mTLS everywhere?</strong> Maybe you have public-facing APIs where client certificate management is impractical. Or
you need per-endpoint authentication control, not all-or-nothing connection security. Message signatures work at the
application layer, giving you more flexibility.</p><p><strong>Are you integrating with federated systems?</strong> If you&rsquo;re building something like Mastodon where servers need to trust
messages from other servers they&rsquo;ve never seen before, message signatures with published public keys solve that cleanly.</p><p><strong>Do you want a standard instead of custom schemes?</strong> Tired of implementing different signature verification for every
vendor&rsquo;s API? Want your clients to use a standard approach instead of your custom homebrew scheme?</p><p>If you answered yes to any of these, HTTP message signatures are worth evaluating. If not, simpler approaches might be a
better fit.</p><p>The standard exists. The libraries are available. CDNs are already supporting it. The barrier to adoption is lower than
you think.</p><h2 id=further-reading><a href=#further-reading class=header-anchor></a>Further reading</h2><ul><li><p><strong><a class=link href=../mtls-vs-http-signature/>mTLS vs HTTP signature faceoff</a></strong><br>Compare transport-layer security with application-layer message authentication. Learn which approach fits your
architecture and when combining both methods provides the strongest protection.</p></li><li><p><strong><a class=link href=../mtls/>Mutual TLS (mTLS): building a client using the system keystore</a></strong><br>Discover how to implement mutual TLS authentication while securely storing certificates and private keys using native
system keystores on macOS and Windows.</p></li><li><p><strong><a class=link href=../how-to-use-tpm/>How to use TPM 2.0 to secure private keys</a></strong><br>Protect your signing keys with hardware-backed security. This practical guide shows you how to generate, store, and
use cryptographic keys with TPM 2.0 modules.</p></li></ul><h2 id=watch-the-conference-talk-based-on-this-article><a href=#watch-the-conference-talk-based-on-this-article class=header-anchor></a>Watch the conference talk based on this article</h2><div class=video-wrapper><iframe loading=lazy src=https://www.youtube.com/embed/6QxkfPy0k4U allowfullscreen title="YouTube Video"></iframe></div><p><em>Note:</em> If you want to comment on this article, please do so on the YouTube video.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/application-security/>Application Security</a>
<a href=/tags/mtls/>mTLS</a>
<a href=/tags/jwt/>JWT</a>
<a href=/tags/http-message-signatures/>HTTP Message Signatures</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/mtls-vs-http-signature/><div class=article-image><img src=/posts/mtls-vs-http-signature/mtls-vs-http-signature.6793a8f06dc153f8a4a009271b36cc32_hu_b6ca4b636bfac0bb.png width=250 height=150 loading=lazy alt="Featured image of post mTLS vs HTTP signature faceoff: securing your APIs" data-hash="md5-Z5Oo8G3BU/ikoAknGzbMMg=="></div><div class=article-details><h2 class=article-title>mTLS vs HTTP signature faceoff: securing your APIs</h2></div></a></article><article class=has-image><a href=/posts/mtls-go-client-windows-certificate-store/><div class=article-image><img src=/posts/mtls-go-client-windows-certificate-store/mtls-go-windows.0a8dfbc39a48ef72269453d3110b2806_hu_451927e505aad89a.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client using Windows certificate store" data-hash="md5-Co37w5pI73ImlFPTEQsoBg=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client using Windows certificate store</h2></div></a></article><article class=has-image><a href=/posts/mtls-go-client-using-apple-keychain/><div class=article-image><img src=/posts/mtls-go-client-using-apple-keychain/mtls-go-apple-keychain.4be855897ea7b8897e027a30c449d256_hu_caafedfb4a15f47b.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client using macOS keychain" data-hash="md5-S+hViX6nuIl+AnowxEnSVg=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client using macOS keychain</h2></div></a></article><article class=has-image><a href=/posts/mtls-go-custom-signer/><div class=article-image><img src=/posts/mtls-go-custom-signer/signer.4d60e63c2cfbb31978535b2b67059f38_hu_b4972da075e973f6.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client with custom certificate signer" data-hash="md5-TWDmPCz7sxl4U1srZwWfOA=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client with custom certificate signer</h2></div></a></article><article class=has-image><a href=/posts/mtls-go-client/><div class=article-image><img src=/posts/mtls-go-client/go-client.d367a206fbe9c06685ee92f65e0026b9_hu_15226410fb3a62b6.png width=250 height=150 loading=lazy alt="Featured image of post Mutual TLS (mTLS) Go client" data-hash="md5-02eiBvvpwGaF7pL2XgAmuQ=="></div><div class=article-details><h2 class=article-title>Mutual TLS (mTLS) Go client</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 Victor on Software</section><section class=powerby></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true, theme: 'dark' });
</script>