<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Database issues that arise when scaling applications"><title>3 database gotchas when building apps for scale</title><link rel=canonical href=https://victoronsoftware.com/posts/database-gotchas-when-scaling-apps/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="3 database gotchas when building apps for scale"><meta property='og:description' content="Database issues that arise when scaling applications"><meta property='og:url' content='https://victoronsoftware.com/posts/database-gotchas-when-scaling-apps/'><meta property='og:site_name' content='Victor on Software'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='SQL Performance'><meta property='article:tag' content='SQL Developer'><meta property='article:tag' content='Database Scaling'><meta property='article:tag' content='MySQL'><meta property='article:published_time' content='2024-05-29T00:00:00+00:00'><meta property='article:modified_time' content='2024-05-29T00:00:00+00:00'><meta property='og:image' content='https://victoronsoftware.com/posts/database-gotchas-when-scaling-apps/database-thumbnail.png'><meta name=twitter:title content="3 database gotchas when building apps for scale"><meta name=twitter:description content="Database issues that arise when scaling applications"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://victoronsoftware.com/posts/database-gotchas-when-scaling-apps/database-thumbnail.png'><script async src="https://www.googletagmanager.com/gtag/js?id=G-1XV381YSQ8"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1XV381YSQ8")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_2a985bbd48e632da.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Victor on Software</a></h1><h2 class=site-description>Software engineering, security, and related topics</h2></div></header><ol class=menu-social><li><a href=https://fleetdm.com target=_blank title=Fleet rel=me><svg width="58.219mm" height="58.202mm" viewBox="0 0 58.219 58.202"><g stroke-width=".26458"><path d="m7.5963 14.823c3.954.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2053 7.1594 7.1594 7.1594z" fill="#63c740"/><path d="m29.075 14.823c3.9539.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.9541.0-7.1595 3.2053-7.1595 7.1594.0 3.954 3.2054 7.1594 7.1595 7.1594z" fill="#5cabdf"/><path d="m50.552 14.823c3.9542.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2052-7.1594-7.1594-7.1594-3.9539.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2054 7.1594 7.1594 7.1594z" fill="#d66c7b"/><path d="m7.5963 36.301c3.954.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.954.0-7.1594 3.2054-7.1594 7.1595.0 3.9539 3.2053 7.1594 7.1594 7.1594z" fill="#c98def"/><path d="m29.075 36.301c3.9539.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.9541.0-7.1595 3.2054-7.1595 7.1595.0 3.9539 3.2054 7.1594 7.1595 7.1594z" fill="#faa669"/><path d="m7.5963 57.779c3.954.0 7.1594-3.2052 7.1594-7.1594.0-3.9539-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2054-7.1594 7.1594.0 3.9542 3.2053 7.1594 7.1594 7.1594z" fill="#3aefc4"/></g></svg></a></li><li><a href=https://github.com/getvictor target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/lyuboslavsky/ target=_blank title=LinkedIn rel=me><svg width="16" height="16" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401m-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4"/></svg></a></li><li><a href=http://www.youtube.com/@VictorOnSoftware target=_blank title=YouTube rel=me><svg height="800" width="800" id="Layer_1" viewBox="0 0 461.001 461.001"><g><path style="fill:#f61c0d" d="M365.257 67.393H95.744C42.866 67.393.0 110.259.0 163.137v134.728c0 52.878 42.866 95.744 95.744 95.744h269.513c52.878.0 95.744-42.866 95.744-95.744V163.137c0-52.878-42.866-95.744-95.744-95.744zM300.506 237.056l-126.06 60.123c-3.359 1.602-7.239-.847-7.239-4.568V168.607c0-3.774 3.982-6.22 7.348-4.514l126.06 63.881C304.363 229.873 304.298 235.248 300.506 237.056z"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/page/speaking/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 2m0 3a3 3 0 013-3h0a3 3 0 013 3v5a3 3 0 01-3 3h0a3 3 0 01-3-3z"/><path d="M5 10a7 7 0 0014 0"/><path d="M8 21h8"/><path d="M12 17v4"/></svg>
<span>Speaking</span></a></li><li><a href=/page/tools/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Software tools</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/database-gotchas-when-scaling-apps/><img src=/posts/database-gotchas-when-scaling-apps/database-thumbnail_hu_3f6d8348e03587ac.png srcset="/posts/database-gotchas-when-scaling-apps/database-thumbnail_hu_3f6d8348e03587ac.png 800w, /posts/database-gotchas-when-scaling-apps/database-thumbnail_hu_8b90c40fe4cbd7a2.png 1600w" width=800 height=419 loading=lazy alt="Featured image of post 3 database gotchas when building apps for scale"></a></div><div class=article-details><header class=article-category><a href=/categories/database-administration/>Database Administration</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/database-gotchas-when-scaling-apps/>3 database gotchas when building apps for scale</a></h2><h3 class=article-subtitle>Database issues that arise when scaling applications</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 29, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><ul><li><a class=link href=#excessive-database-locks>Excessive database locks</a></li><li><a class=link href=#read-after-write-consistency>Read-after-write consistency</a></li><li><a class=link href=#index-limitations>Index limitations</a></li></ul><p>When building an application, the database is often an afterthought. The database used in a development environment
often contains limited data with little traffic. However, when the application is deployed to production, real-world
traffic can expose issues that were not caught in development or testing.</p><p>In this article, we cover issues we ran into with our customers. We assume the production application is deployed with
one master and one or more read replicas. See this article on
<a class=link href=../mysql-master-slave-replication>creating a MySQL slave replica in dev environment</a>.</p><h2 id=excessive-database-locks><a href=#excessive-database-locks class=header-anchor></a>Excessive database locks</h2><p>One write query can bring your database to its knees if it locks too many rows.</p><p>Consider this simplified INSERT with a subquery transaction:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> software_counts (host_id, <span style=color:#66d9ef>count</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> host_id, <span style=color:#66d9ef>COUNT</span>(<span style=color:#f92672>*</span>) <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>count</span> <span style=color:#66d9ef>FROM</span> host_software
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> host_software.host_id;
</span></span></code></pre></div><figure><img src=/posts/database-gotchas-when-scaling-apps/simple-insert-with-subquery.svg alt="Simplified INSERT with a subquery"><figcaption><h4>Simplified INSERT with a subquery</h4></figcaption></figure><p>The above query scans the entire <code>host_software</code> table index to create a count. While the database is doing the scan and
the INSERT, it locks the <code>host_software</code> table, preventing other transactions from writing to that table. If the table
and insert are large, the query can hold the lock for a long time. In production, we saw a lock time of over 30 seconds,
creating a bottleneck and spiking DB resource usage.</p><p>Pay special attention to the following queries, as they can cause performance issues:</p><ul><li><code>COUNT(*)</code></li><li>Using a non-indexed column, like <code>WHERE non_indexed_column = value</code></li><li>Returning a large number of rows, like <code>SELECT * FROM table</code></li></ul><p>One way to solve the above performance issue is to separate the <code>SELECT</code> and <code>INSERT</code> queries. First, run the <code>SELECT</code>
query on the replica to get the data, then run the <code>INSERT</code> query on the master to insert the data. We completely
eliminate the lock since the read is done on the replica. This article goes through
<a class=link href=.../mysql-query-performance-insert-subqueries>a specific example of optimizing an INSERT with subqueries</a>.</p><p>As general advice, avoid running <code>SELECT</code> queries and subqueries on the master, especially if they scan the entire
table.</p><h2 id=read-after-write-consistency><a href=#read-after-write-consistency class=header-anchor></a>Read-after-write consistency</h2><p>When you write to the master and read from the replica, you might not see the data you wrote. The replica is not in sync
with the master in real time. In our production, the replica is usually less than 30 milliseconds behind the master.</p><figure><img src=/posts/database-gotchas-when-scaling-apps/read-after-write-consistency.svg alt="Read-after-write database issue"><figcaption><h4>Read-after-write database issue</h4></figcaption></figure><p>These issues are typically not caught in development since dev environments usually have one database instance. Unit or
integration tests might not even see these issues if they run on a single database instance. Even in testing or small
production environments, you might only see these issues if the replica sync time is high. Customers with large
deployments may be experiencing these consistency issues without the development team knowing about it.</p><p>One way to solve this issue is to read from the master after writing to it. This way, you are guaranteed to see the data
you just wrote. In
<a class=link href=https://github.com/fleetdm/fleet/blob/b7aac2cfabf17fcb5142808fb80352113710ec5c/server/contexts/ctxdb/ctxdb.go#L17 target=_blank rel=noopener>our Go backend</a>,
forcing reads from the master can be done by updating the <code>Context</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>ctxUsePrimary</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ctxdb</span>.<span style=color:#a6e22e>RequirePrimary</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#66d9ef>true</span>)
</span></span></code></pre></div><p>However, additional master reads increase the load on the master, defeating the purpose of having a replica for read
scaling.</p><p>In addition, what about expensive read queries, like <code>COUNT(*)</code> and calculations, which we don&rsquo;t want to run on the
master? In this case, we can wait for the replica to catch up with the master.</p><p>One generic approach to waiting for the replica is to read the last written data from the replica and retry the read if
the data is not found. The app could check the <code>updated_at</code> column to see if the data is recent. If the data is not
found, the app can sleep for a few milliseconds and retry the read. This approach is imperfect but a good compromise
between read consistency and performance.</p><p>Note:
<a class=link href="https://dev.mysql.com/doc/refman/8.0/en/date-and-time-type-syntax.html#:~:text=default%20precision%20is%200." target=_blank rel=noopener>The default precision of MySQL date and time data types is 1 second (0 fractional seconds)</a>.</p><h2 id=index-limitations><a href=#index-limitations class=header-anchor></a>Index limitations</h2><h3 id=what-are-sql-indexes><a href=#what-are-sql-indexes class=header-anchor></a>What are SQL indexes?</h3><p>Indexes are a way to optimize read queries. They are a data structure that improves the speed of data retrieval
operations on a database table at the cost of additional writes and storage space to maintain the index data structure.
Indexes are created using one or more database columns and are stored and sorted using a B-tree or a similar data
structure. The goal is to reduce the number of data comparisons needed to find the data.</p><figure><img src=/posts/database-gotchas-when-scaling-apps/database-index.svg alt="Database index"><figcaption><h4>Database index</h4></figcaption></figure><p>Indexes are generally beneficial. They speed up read queries but slightly slow down write queries. Indexes can also be
large and take up a lot of disk space.</p><h3 id=index-size-is-limited><a href=#index-size-is-limited class=header-anchor></a>Index size is limited</h3><p>As the product grows with more features, the number of columns in a specific table can also increase. Sometimes, the new
columns need to be part of a unique index. However, the
<a class=link href=https://dev.mysql.com/doc/refman/8.0/en/innodb-limits.html target=_blank rel=noopener>maximum index size in MySQL is 3072 bytes</a>. This limit can
be quickly reached if columns are of type <code>VARCHAR</code> or <code>TEXT</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#f92672>`</span>activities<span style=color:#f92672>`</span> (
</span></span><span style=display:flex><span>  <span style=color:#f92672>`</span>user_name<span style=color:#f92672>`</span> VARCHAR(<span style=color:#ae81ff>255</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span></code></pre></div><p>One way to solve the issue of hitting the index size limit is to create a new column that makes the hash of the other
relevant column(s), and use that as the unique index. For example, in our backend
<a class=link href=https://github.com/fleetdm/fleet/blob/6f008b40f24bcd000c1450d7438be99d30c518c5/server/datastore/mysql/schema.sql#L1450 target=_blank rel=noopener>we use a <code>checksum</code> column in the <code>software</code> table to create a unique index for a software item</a>.</p><h3 id=foreign-keys-may-cause-performance-issues><a href=#foreign-keys-may-cause-performance-issues class=header-anchor></a>Foreign keys may cause performance issues</h3><p>If a table has a foreign key, any insert, update, or delete with a constraint on the foreign key column will lock the
corresponding row in the parent table. This locking can lead to performance issues when</p><ul><li>the parent table is large</li><li>the parent has many foreign key constraints</li><li>the parent table or child tables are frequently updated</li></ul><p>The performance issue manifests as excessive lock wait times for queries. One way to solve this issue is to remove the
foreign key constraint. Instead, the application code can handle the data integrity checks that the foreign key
constraint provides. In our application, we run a regular clean-up job to remove orphaned child rows.</p><h2 id=bonus-database-gotchas><a href=#bonus-database-gotchas class=header-anchor></a>Bonus database gotchas</h2><p>Additional database gotchas that we have seen in production include:</p><ul><li><a class=link href=../sql-prepared-statements-are-broken-when-scaling-applications>Prepared statements consuming too much memory</a></li><li><a class=link href=../mysql-upsert-deadlock>Deadlocks caused by using an UPDATE/INSERT upsert pattern</a></li></ul><p>Also, we recently <a class=link href=../distributed-lock>solved a problem in production with distributed lock</a>.</p><h2 id=3-database-gotchas-video><a href=#3-database-gotchas-video class=header-anchor></a>3 database gotchas video</h2><div class=video-wrapper><iframe loading=lazy src=https://www.youtube.com/embed/N-wzNq-sEwo allowfullscreen title="YouTube Video"></iframe></div><p><em>Note:</em> If you want to comment on this article, please do so on the YouTube video.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/sql-performance/>SQL Performance</a>
<a href=/tags/sql-developer/>SQL Developer</a>
<a href=/tags/database-scaling/>Database Scaling</a>
<a href=/tags/mysql/>MySQL</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/mysql-query-performance-insert-subqueries/><div class=article-image><img src=/posts/mysql-query-performance-insert-subqueries/INSERT%20with%20subqueries.d07521c1694343feb0991bd8dc4fb2e9_hu_e0761bba9839801b.png width=250 height=150 loading=lazy alt="Featured image of post Optimize MySQL query performance: INSERT with subqueries" data-hash="md5-0HUhwWlDQ/6wmRvY3E+y6Q=="></div><div class=article-details><h2 class=article-title>Optimize MySQL query performance: INSERT with subqueries</h2></div></a></article><article class=has-image><a href=/posts/mysql-upsert-deadlock/><div class=article-image><img src=/posts/mysql-upsert-deadlock/MySQL%20deadlock.65122d6e99ece24b1e1751637f018a80_hu_f2e8113f5d3bbdac.png width=250 height=150 loading=lazy alt="Featured image of post MySQL deadlock on UPDATE/INSERT upsert pattern" data-hash="md5-ZRItbpns4kseF1FjfwGKgA=="></div><div class=article-details><h2 class=article-title>MySQL deadlock on UPDATE/INSERT upsert pattern</h2></div></a></article><article class=has-image><a href=/posts/sql-prepared-statements-are-broken-when-scaling-applications/><div class=article-image><img src=/posts/sql-prepared-statements-are-broken-when-scaling-applications/cover.eafd31b48e2454f1eec208dbae83a4f6_hu_8a0702c7411c161e.png width=250 height=150 loading=lazy alt="Featured image of post SQL prepared statements are broken when scaling applications" data-hash="md5-6v0xtI4kVPHuwgjbroOk9g=="></div><div class=article-details><h2 class=article-title>SQL prepared statements are broken when scaling applications</h2></div></a></article><article class=has-image><a href=/posts/unicode-and-emoji-gotchas/><div class=article-image><img src=/posts/unicode-and-emoji-gotchas/unicode-emoji.eb9b662f2aff344a37b3e21005ad1a14_hu_178280c626a1887e.png width=250 height=150 loading=lazy alt="Featured image of post Fully supporting Unicode and emojis in your app" data-hash="md5-65tmLyr/NEo3s+IQBa0aFA=="></div><div class=article-details><h2 class=article-title>Fully supporting Unicode and emojis in your app</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 Victor on Software</section><section class=powerby></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>