<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Learn how to communicate between parts of a Chrome extension"><title>Message passing in Chrome extension (2024)</title>
<link rel=canonical href=https://victoronsoftware.com/posts/message-passing-in-chrome-extension/><link rel=stylesheet href=/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css><meta property='og:title' content="Message passing in Chrome extension (2024)"><meta property='og:description' content="Learn how to communicate between parts of a Chrome extension"><meta property='og:url' content='https://victoronsoftware.com/posts/message-passing-in-chrome-extension/'><meta property='og:site_name' content='Victor on Software'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='Chrome Extension'><meta property='article:tag' content='Message passing'><meta property='article:tag' content='Web Development'><meta property='article:published_time' content='2024-06-12T00:00:00+00:00'><meta property='article:modified_time' content='2024-06-12T00:00:00+00:00'><meta property='og:image' content='https://victoronsoftware.com/posts/message-passing-in-chrome-extension/message-passing-headline.png'><meta property='article:author' content='Victor Lyuboslavsky'><meta name=twitter:title content="Message passing in Chrome extension (2024)"><meta name=twitter:description content="Learn how to communicate between parts of a Chrome extension"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://victoronsoftware.com/posts/message-passing-in-chrome-extension/message-passing-headline.png'><script async src="https://www.googletagmanager.com/gtag/js?id=G-1XV381YSQ8"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1XV381YSQ8")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu02a35fbedf562a954847f1a0edade347_219789_300x0_resize_box_3.png width=300 height=297 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Victor on Software</a></h1><h2 class=site-description>Software engineering, security, and related topics</h2></div></header><ol class=menu-social><li><a href=https://fleetdm.com target=_blank title=Fleet rel=me><svg width="58.219mm" height="58.202mm" viewBox="0 0 58.219 58.202" xmlns="http://www.w3.org/2000/svg"><g stroke-width=".26458"><path d="m7.5963 14.823c3.954.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2053 7.1594 7.1594 7.1594z" fill="#63c740"/><path d="m29.075 14.823c3.9539.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.9541.0-7.1595 3.2053-7.1595 7.1594.0 3.954 3.2054 7.1594 7.1595 7.1594z" fill="#5cabdf"/><path d="m50.552 14.823c3.9542.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2052-7.1594-7.1594-7.1594-3.9539.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2054 7.1594 7.1594 7.1594z" fill="#d66c7b"/><path d="m7.5963 36.301c3.954.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.954.0-7.1594 3.2054-7.1594 7.1595.0 3.9539 3.2053 7.1594 7.1594 7.1594z" fill="#c98def"/><path d="m29.075 36.301c3.9539.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.9541.0-7.1595 3.2054-7.1595 7.1595.0 3.9539 3.2054 7.1594 7.1595 7.1594z" fill="#faa669"/><path d="m7.5963 57.779c3.954.0 7.1594-3.2052 7.1594-7.1594.0-3.9539-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2054-7.1594 7.1594.0 3.9542 3.2053 7.1594 7.1594 7.1594z" fill="#3aefc4"/></g></svg></a></li><li><a href=https://github.com/getvictor target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/lyuboslavsky/ target=_blank title=LinkedIn rel=me><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401m-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4"/></svg></a></li><li><a href=http://www.youtube.com/@VictorOnSoftware target=_blank title=YouTube rel=me><svg height="800" width="800" id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 461.001 461.001"><g><path style="fill:#f61c0d" d="M365.257 67.393H95.744C42.866 67.393.0 110.259.0 163.137v134.728c0 52.878 42.866 95.744 95.744 95.744h269.513c52.878.0 95.744-42.866 95.744-95.744V163.137c0-52.878-42.866-95.744-95.744-95.744zM300.506 237.056l-126.06 60.123c-3.359 1.602-7.239-.847-7.239-4.568V168.607c0-3.774 3.982-6.22 7.348-4.514l126.06 63.881C304.363 229.873 304.298 235.248 300.506 237.056z"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/page/tools/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Software tools</span></a></li><li><a href=/page/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/page/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/message-passing-in-chrome-extension/><img src=/posts/message-passing-in-chrome-extension/message-passing-headline_hu1ed8561cedf8e23a106e917b9f219ce7_1364307_800x0_resize_box_3.png srcset="/posts/message-passing-in-chrome-extension/message-passing-headline_hu1ed8561cedf8e23a106e917b9f219ce7_1364307_800x0_resize_box_3.png 800w, /posts/message-passing-in-chrome-extension/message-passing-headline_hu1ed8561cedf8e23a106e917b9f219ce7_1364307_1600x0_resize_box_3.png 1600w" width=800 height=419 loading=lazy alt="Featured image of post Message passing in Chrome extension (2024)"></a></div><div class=article-details><header class=article-category><a href=/categories/software-development/>Software Development</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/message-passing-in-chrome-extension/>Message passing in Chrome extension (2024)</a></h2><h3 class=article-subtitle>Learn how to communicate between parts of a Chrome extension</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jun 12, 2024</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><p>This article is part of a series on
<a class=link href=../chrome-extension>building a production-ready Chrome extension</a>.</p><p>In the previous article, we
<a class=link href=../add-webpack-and-typescript-to-chrome-extension>set up our Chrome extension with TypeScript support and the webpack bundler</a>.
This article will build on that code, dive into the new APIs, and cover
message-passing communication between different parts of our Chrome extension.</p><h2 id=communication-between-parts-of-a-chrome-extension><a href=#communication-between-parts-of-a-chrome-extension class=header-anchor></a>Communication between parts of a Chrome extension</h2><p>As we covered in <a class=link href=../create-chrome-extension>the first article</a>, a Chrome
extension consists of three main parts:</p><ul><li>service worker (background script)</li><li>content script</li><li>popup</li></ul><p>These parts need to communicate with each other. For example, a popup needs to
send a message to a content script to change the appearance of a webpage. Or a
background script needs to send a message to a popup to update the user
interface based on the page that&rsquo;s being visited.</p><figure><img src=/posts/message-passing-in-chrome-extension/message-passing.svg alt="Communication in a Chrome extension"><figcaption><h4>Communication in a Chrome extension</h4></figcaption></figure><p>One way to communicate between these parts is to use the local storage via the
<code>chrome.storage</code> APIs. We do not recommend this method because it is slow and
can cause performance issues. This method is slow because it is not synchronous
&ndash; the scripts need to check the storage for changes periodically. A better way
to communicate between extension parts is to use message passing.</p><h2 id=what-is-message-passing><a href=#what-is-message-passing class=header-anchor></a>What is message passing?</h2><p>In computer science, message passing is a method for communicating between
different processes or threads. A process or thread sends a message to another
process or thread, which receives the message and acts on it. This method is
often used in distributed systems, where processes run on different machines and
need to communicate with each other. The sender sends a message, and the
receiver decodes it and executes the appropriate code.</p><h2 id=message-passing-in-a-chrome-extension><a href=#message-passing-in-a-chrome-extension class=header-anchor></a>Message passing in a Chrome extension</h2><p>Message passing is a way to communicate between different parts of a Chrome
extension. Its main advantage is that it&rsquo;s fast and efficient. When a message is
sent, the receiver gets it immediately and can respond to it right away.</p><p>Message passing is done in Chrome extensions using the
<code>chrome.runtime.sendMessage</code>, <code>chrome.tabs.sendMessage</code> and
<code>chrome.runtime.onMessage</code> functions. Here&rsquo;s how it works:</p><ol><li>The sender calls <code>chrome.runtime.sendMessage</code> or <code>chrome.tabs.sendMessage</code>
with the message to send.</li><li>The receiver listens for messages using
<code>chrome.runtime.onMessage.addListener</code></li><li>The receiver processes the incoming message and, optionally, responds to the
message.</li></ol><h2 id=message-passing-from-a-popup-to-a-content-script><a href=#message-passing-from-a-popup-to-a-content-script class=header-anchor></a>Message passing from a popup to a content script</h2><p>Let&rsquo;s see how we can use message passing to communicate between a popup and a
content script. We will send a message when the user toggles the enable slider
in the popup, which will enable or disable the content script&rsquo;s processing. We
will use the <code>chrome.tabs.sendMessage</code> function to send a message to a specific
tab ID.</p><p>In the popup script (<code>popup.ts</code>), we send a message to all the tabs when we
detect a change in the top slider:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// Send message to content script in all tabs
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tabs</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>chrome</span>.<span style=color:#a6e22e>tabs</span>.<span style=color:#a6e22e>query</span>({})
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tab</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>tabs</span>) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Note: sensitive tab properties such as tab.title or tab.url can only be accessed for
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// URLs in the host_permissions section of manifest.json
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>chrome</span>.<span style=color:#a6e22e>tabs</span>.<span style=color:#a6e22e>sendMessage</span>(<span style=color:#a6e22e>tab</span>.<span style=color:#a6e22e>id</span><span style=color:#f92672>!</span>, {<span style=color:#a6e22e>enabled</span>: <span style=color:#66d9ef>event.target.checked</span>})
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>then</span>((<span style=color:#a6e22e>response</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;Popup received response from tab with title &#39;%s&#39; and url %s&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>title</span>, <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>url</span>)
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#66d9ef>catch</span>((<span style=color:#a6e22e>error</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>warn</span>(<span style=color:#e6db74>&#34;Popup could not send message to tab %d&#34;</span>, <span style=color:#a6e22e>tab</span>.<span style=color:#a6e22e>id</span>, <span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In the content script (<code>content.ts</code>), we listen for the message and process it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// Listen for messages from popup.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>chrome</span>.<span style=color:#a6e22e>runtime</span>.<span style=color:#a6e22e>onMessage</span>.<span style=color:#a6e22e>addListener</span>((<span style=color:#a6e22e>request</span>, <span style=color:#a6e22e>sender</span>, <span style=color:#a6e22e>sendResponse</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>enabled</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>undefined</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;Received message from sender %s&#34;</span>, <span style=color:#a6e22e>sender</span>.<span style=color:#a6e22e>id</span>, <span style=color:#a6e22e>request</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>enabled</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>enabled</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>enabled</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>observe</span>()
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>observer</span>.<span style=color:#a6e22e>disconnect</span>()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>sendResponse</span>({<span style=color:#a6e22e>title</span>: <span style=color:#66d9ef>document.title</span>, <span style=color:#a6e22e>url</span>: <span style=color:#66d9ef>window.location.href</span>})
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>When the user toggles the slider in the popup, the popup sends a message to all
tabs. The receiving tab will print this message to the Chrome Developer Tools
console.</p><figure><img src=/posts/message-passing-in-chrome-extension/content-script-received.png alt="Content script received message"><figcaption><h4>Content script received message</h4></figcaption></figure><p>Then, the popup will receive a response from the content script with the tab&rsquo;s
title and URL. This response prints to the <code>Inspect Popup</code> console. System tabs
like <code>chrome://extensions/</code> will not respond to messages.</p><figure><img src=/posts/message-passing-in-chrome-extension/popup-response.png alt="Popup received response"><figcaption><h4>Popup received response</h4></figcaption></figure><h2 id=message-passing-from-a-popup-to-the-service-worker-background-script><a href=#message-passing-from-a-popup-to-the-service-worker-background-script class=header-anchor></a>Message passing from a popup to the service worker (background script)</h2><p>To send a message to the service worker, we must use the
<code>chrome.runtime.sendMessage</code> function instead of <code>chrome.tabs.sendMessage</code>. The
service worker does not have a tab ID, so we cannot use
<code>chrome.tabs.sendMessage</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#a6e22e>chrome</span>.<span style=color:#a6e22e>runtime</span>.<span style=color:#a6e22e>sendMessage</span>({<span style=color:#a6e22e>enabled</span>: <span style=color:#66d9ef>event.target.checked</span>})
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>then</span>((<span style=color:#a6e22e>response</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;Popup received response&#34;</span>, <span style=color:#a6e22e>response</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>  .<span style=color:#66d9ef>catch</span>((<span style=color:#a6e22e>error</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>warn</span>(<span style=color:#e6db74>&#34;Popup could not send message&#34;</span>, <span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>    })
</span></span></code></pre></div><p>In the service worker script (<code>background.ts</code>), we listen for the message and
process it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#a6e22e>chrome</span>.<span style=color:#a6e22e>runtime</span>.<span style=color:#a6e22e>onMessage</span>.<span style=color:#a6e22e>addListener</span>((<span style=color:#a6e22e>request</span>, <span style=color:#a6e22e>sender</span>, <span style=color:#a6e22e>sendResponse</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>enabled</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>undefined</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;Service worker received message from sender %s&#34;</span>, <span style=color:#a6e22e>sender</span>.<span style=color:#a6e22e>id</span>, <span style=color:#a6e22e>request</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>sendResponse</span>({<span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Service worker processed the message&#34;</span>})
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><h2 id=message-passing-from-a-content-script-to-the-popup-and-service-worker><a href=#message-passing-from-a-content-script-to-the-popup-and-service-worker class=header-anchor></a>Message passing from a content script to the popup and service worker</h2><p>To send a message from the content script, use the <code>chrome.runtime.sendMessage</code>
function. The popup and service worker can listen and receive this message.</p><h2 id=message-passing-from-the-service-worker-background-script-to-a-content-script-and-the-popup><a href=#message-passing-from-the-service-worker-background-script-to-a-content-script-and-the-popup class=header-anchor></a>Message passing from the service worker (background script) to a content script and the popup</h2><p>Use the <code>chrome.tabs.sendMessage</code> function to send a message to the content
script. Use the <code>chrome.runtime.sendMessage</code> function to send a message to the
popup.</p><p>The code for sending a message from the service worker is the same as the code
for sending a message from the popup. The receiving code in the content and
popup scripts is also the same.</p><h2 id=next-steps><a href=#next-steps class=header-anchor></a>Next steps</h2><p>In the next part of this series, we will add linting and formatting tools to our
Chrome extension. These tools increase the quality of our code and increase
engineering velocity for projects with multiple developers.</p><h2 id=chrome-extension-with-webpack-and-typescript-code-on-github><a href=#chrome-extension-with-webpack-and-typescript-code-on-github class=header-anchor></a>Chrome extension with webpack and TypeScript code on GitHub</h2><p>The complete code is available on GitHub at:
<a class=link href=https://github.com/getvictor/create-chrome-extension/tree/main/3-message-passing target=_blank rel=noopener>https://github.com/getvictor/create-chrome-extension/tree/main/3-message-passing</a></p><h2 id=message-passing-in-a-chrome-extension-video><a href=#message-passing-in-a-chrome-extension-video class=header-anchor></a>Message passing in a Chrome extension video</h2><div class=video-wrapper><iframe loading=lazy src=https://www.youtube.com/embed/qANlZ5kzxcg allowfullscreen title="YouTube Video"></iframe></div><p><em>Note:</em> If you want to comment on this article, please do so on the YouTube
video.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/chrome-extension/>Chrome Extension</a>
<a href=/tags/message-passing/>Message passing</a>
<a href=/tags/web-development/>Web Development</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/chrome-extension/><div class=article-image><img src=/posts/chrome-extension/_hu7cf724450b4015658905efc628cab81b_42029_0858dde6f77e14c8510857c59334599f.png width=250 height=150 loading=lazy alt="Featured image of post Build a production-ready Chrome extension" data-hash="md5-MnOynIrcq0SkAxd+ZcnNPA=="></div><div class=article-details><h2 class=article-title>Build a production-ready Chrome extension</h2></div></a></article><article class=has-image><a href=/posts/create-chrome-extension/><div class=article-image><img src=/posts/create-chrome-extension/_hu7cf724450b4015658905efc628cab81b_42029_0858dde6f77e14c8510857c59334599f.png width=250 height=150 loading=lazy alt="Featured image of post Create a Chrome extension from scratch step-by-step (2024)" data-hash="md5-MnOynIrcq0SkAxd+ZcnNPA=="></div><div class=article-details><h2 class=article-title>Create a Chrome extension from scratch step-by-step (2024)</h2></div></a></article><article class=has-image><a href=/posts/add-webpack-and-typescript-to-chrome-extension/><div class=article-image><img src=/posts/add-webpack-and-typescript-to-chrome-extension/_hu9184b01262dcaf0a34fa52a6019d1dcb_42080_2fa4f5b454d25f319d9c1eac8eee74ac.png width=250 height=150 loading=lazy alt="Featured image of post Add webpack and TypeScript to a Chrome extension (2024)" data-hash="md5-mZy3qK+rHiLtZ1R7ts9T/g=="></div><div class=article-details><h2 class=article-title>Add webpack and TypeScript to a Chrome extension (2024)</h2></div></a></article><article class=has-image><a href=/posts/react-hello-world/><div class=article-image><img src=/posts/react-hello-world/react-hello-world.114df3ffe4eaca64d6317811b540bfb6_hu84b0260e55078cc47c5a5b8b4b4901b4_85634_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post Build a React app from scratch: getting started (2024)" data-hash="md5-EU3z/+TqymTWMXgRtUC/tg=="></div><div class=article-details><h2 class=article-title>Build a React app from scratch: getting started (2024)</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 Victor on Software</section><section class=powerby></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>