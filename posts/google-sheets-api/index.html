<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="How to get a Google Sheets API key and edit a Google Sheets spreadsheet"><title>How to quickly edit Google Sheets spreadsheet using the API</title><link rel=canonical href=https://victoronsoftware.com/posts/google-sheets-api/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="How to quickly edit Google Sheets spreadsheet using the API"><meta property='og:description' content="How to get a Google Sheets API key and edit a Google Sheets spreadsheet"><meta property='og:url' content='https://victoronsoftware.com/posts/google-sheets-api/'><meta property='og:site_name' content='Victor on Software'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='Google Sheets'><meta property='article:tag' content='Google APIs'><meta property='article:tag' content='Golang'><meta property='article:published_time' content='2024-12-18T00:00:00+00:00'><meta property='article:modified_time' content='2024-12-18T00:00:00+00:00'><meta property='og:image' content='https://victoronsoftware.com/posts/google-sheets-api/google-sheets-headline.png'><meta property='article:author' content='Victor Lyuboslavsky'><meta name=twitter:title content="How to quickly edit Google Sheets spreadsheet using the API"><meta name=twitter:description content="How to get a Google Sheets API key and edit a Google Sheets spreadsheet"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://victoronsoftware.com/posts/google-sheets-api/google-sheets-headline.png'><script async src="https://www.googletagmanager.com/gtag/js?id=G-1XV381YSQ8"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1XV381YSQ8")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_c8fdb37897842f49.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Victor on Software</a></h1><h2 class=site-description>Software engineering, security, and related topics</h2></div></header><ol class=menu-social><li><a href=https://fleetdm.com target=_blank title=Fleet rel=me><svg width="58.219mm" height="58.202mm" viewBox="0 0 58.219 58.202"><g stroke-width=".26458"><path d="m7.5963 14.823c3.954.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2053 7.1594 7.1594 7.1594z" fill="#63c740"/><path d="m29.075 14.823c3.9539.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2054-7.1594-7.1594-7.1594-3.9541.0-7.1595 3.2053-7.1595 7.1594.0 3.954 3.2054 7.1594 7.1595 7.1594z" fill="#5cabdf"/><path d="m50.552 14.823c3.9542.0 7.1594-3.2053 7.1594-7.1594.0-3.954-3.2052-7.1594-7.1594-7.1594-3.9539.0-7.1594 3.2053-7.1594 7.1594.0 3.954 3.2054 7.1594 7.1594 7.1594z" fill="#d66c7b"/><path d="m7.5963 36.301c3.954.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.954.0-7.1594 3.2054-7.1594 7.1595.0 3.9539 3.2053 7.1594 7.1594 7.1594z" fill="#c98def"/><path d="m29.075 36.301c3.9539.0 7.1594-3.2054 7.1594-7.1594.0-3.9541-3.2054-7.1595-7.1594-7.1595-3.9541.0-7.1595 3.2054-7.1595 7.1595.0 3.9539 3.2054 7.1594 7.1595 7.1594z" fill="#faa669"/><path d="m7.5963 57.779c3.954.0 7.1594-3.2052 7.1594-7.1594.0-3.9539-3.2054-7.1594-7.1594-7.1594-3.954.0-7.1594 3.2054-7.1594 7.1594.0 3.9542 3.2053 7.1594 7.1594 7.1594z" fill="#3aefc4"/></g></svg></a></li><li><a href=https://github.com/getvictor target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/lyuboslavsky/ target=_blank title=LinkedIn rel=me><svg width="16" height="16" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401m-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4"/></svg></a></li><li><a href=http://www.youtube.com/@VictorOnSoftware target=_blank title=YouTube rel=me><svg height="800" width="800" id="Layer_1" viewBox="0 0 461.001 461.001"><g><path style="fill:#f61c0d" d="M365.257 67.393H95.744C42.866 67.393.0 110.259.0 163.137v134.728c0 52.878 42.866 95.744 95.744 95.744h269.513c52.878.0 95.744-42.866 95.744-95.744V163.137c0-52.878-42.866-95.744-95.744-95.744zM300.506 237.056l-126.06 60.123c-3.359 1.602-7.239-.847-7.239-4.568V168.607c0-3.774 3.982-6.22 7.348-4.514l126.06 63.881C304.363 229.873 304.298 235.248 300.506 237.056z"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/page/tools/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Software tools</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/google-sheets-api/><img src=/posts/google-sheets-api/google-sheets-headline_hu_c7af10ff074b5a31.png srcset="/posts/google-sheets-api/google-sheets-headline_hu_c7af10ff074b5a31.png 800w, /posts/google-sheets-api/google-sheets-headline_hu_8d5de773efa45826.png 1600w" width=800 height=419 loading=lazy alt="Featured image of post How to quickly edit Google Sheets spreadsheet using the API"></a></div><div class=article-details><header class=article-category><a href=/categories/software-development/>Software Development</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/google-sheets-api/>How to quickly edit Google Sheets spreadsheet using the API</a></h2><h3 class=article-subtitle>How to get a Google Sheets API key and edit a Google Sheets spreadsheet</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Dec 18, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><ul><li><a class=link href=#get-a-google-sheets-api-key>Get a Google Sheets API key</a></li><li><a class=link href=#share-a-google-sheets-spreadsheet-with-the-service-account>Share a Google Sheets spreadsheet with the service account</a></li><li><a class=link href=#edit-a-google-sheets-spreadsheet-using-the-api>Edit a Google Sheets spreadsheet using the API</a></li></ul><p>When you need to edit a Google Sheets spreadsheet quickly, you can use the Google Sheets API. The API allows you to
programmatically read, write, and update data in a Google Sheets spreadsheet. However, following the
<a class=link href=https://developers.google.com/sheets/api/guides/concepts target=_blank rel=noopener>Google Sheets API documentation</a> can be overwhelming. In this
article, we will show you how to get a Google Sheets API key and edit a Google Sheets spreadsheet using the API.</p><h2 id=user-authentication-oauth-vs-api-key-jwt><a href=#user-authentication-oauth-vs-api-key-jwt class=header-anchor></a>User authentication (OAuth) vs. API key (JWT)</h2><p>The problem is that the Google API documentation focuses on the <a class=link href=https://oauth.net/2/ target=_blank rel=noopener>OAuth 2.0</a> user authentication
flow. This flow is useful when you need to access Google Sheets on behalf of a user. For example, you&rsquo;re creating your
web app, and you need to read or write data in a Google Sheets spreadsheet owned by your web app user. The OAuth
standard allows Google to authenticate the user and authorize your app to access the user&rsquo;s data without exposing the
user&rsquo;s credentials to your web app. The OAuth flow interacts with three parties &ndash; the user, your web app, and Google.</p><p>In our case, we want to access a specific Google Sheets spreadsheet programmatically without user interaction. We can
use the API key (JWT) authentication method. JWT stands for JSON Web Token, a standard for securely transmitting
information between two parties. This method allows us to access Google Sheets programmatically without user
interaction. The API key (JWT) method interacts with two parties: your app and Google.</p><h2 id=get-a-google-sheets-api-key><a href=#get-a-google-sheets-api-key class=header-anchor></a>Get a Google Sheets API key</h2><p>To get a Google Sheets API key, follow these steps:</p><ol><li>Go to the <a class=link href=https://console.cloud.google.com/ target=_blank rel=noopener>Google Cloud Console</a>.</li><li>Create a new project or select an existing project.<figure><img src=/posts/google-sheets-api/google-cloud-new-project.png alt="Welcome to Google Cloud screen, with a modal to select a project. The NEW PROJECT text in the top right of the modal is highlighted."></figure></li><li>In the new project, go to <strong>APIs & Services</strong> and enable the <strong>Google Sheets API</strong>. After enabling it, you should see
it in the <strong>Enabled APIs & services</strong> list.<figure><img src=/posts/google-sheets-api/google-cloud-enabled-sheets-api.png alt="Google Cloud APIs & Services console with the Google Sheets API enabled."></figure></li><li>Go to <strong>APIs & Services</strong> > <strong>Credentials</strong> and create a new Service Account. This account does not need any optional
permissions.<figure><img src=/posts/google-sheets-api/google-cloud-service-account.png alt="Google Cloud IAM & Admin screen with a service account."></figure></li><li>Create a new JSON key for the service account.<figure><img src=/posts/google-sheets-api/google-cloud-service-account-create-new-key.png alt="Google Cloud service account detailed view. The KEYS tab is selected. ADD KEY button is pressed, showing the option to Create new key."></figure></li><li>After creating the key, the JSON file will be automatically downloaded to your computer. This file contains the
credentials for your service account. Keep it secure. For example, we received
<code>axial-paratext-444915-f9-8ef1de636587.json</code> with the following content:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;service_account&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;project_id&#34;</span>: <span style=color:#e6db74>&#34;axial-paratext-444915-f9&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;private_key_id&#34;</span>: <span style=color:#e6db74>&#34;8ef1de636587238a028addaa8be9dbdf1d406420&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;private_key&#34;</span>: <span style=color:#e6db74>&#34;-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDGFXmEc6VK0TO9\n2E/LDel4gTYl1u8uZGtX16B7Lo4ufM7ics3h9Gyi1lJMcGrHruGEzatDeTRclILd\nLhLwrckfl3IF9MIsqwaEkHk7YnUXj9zGl+v8LTGJL0ycQ9hVdoD6cCOOAmghLj8F\n9Sl6KQ5PHGbBUUL4qi8uExKY4tQOrqol1Pi3RPpAOCR6BLC/ZFPp+4e4HRhF+DMD\nI1QX8QwPit9XdIomnZPUL5sGD+q4cp1gHLBuBp2ehyiFI5MGhgzvCIQzaTExw7GK\nqrjYMjBKXaFRqGpZJWJMdVmGGHpmZLCL/wQmhujlThrF0FO8BHAGriAvUgDbH7m/\nMzGRk/KzAgMBAAECggEAE7LwBkWP8xxR9nfMG6fzB3pmHaY93BG9gRtfCNEM77+W\nvXtoUSfDJACHZ7WoUNpp8BCaDxg/JlPYndFmrcvCnCMuAjygkNujRsytWcQFXAYB\nETjrjYUbD4cGKeYvXfRuiDldt9Iyc9ZLCzch3FW36BMtft0reVpHXeAksdKg/yKf\nhM4jw3tQMu5JR3trLHtqwaA8VUav7I2Qn8nxEbB/0+AUatqpDOp/hQNTN7MGZ/i7\n4V0538U7C9RYDzk9hBBT2/IegGixlL0lX2V6LjYlRcEgC0PLuKF7gM/RRnorNPnv\nHfHxyZt6/MyI8RLRwwv05ZSITaOj66lXxReVsMXxhQKBgQD+vJPrvKD7mGiXRQto\nh1LJqPcyknzLzxf2OX5vZyF8asdroU0sRy8pYYHy8JCPlkOJ0fj9kq6R79W+rmn3\npFkvwRY9dUcJLpoMAMEfO4wQp3QKpxdkjMS8xGcEVOIZacAHCof7uUwrHUUcqRIq\nwrgZcj5P8ZjwsLmuqLNeXqFYNwKBgQDHEPf4PCyjieF+aGvaOPLfn/lRBbEQGlrg\n9Z09UXpxcW39RMq7MkS+U9m88Kn9MsEK3umJdP+s5m8ddVdIVgZLj96Ufn52RzRT\ne8crSjCVC3oQaloScvOBSQA1Z3Bn+QstIko042i2qTNJWMArdCJe9uRbwL1hqEvx\n+LtNPniDZQKBgQDX4g9maFzx/G8fS+doNc8mkmi01kqnGyJOjNknJnrNi1zoTTIv\nBUDly/oqXk/VMF6ajXV7yPTjPyOhTwUFV6Yx/2yOtzZ1hKYO6BDDHF8Ouitw37zG\nfTo6VCSOGjXnnaSdEwK9hYMUwuCQcoSv8oe9IQHIFJMt4EfsypIAtyf7rwKBgFtC\ntzvRcnGC+6K1AoTnyMimkWkIn/UO8Azj7TM4UFcDtnX+/KY3VHahAFhzSKswgnmW\nWiBPSAufFN+/dMVP0tD/Yv5Ww2k8GYwQWe3JtF4QBeTSrPp6QpJJwlO5WToBXZNS\nfgyjGNVs2ntMucTyF/PLYkOCKBBGVJLZAh1Wf29VAoGADf7a1l8kDKgokm6pc4qG\nzb97GMk1CpE0dGl31dvx2ilckDVP354yfWEwVXWWVfVSq/LQdJVgkdArYbAPdsPb\nYuUfNwXMSp/OjmEL2QyC2zRm+2ZZZt5bcnPRbYETzb2An8kDYX49vwgBLJXpLOmt\nlCvxUDyoASHgAMu+OlqHIh4=\n-----END PRIVATE KEY-----\n&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;client_email&#34;</span>: <span style=color:#e6db74>&#34;example@axial-paratext-444915-f9.iam.gserviceaccount.com&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;client_id&#34;</span>: <span style=color:#e6db74>&#34;114906617333001451487&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;auth_uri&#34;</span>: <span style=color:#e6db74>&#34;https://accounts.google.com/o/oauth2/auth&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;token_uri&#34;</span>: <span style=color:#e6db74>&#34;https://oauth2.googleapis.com/token&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;auth_provider_x509_cert_url&#34;</span>: <span style=color:#e6db74>&#34;https://www.googleapis.com/oauth2/v1/certs&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;client_x509_cert_url&#34;</span>: <span style=color:#e6db74>&#34;https://www.googleapis.com/robot/v1/metadata/x509/example%40axial-paratext-444915-f9.iam.gserviceaccount.com&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;universe_domain&#34;</span>: <span style=color:#e6db74>&#34;googleapis.com&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=share-a-google-sheets-spreadsheet-with-the-service-account><a href=#share-a-google-sheets-spreadsheet-with-the-service-account class=header-anchor></a>Share a Google Sheets spreadsheet with the service account</h2><p>Share the spreadsheet with the service account email address to allow the account to access a Google Sheets spreadsheet.
In our case, the service account email is <code>example@axial-paratext-444915-f9.iam.gserviceaccount.com</code>.</p><figure><img src=/posts/google-sheets-api/google-sheets-share-with-service-account.png alt="Google Sheets spreadsheet with the Share modal open. The spreadsheet is shared with the service account with editor permissions."></figure><p>Note the spreadsheet ID from the URL. For example, in the URL
<code>https://docs.google.com/spreadsheets/d/1QCtnB6MXfFJLZsBE1E2vq5FxKBgh1Q0s727wRxFkmX4/edit</code>, the spreadsheet ID is
<code>1QCtnB6MXfFJLZsBE1E2vq5FxKBgh1Q0s727wRxFkmX4</code>.</p><h2 id=edit-a-google-sheets-spreadsheet-using-the-api><a href=#edit-a-google-sheets-spreadsheet-using-the-api class=header-anchor></a>Edit a Google Sheets spreadsheet using the API</h2><p>Now that we have the Google Sheets API key and editor permissions for the target spreadsheet, we can edit it using the
API. For this example, we will use the Go programming language.</p><p>In an empty directory, create a Go project and get the necessary dependencies:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>go mod init google-sheets-api
</span></span><span style=display:flex><span>go get golang.org/x/oauth2@v0.24.0
</span></span><span style=display:flex><span>go get google.golang.org/api@v0.211.0
</span></span></code></pre></div><p>Copy the JSON key file to the project directory and rename it to <code>credentials.json</code>.</p><p>Create a new Go file, <code>main.go</code>, with the following content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;context&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;log&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;os&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;golang.org/x/oauth2/google&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;google.golang.org/api/option&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;google.golang.org/api/sheets/v4&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>spreadsheetId</span> = <span style=color:#e6db74>&#34;1QCtnB6MXfFJLZsBE1E2vq5FxKBgh1Q0s727wRxFkmX4&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Background</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>serviceAccountKey</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>ReadFile</span>(<span style=color:#e6db74>&#34;credentials.json&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalf</span>(<span style=color:#e6db74>&#34;Unable to read client secret file: %v&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cfg</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>google</span>.<span style=color:#a6e22e>JWTConfigFromJSON</span>(<span style=color:#a6e22e>serviceAccountKey</span>, <span style=color:#a6e22e>sheets</span>.<span style=color:#a6e22e>SpreadsheetsScope</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalf</span>(<span style=color:#e6db74>&#34;Unable to parse client secret file to config: %v&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>client</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>cfg</span>.<span style=color:#a6e22e>Client</span>(<span style=color:#a6e22e>ctx</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>srv</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>sheets</span>.<span style=color:#a6e22e>NewService</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>option</span>.<span style=color:#a6e22e>WithHTTPClient</span>(<span style=color:#a6e22e>client</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalf</span>(<span style=color:#e6db74>&#34;Unable to retrieve Sheets client: %v&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>readRange</span> <span style=color:#f92672>:=</span> <span style=color:#e6db74>&#34;Sheet1!A2:B2&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>resp</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>srv</span>.<span style=color:#a6e22e>Spreadsheets</span>.<span style=color:#a6e22e>Values</span>.<span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>spreadsheetId</span>, <span style=color:#a6e22e>readRange</span>).<span style=color:#a6e22e>Do</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalf</span>(<span style=color:#e6db74>&#34;Unable to retrieve data from sheet: %v&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>Values</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;No data found.&#34;</span>)
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Date, Value:&#34;</span>)
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>row</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>Values</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s, %s\n&#34;</span>, <span style=color:#a6e22e>row</span>[<span style=color:#ae81ff>0</span>], <span style=color:#a6e22e>row</span>[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>       }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Replace the <code>spreadsheetId</code> constant with the ID of your target spreadsheet.</p><p>This code authenticates with the Google Sheets API using the service account key and reads the data from cells A2 and B2
in the <code>Sheet1</code> sheet of the target spreadsheet.</p><p>Update the dependencies and run the program:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>go mod tidy
</span></span><span style=display:flex><span>go run main.go
</span></span></code></pre></div><p>The result should look like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Date, Value:
</span></span><span style=display:flex><span>2024-12-16 10:00:00, 10
</span></span></code></pre></div><p>To write data to a Google Sheets spreadsheet, use the <code>spreadsheets.Values.Update</code> and <code>Spreadsheets.BatchUpdate</code>
methods. For example, the following modified code inserts a new row above other rows with the current date and an
incremented value:</p><script type=application/javascript src=https://gist.github.com/getvictor/5c7fa2770089755066cde5ab2c772cca.js></script><p>We can review the spreadsheet to verify that our code added the new row.</p><figure><img src=/posts/google-sheets-api/google-sheets-with-new-row.png alt="Google Sheets spreadsheet with two rows containing populated Date and Value columns."></figure><h2 id=next-steps><a href=#next-steps class=header-anchor></a>Next steps</h2><ul><li><a class=link href=../track-engineering-metrics/>Automate tracking of engineering metrics</a>.</li></ul><h2 id=further-reading><a href=#further-reading class=header-anchor></a>Further reading</h2><ul><li>Recently, we covered <a class=link href=../remote-development-environment/>how to set up a remote development environment</a>.</li><li>Previously, we showed <a class=link href=../webhook-flow-with-tines/>how to build a webhook flow with Tines</a>.</li></ul><h2 id=watch-how-to-edit-google-sheets-spreadsheet-using-the-api><a href=#watch-how-to-edit-google-sheets-spreadsheet-using-the-api class=header-anchor></a>Watch how to edit Google Sheets spreadsheet using the API</h2><div class=video-wrapper><iframe loading=lazy src=https://www.youtube.com/embed/J2UEYjQVhZ8 allowfullscreen title="YouTube Video"></iframe></div><p><em>Note:</em> If you want to comment on this article, please do so on the YouTube video.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/google-sheets/>Google Sheets</a>
<a href=/tags/google-apis/>Google APIs</a>
<a href=/tags/golang/>Golang</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/go-modules-and-packages/><div class=article-image><img src=/posts/go-modules-and-packages/go-modules-and-packages.92ce7952b58f5f3166ca7ad03b4a6b78_hu_75ac7c854e373d7d.png width=250 height=150 loading=lazy alt="Featured image of post Go modules and packages — which one to use and when" data-hash="md5-ks55UrWPXzFmynrQO0preA=="></div><div class=article-details><h2 class=article-title>Go modules and packages — which one to use and when</h2></div></a></article><article class=has-image><a href=/posts/staticcheck-go-linter/><div class=article-image><img src=/posts/staticcheck-go-linter/staticcheck-go-linter-headline.dcd1183550c8f4d9f33423b875514223_hu_9b22e6a68f30c8e9.png width=250 height=150 loading=lazy alt="Featured image of post Is staticcheck linter useful for my Go project?" data-hash="md5-3NEYNVDI9NnzNCO4dVFCIw=="></div><div class=article-details><h2 class=article-title>Is staticcheck linter useful for my Go project?</h2></div></a></article><article class=has-image><a href=/posts/opentelemetry-with-jaeger/><div class=article-image><img src=/posts/opentelemetry-with-jaeger/opentelemetry-with-jaeger-headline.c3681919fd37f2097d5153e107cbdd8b_hu_77628e87135e054d.png width=250 height=150 loading=lazy alt="Featured image of post Is OpenTelemetry useful for the average software developer?" data-hash="md5-w2gZGf038gl9UVPhB8vdiw=="></div><div class=article-details><h2 class=article-title>Is OpenTelemetry useful for the average software developer?</h2></div></a></article><article class=has-image><a href=/posts/go-json-unmarshal/><div class=article-image><img src=/posts/go-json-unmarshal/go-json-unmarshal-headline.1f80c428c0bfb8b40d6322952093ab97_hu_23f56c6cc21bed49.png width=250 height=150 loading=lazy alt="Featured image of post Use Go to unmarshal JSON null, set, and missing fields" data-hash="md5-H4DEKMC/uLQNYyKVIJOrlw=="></div><div class=article-details><h2 class=article-title>Use Go to unmarshal JSON null, set, and missing fields</h2></div></a></article><article class=has-image><a href=/posts/go-test-execution-time/><div class=article-image><img src=/posts/go-test-execution-time/crash-test-dummy-headline.b52944a60a898bc6ca376849bf1212e9_hu_f927f9af09a65a7b.png width=250 height=150 loading=lazy alt="Featured image of post How to measure the execution time of Go tests accurately" data-hash="md5-tSlEpgqJi8bKN2hJvxIS6Q=="></div><div class=article-details><h2 class=article-title>How to measure the execution time of Go tests accurately</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 Victor on Software</section><section class=powerby></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>